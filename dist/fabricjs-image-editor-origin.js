!function(){"use strict";var e=function(e,t){const{buttons:n,shapes:i,images:a,dimensions:o,api:s,templates:l,canvasSizeBlock:r=!1,fonts:c=[],fixedCanvas:d=!1,layers:h=!1}=t;this.containerSelector=e,this.containerEl=$(e),this.dimensions={width:o&&o.width>0?o.width:800,height:o&&o.height>0?o.height:600},this.buttons=n,this.shapes=i,this.images=a,this.templates=l,this.fonts=c,this.fixedCanvas=d,this.layers=h,this.api={upload:s&&s.upload?s.upload:null},this.containerEl.addClass("default-container"),this.canvas=null,this.activeTool=null,this.activeSelection=null,this.canvasSizeBlock=!0===r,this.loadCustomFonts=async()=>{const e=this.fonts.map((e=>new FontFace(e.name,`url(${e.path})`,{style:e.style||"normal",weight:e.weight||"normal"}).load().then((e=>(document.fonts.add(e),e)))));try{await Promise.all(e)}catch(e){console.error("Error loading custom fonts:",e)}},this.getCanvasJSON=()=>this.canvas.toJSON(),this.setCanvasJSON=e=>{e&&this.canvas.loadFromJSON(JSON.parse(e),this.canvas.renderAll.bind(this.canvas))},this.setActiveTool=(t,n={})=>{const{forceOpen:i=!1}=n,a=`${e} .toolpanel#${t}-panel`,o=$(a).hasClass("visible"),s=this.activeTool===t,l=()=>{this.canvas.isDrawingLineMode=!1,this.canvas.isDrawingPathMode=!1,this.canvas.isDrawingMode=!1,this.canvas.isDrawingTextMode=!1,this.canvas.isDrawingRectMode=!1,this.canvas.isDrawingCircleMode=!1,this.canvas.isDrawingTriangleMode=!1,this.canvas.defaultCursor="default",this.canvas.selection=!0,this.canvas.forEachObject((e=>{e.selectable=!0,e.evented=!0}))};if(!i&&s&&o)return $(a).removeClass("visible"),l(),"select"!==t&&(this.canvas.discardActiveObject(),this.canvas.renderAll(),this.activeSelection=null),void(this.activeTool=null);if($(`${e} .toolpanel`).removeClass("visible"),this.activeSelection&&this.activeSelection.metadata&&(this.activeSelection.metadata.isGuide||this.activeSelection.metadata.isRuler||this.activeSelection.metadata.isMargin))return this.activeTool=null,void(this.activeSelection=null);switch(this.activeTool=t,"select"===t&&this.activeSelection?($(`${e} .toolbar .active`).removeClass("active"),$(`${e} .toolpanel#${t}-panel`).attr("class",`toolpanel visible type-${this.activeSelection.type}`).addClass("visible"),this.setSelectionValues()):($(`${e} .toolpanel#${t}-panel`).addClass("visible"),this.canvas.discardActiveObject(),this.canvas.renderAll(),this.activeSelection=null),l(),t){case"draw":this.canvas.isDrawingMode=!0;break;case"rect":this.canvas.isDrawingRectMode=!0,this.canvas.defaultCursor="crosshair",this.canvas.selection=!1,this.canvas.forEachObject((e=>{e.selectable=!1,e.evented=!1}));break;case"ellipse":this.canvas.isDrawingCircleMode=!0,this.canvas.defaultCursor="crosshair",this.canvas.selection=!1,this.canvas.forEachObject((e=>{e.selectable=!1,e.evented=!1}));break;case"triangle":this.canvas.isDrawingTriangleMode=!0,this.canvas.defaultCursor="crosshair",this.canvas.selection=!1,this.canvas.forEachObject((e=>{e.selectable=!1,e.evented=!1}));break;case"line":this.canvas.isDrawingLineMode=!0,this.canvas.defaultCursor="crosshair",this.canvas.selection=!1,this.canvas.forEachObject((e=>{e.selectable=!1,e.evented=!1}));break;case"path":this.canvas.isDrawingPathMode=!0,this.canvas.defaultCursor="crosshair",this.canvas.selection=!1,this.canvas.forEachObject((e=>{e.selectable=!1,e.evented=!1})),this.updateTip("Tip: click to place points, press and pull for curves! Click outside or press Esc to cancel!");break;case"textbox":this.canvas.isDrawingTextMode=!0,this.canvas.defaultCursor="crosshair",this.canvas.selection=!1,this.canvas.forEachObject((e=>{e.selectable=!1,e.evented=!1}));break;case"upload":this.openDragDropPanel();break;default:this.updateTipRandom()}},this.undo=()=>{try{if(this.history.getValues().undo.length>1){this.history.undo();const e=this.history.getValues().undo,t=e[e.length-1];t&&this.canvas.loadFromJSON(JSON.parse(t),(()=>{this.canvas.renderAll(),"function"==typeof this.canvas.fire&&this.canvas.fire("history:undo")}))}}catch(e){console.error("undo failed",e)}},this.redo=()=>{try{const e=this.history.getValues().redo;if(e.length){const t=e[e.length-1];this.history.redo(),t&&this.canvas.loadFromJSON(JSON.parse(t),(()=>{this.canvas.renderAll(),"function"==typeof this.canvas.fire&&this.canvas.fire("history:redo")}))}}catch(e){console.error("redo failed",e)}},this.setActiveSelection=e=>{this.activeSelection=e&&e[0]?e[0]:e,this.activeSelection&&this.setActiveTool("select",{forceOpen:!0})},this.configUndoRedoStack=()=>{this.history=window.UndoRedoStack(),document.addEventListener("keydown",(e=>{const t=e.which||e.keyCode;e.ctrlKey&&0===document.querySelectorAll("textarea:focus, input:focus").length&&(90===t&&this.undo(),89===t&&this.redo())}))},this.init=async()=>{await this.loadCustomFonts(),this.initializeRuler(),this.configUndoRedoStack(),this.initializeToolbar(),this.initializeMainPanel(),this.initializeShapes(),this.initializeImages();try{this.initializeTemplates()}catch(e){console.error("can't initialize templates",e)}this.initializeFreeDrawSettings(),this.initializeCanvasSettingPanel(),this.initializeSelectionSettings(),this.canvas=this.initializeCanvas(),this.initializeAligningGuidelines(this.canvas),this.initializeCenteringGuidelines(this.canvas),this.initializeCanvasActionsMenu(this.canvas),this.fixedCanvas&&$(`${this.containerSelector} #canvas-holder`).addClass("fixed-canvas"),this.layers&&$(`${this.containerSelector} #canvas-holder`).addClass("canvas-layers"),this.initializeLineDrawing(this.canvas),this.initializePathDrawing(this.canvas),this.initializeTextBoxDrawing(this.canvas),this.initializeRectDrawing(this.canvas),this.initializeCircleDrawing(this.canvas),this.initializeTriangleDrawing(this.canvas),this.initializeUpload(this.canvas),this.initializeCopyPaste(this.canvas),this.initializeAnimations(this.canvas),this.initializeTipSection(),this.initializeUtilsEvents(),this.initializeZoomEvents(),this.initializeLayers(),this.initializeFullscreenEvents(),this.initializeNotification();try{this.initializeConfirmationDialog()}catch(e){console.error("can't initialize confirmation dialog",e)}this.extendHideShowToolPanel(),this.extendNumberInput(),this.fitZoom()},this.initializeMainPanel=()=>{$(`${e}`).append('<div class="main-panel"></div>')},this.extendHideShowToolPanel=()=>{$(`${this.containerSelector} .toolpanel`).each((function(){$(this).append('<div class="hide-show-handler"></div>')})),$(`${this.containerSelector} .toolpanel  .hide-show-handler`).click((function(){$(this).closest(".toolpanel").toggleClass("closed")}))},this.extendNumberInput=()=>{$(`${e} .decrease`).click((function(){let e=$(this).closest(".custom-number-input").find("input[type=number]"),t=e.attr("step");t=t?parseFloat(t):1;let n=parseFloat(e.val());e.val((n-t).toFixed(t.countDecimals())),e.change()})),$(`${e} .increase`).click((function(){let e=$(this).closest(".custom-number-input").find("input[type=number]"),t=e.attr("step");t=t?parseFloat(t):1;let n=parseFloat(e.val());e.val((n+t).toFixed(t.countDecimals())),e.change()}))},this.deleteObject=(e,t)=>{var n=t.target,i=n.canvas;i.remove(n),i.requestRenderAll()},this.cloneObject=(e,t)=>{var n=t.target,i=n.canvas;n.clone((function(e){e.left+=10,e.top+=10,i.add(e)}))},this.renderIcon=e=>{var t=document.createElement("img");return t.src=e,function(e,n,i,a,o){var s=t,l=s.naturalWidth,r=s.naturalHeight,c=this.cornerSize,d=l/r,h=c,p=h/d;p>c&&(h=(p=c)*d),e.save(),e.translate(n,i),e.rotate(fabric.util.degreesToRadians(o.angle)),e.drawImage(s,-h/2,-p/2,h,p),e.restore()}},this.init()};e.prototype.destroy=function(){$(document).off("keydown",this.ctrZY),$(this.containerSelector).empty(),this.canvas=null,this.activeTool=null,this.activeSelection=null},window.ImageEditor=e}(),function(){"use strict";window.ImageEditor.prototype.initializeUtilsEvents=function(){this.generateFabricGradientFromColorStops=(e,t,n,i,a)=>{let o={},s=[];for(var l in e)s.push({id:l,color:e[l].color,offset:e[l].position/100});if("linear"===i){let e=(e=>{let t=-parseInt(e,10)*(Math.PI/180);return{x1:Math.round(50+50*Math.sin(t))/100,y1:Math.round(50+50*Math.cos(t))/100,x2:Math.round(50+50*Math.sin(t+Math.PI))/100,y2:Math.round(50+50*Math.cos(t+Math.PI))/100}})(a);o=new fabric.Gradient({type:"linear",coords:{x1:e.x1*t,y1:e.y1*n,x2:e.x2*t,y2:e.y2*n},colorStops:s})}else"radial"===i&&(o=new fabric.Gradient({type:"radial",coords:{x1:t/2,y1:n/2,r1:0,x2:t/2,y2:n/2,r2:t/2},colorStops:s}));return o},this.getRealBBox=async e=>{let t,n,i,a;var o;return(e=>{var t,n,o,s,l=new Uint32Array(e),r=i,c=0;for(n=0;n<a;n++)for(t=0;t<i;t++)if(4278190080&l[n*i+t]){o=n,n=a;break}for(n=a-1;n>o;n--)for(t=0;t<i;t++)if(4278190080&l[n*i+t]){s=n,n=0;break}for(n=o;n<s;n++)for(t=0;t<i;t++)if(t<r&&4278190080&l[n*i+t]){r=t;break}for(n=o;n<s;n++)for(t=i-1;t>r;t--)if(t>c&&4278190080&l[n*i+t]){c=t;break}return{x1:r,x2:c,y1:o,y2:s,width:c-r,height:s-o}})(await(o=e.toDataURL(),null==t&&(t=document.createElement("canvas"),t.style.border="1px solid blue",t.style.position="absolute",t.style.top="-100%",t.style.visibility="hidden",n=t.getContext("2d"),document.body.appendChild(t)),new Promise((function(e,s){if(null==o)return s();var l=new Image;l.addEventListener("load",(()=>{i=l.width,a=l.height,t.width=i,t.height=a,n.drawImage(l,0,0,i,a);var o=n.getImageData(0,0,i,a).data.buffer;e(o,!1)})),l.src=o}))))},this.alignObject=(e,t,n)=>{switch(n){case"left":(async()=>{let n=t.getBoundingRect(),i=await this.getRealBBox(t);t.set("left",t.left-n.left-i.x1),t.setCoords(),e.renderAll(),e.fire("object:modified")})();break;case"center-h":(async()=>{let n=t.getBoundingRect(),i=await this.getRealBBox(t);t.set("left",t.left-n.left-i.x1+e.width/2-i.width/2),t.setCoords(),e.renderAll(),e.fire("object:modified")})();break;case"right":(async()=>{let n=t.getBoundingRect(),i=await this.getRealBBox(t);t.set("left",t.left-n.left-i.x1+e.width-i.width),t.setCoords(),e.renderAll(),e.fire("object:modified")})();break;case"top":(async()=>{let n=t.getBoundingRect(),i=await this.getRealBBox(t);t.set("top",t.top-n.top-i.y1),t.setCoords(),e.renderAll(),e.fire("object:modified")})();break;case"center-v":(async()=>{let n=t.getBoundingRect(),i=await this.getRealBBox(t);t.set("top",t.top-n.top-i.y1+e.height/2-i.height/2),t.setCoords(),e.renderAll(),e.fire("object:modified")})();break;case"bottom":(async()=>{let n=t.getBoundingRect(),i=await this.getRealBBox(t);t.set("top",t.top-n.top-i.y1+(e.height-i.height)),t.setCoords(),e.renderAll(),e.fire("object:modified")})()}},this.getCurrentEffect=e=>{let t={opacity:100,blur:0,brightness:50,saturation:50,gamma:{r:45,g:45,b:45}};t.opacity=100*e.opacity;let n=e.filters.find((e=>e.blur));n&&(t.blur=100*n.blur);let i=e.filters.find((e=>e.brightness));i&&(t.brightness=(i.brightness+1)/2*100);let a=e.filters.find((e=>e.saturation));a&&(t.saturation=(a.saturation+1)/2*100);let o=e.filters.find((e=>e.gamma));return o&&(t.gamma.r=Math.round(o.gamma[0]/.022),t.gamma.g=Math.round(o.gamma[1]/.022),t.gamma.b=Math.round(o.gamma[2]/.022)),t},this.getUpdatedFilter=(e,t,n)=>{let i={...e};switch(t){case"gamma.r":i.gamma.r=n;break;case"gamma.g":i.gamma.g=n;break;case"gamma.b":i.gamma.b=n;break;default:i[t]=n}let a=[];return(e=i).blur>0&&a.push(new fabric.Image.filters.Blur({blur:e.blur/100})),50!==e.brightness&&a.push(new fabric.Image.filters.Brightness({brightness:e.brightness/100*2-1})),50!==e.saturation&&a.push(new fabric.Image.filters.Saturation({saturation:e.saturation/100*2-1})),45===e.gamma.r&&45===e.gamma.g&&45===e.gamma.b||a.push(new fabric.Image.filters.Gamma({gamma:[Math.round(.022*e.gamma.r*10)/10,Math.round(.022*e.gamma.g*10)/10,Math.round(.022*e.gamma.b*10)/10]})),a},this.getActiveFontStyle=(e,t)=>{if(e.getSelectionStyles&&e.isEditing){let n=e.getSelectionStyles();return n.find((e=>""===e[t]))?"":n[0][t]}return e[t]||""},this.setActiveFontStyle=(e,t,n)=>{if(e.setSelectionStyles&&e.isEditing){let i={};i[t]=n,e.setSelectionStyles(i),e.setCoords()}else e.set(t,n)},this.downloadImage=(e,t="png",n="image/png")=>{const i=e.toString().replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,""),a=atob(i),o=new Array(a.length);for(let e=0;e<a.length;e+=1)o[e]=a.charCodeAt(e);const s=new Uint8Array(o),l=new Blob([s],{type:n+";base64"}),r=window.URL.createObjectURL(l);if(window.navigator&&window.navigator.msSaveOrOpenBlob)return void window.navigator.msSaveOrOpenBlob(l);const c=document.createElement("a");c.href=r,c.download="image."+t,c.dispatchEvent(new MouseEvent("click")),setTimeout((()=>{window.URL.revokeObjectURL(r)}),60)},this.downloadSVG=e=>{const t="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(e),n=document.createElement("a");n.href=t,n.download="image.svg",n.dispatchEvent(new MouseEvent("click")),setTimeout((()=>{window.URL.revokeObjectURL(t)}),60)},this.downloadJSON=e=>{var t=JSON.stringify(e),n=document.createElement("a");n.href="data:text/json;charset=utf-8,"+encodeURIComponent(t),n.download="canvas.json",n.click()},this.addImageFromUrl=e=>{const t=this,n=new Image;n.crossOrigin="anonymous",n.src=e,n.onload=function(){fabric.Image.fromURL(e,(e=>{const n=.9*t.canvas.originalH,i=.9*t.canvas.originalW,a=e.height,o=e.width;(a>=n||o>=i)&&(a>=o?e.scaleToHeight(n):e.scaleToWidth(i));const s=t.canvas.originalW/2,l=t.canvas.originalH/2;e.set({left:s-e.getScaledWidth()/2,top:l-e.getScaledHeight()/2}),t.canvas.add(e),t.canvas.setActiveObject(e),t.canvas.renderAll(),t.canvas.fire("object:modified"),$(`${t.containerSelector} #toolbar button`).removeClass("active")}),{crossOrigin:"anonymous"})},n.onerror=function(){console.error("Error loading image. Check that the URL is correct and that the image allows CORS.")}},this.setCanvasStatus=e=>{const t=this;e&&t.canvas.loadFromJSON(e,t.canvas.renderAll.bind(t.canvas))},this.animateObject=e=>{const t=this.canvas;if(e.animation){const n=fabric.util.ease?.[e.animation.easing]||fabric.util.ease.linear||(e=>e);let i=e.left+100;e.set({opacity:1,left:i}),e.animate("left",e.animation.to,{duration:800,onChange:t.renderAll.bind(t),easing:n,onComplete:function(){console.log("Animação concluída!")}})}},this.clearGuidesline=e=>{e.getObjects().forEach((t=>{(t.id&&t.id.startsWith("vertical-")||t.id&&t.id.startsWith("horizontal-"))&&e.remove(t)})),e.renderAll()},this.guidelines=[],this.setGuidelines=e=>{this.guidelines.forEach((t=>{e.add(t)}))},this.handleObjectMoving=(e,t)=>{const n=10,i=e.getZoom(),a=e.width/i,o=e.height/i,s=t.left-t.width*t.scaleX/2,l=t.top-t.height*t.scaleY/2,r=s+t.width*t.scaleX,c=l+t.height*t.scaleY,d=t.left,h=t.top;let p=[];this.clearGuidesline(e);let u=!1;if(Math.abs(s)<n){if(t.set({left:t.width*t.scaleX/2}),!this.guidelineExists(e,"vertical-left")){const t=this.createVerticalGuideline(e,0,"vertical-left");p.push(t),e.add(t)}u=!0}if(Math.abs(l)<n){if(t.set({top:t.height*t.scaleY/2}),!this.guidelineExists(e,"horizontal-top")){const t=this.createHorizontalGuideline(e,0,"horizontal-top");p.push(t),e.add(t)}u=!0}if(Math.abs(r-a)<n){if(t.set({left:a-t.width*t.scaleX/2}),!this.guidelineExists(e,"vertical-right")){const t=this.createVerticalGuideline(e,a-1,"vertical-right");p.push(t),e.add(t)}u=!0}if(Math.abs(c-o)<n){if(t.set({top:o-t.height*t.scaleY/2}),!this.guidelineExists(e,"horizontal-bottom")){const t=this.createHorizontalGuideline(e,o,"horizontal-bottom");p.push(t),e.add(t)}u=!0}if(Math.abs(d-a/2)<n){if(t.set({left:a/2}),!this.guidelineExists(e,"vertical-center")){const t=this.createVerticalGuideline(e,a/2,"vertical-center");p.push(t),e.add(t)}u=!0}if(Math.abs(h-o/2)<n){if(t.set({top:o/2}),!this.guidelineExists(e,"horizontal-center")){const t=this.createHorizontalGuideline(e,o/2,"horizontal-center");p.push(t),e.add(t)}u=!0}u?this.setGuidelines(p):this.clearGuidesline(e),e.renderAll()},this.createVerticalGuideline=(e,t,n)=>new fabric.Line([t,0,t,e.height],{stroke:"red",strokeWidth:1,selectable:!1,evented:!1,name:n,id:n,opacity:.8,strokeDashArray:[5,5]}),this.createHorizontalGuideline=(e,t,n)=>new fabric.Line([0,t,e.width,t],{stroke:"red",strokeWidth:1,selectable:!1,evented:!1,name:n,id:n,opacity:.8,strokeDashArray:[5,5]}),this.guidelineExists=(e,t)=>e.getObjects().some((e=>e.name===t||e.id===t)),this.onObjectMoving=(e,t)=>{}}}(),window.saveInBrowser={save:(e,t)=>{t instanceof Object&&(t=JSON.stringify(t)),localStorage.setItem(e,t);const n=new CustomEvent("ImageEditor.storageSave",{detail:{name:e,value:t}});window.dispatchEvent(n)},load:e=>{let t=localStorage.getItem(e);return t=JSON.parse(t),t},remove:e=>{localStorage.removeItem(e)}},function(){"use strict";var e=[{name:"select",title:"Select/move object (V)",icon:'<svg id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" xml:space="preserve"><g><g><path d="M423.547,323.115l-320-320c-3.051-3.051-7.637-3.947-11.627-2.304s-6.592,5.547-6.592,9.856V480 c0,4.501,2.837,8.533,7.083,10.048c4.224,1.536,8.981,0.192,11.84-3.285l85.205-104.128l56.853,123.179 c1.792,3.883,5.653,6.187,9.685,6.187c1.408,0,2.837-0.277,4.203-0.875l74.667-32c2.645-1.131,4.736-3.285,5.76-5.973 c1.024-2.688,0.939-5.675-0.277-8.299l-57.024-123.52h132.672c4.309,0,8.213-2.603,9.856-6.592 C427.515,330.752,426.598,326.187,423.547,323.115z"></path></g></g></svg>'},{name:"shapes",title:"Shapes",icon:'<svg id="Capa_1" x="0px" y="0px" viewBox="0 0 490.927 490.927" xml:space="preserve"><path d="M336.738,178.502c-12.645,0-24.852,1.693-36.627,4.582L202.57,11.786c-5.869-10.321-22.84-10.321-28.709,0L2.163,313.311 c-2.906,5.105-2.889,11.385,0.078,16.466c2.953,5.088,8.389,8.216,14.275,8.216l166.314,0.009 c2.818,82.551,70.688,148.88,153.906,148.88c85.012,0,154.19-69.167,154.19-154.186S421.749,178.502,336.738,178.502z  M44.917,304.964l143.299-251.63L331.515,304.97L44.917,304.964z"></path></svg>'},{name:"images",title:"Images",icon:'<svg viewBox="0 0 576 512"><path d="M160 80H512c8.8 0 16 7.2 16 16V320c0 8.8-7.2 16-16 16H490.8L388.1 178.9c-4.4-6.8-12-10.9-20.1-10.9s-15.7 4.1-20.1 10.9l-52.2 79.8-12.4-16.9c-4.5-6.2-11.7-9.8-19.4-9.8s-14.8 3.6-19.4 9.8L175.6 336H160c-8.8 0-16-7.2-16-16V96c0-8.8 7.2-16 16-16zM96 96V320c0 35.3 28.7 64 64 64H512c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H160c-35.3 0-64 28.7-64 64zM48 120c0-13.3-10.7-24-24-24S0 106.7 0 120V344c0 75.1 60.9 136 136 136H456c13.3 0 24-10.7 24-24s-10.7-24-24-24H136c-48.6 0-88-39.4-88-88V120zm208 24a32 32 0 1 0 -64 0 32 32 0 1 0 64 0z"/></svg>'},{name:"draw",title:"Free draw",icon:'<svg height="512pt" viewBox="0 -3 512 512" width="512pt"><g id="surface1"><path d="M 497.171875 86.429688 C 506.734375 76.867188 512 64.152344 512 50.628906 C 512 37.105469 506.734375 24.390625 497.171875 14.828125 C 487.609375 5.265625 474.894531 0 461.371094 0 C 447.847656 0 435.132812 5.265625 425.570312 14.828125 L 198.296875 242.105469 L 269.894531 313.703125 Z M 497.171875 86.429688 " style="stroke: none; fill-rule: nonzero; fill: rgb(0, 0, 0); fill-opacity: 1;"></path><path d="M 65.839844 506.65625 C 92.171875 507.21875 130.371094 496.695312 162.925781 459.074219 C 164.984375 456.691406 166.894531 454.285156 168.664062 451.855469 C 179.460938 435.875 184.695312 418.210938 183.855469 400.152344 C 182.945312 380.5625 174.992188 362.324219 161.460938 348.796875 C 150.28125 337.613281 134.722656 331.457031 117.648438 331.457031 C 95.800781 331.457031 73.429688 341.296875 56.277344 358.449219 C 31.574219 383.152344 31.789062 404.234375 31.976562 422.839844 C 32.15625 440.921875 32.316406 456.539062 11.101562 480.644531 L 0 493.257812 C 0 493.257812 26.828125 505.820312 65.839844 506.65625 Z M 65.839844 506.65625 " style="stroke: none; fill-rule: nonzero; fill: rgb(0, 0, 0); fill-opacity: 1;"></path><path d="M 209.980469 373.621094 L 248.496094 335.101562 L 176.894531 263.503906 L 137.238281 303.160156 C 154.691406 306.710938 170.464844 315 182.859375 327.394531 C 195.746094 340.285156 205.003906 356.1875 209.980469 373.621094 Z M 209.980469 373.621094 " style="stroke: none; fill-rule: nonzero; fill: rgb(0, 0, 0); fill-opacity: 1;"></path></g></svg>'},{name:"rect",title:"Rectangle",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2z"/></svg>'},{name:"ellipse",title:"Ellipse",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><circle cx="8" cy="8" r="8"/></svg>'},{name:"triangle",title:"Triangle",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M7.022 1.566a1.13 1.13 0 0 1 1.96 0l6.857 11.667c.457.778-.092 1.767-.98 1.767H1.144c-.889 0-1.437-.99-.98-1.767z"/></svg>'},{name:"line",title:"Line",icon:'<svg id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" xml:space="preserve"><path d="M349.091,0v124.516L124.516,349.091H0V512h162.909V387.484l224.574-224.574H512V0H349.091z M54.303,457.696v-54.303 h54.303v54.303H54.303z M457.696,108.605h-54.303V54.303h54.303V108.605z"></path></svg>'},{name:"path",title:"Connectable lines & curves",icon:'<svg id="svg8" viewBox="28 55 140 140"><path d="m 28.386086,150.01543 v 43.10301 H 71.489092 V 178.7505 H 120.75466 V 164.38283 H 71.355237 L 71.488872,150.0086 H 57.121421 c 0,-49.247 14.367449,-63.614929 63.633239,-63.614929 v -14.36768 c -63.633239,0 -78.000906,28.735609 -78.000906,77.982609 l -14.367888,0.007 z m 14.367669,28.73507 v -14.36767 h 14.367668 v 14.36767 z" id="path840" style="stroke-width: 0.264583;"></path><path d="m 120.74975,150.00843 v 43.10301 h 43.10301 V 150.0016 l -43.10301,0.007 z m 14.36767,28.73507 v -14.36767 h 14.36767 v 14.36767 z" id="path840-1" style="stroke-width: 0.264583;"></path><path d="m 120.74975,57.658601 v 43.103009 h 43.10301 V 57.651771 l -43.10301,0.007 z m 14.36767,28.73507 v -14.36767 h 14.36767 v 14.36767 z" id="path840-1-0" style="stroke-width: 0.264583;"></path></svg>'},{name:"textbox",title:"Text box",icon:'<svg id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" xml:space="preserve"><g><g><path d="M497,90c8.291,0,15-6.709,15-15V15c0-8.291-6.709-15-15-15h-60c-8.291,0-15,6.709-15,15v15H90V15c0-8.401-6.599-15-15-15 H15C6.599,0,0,6.599,0,15v60c0,8.399,6.599,15,15,15h15v332H15c-8.291,0-15,6.709-15,15v60c0,8.291,6.709,15,15,15h60 c8.291,0,15-6.709,15-15v-15h332v15c0,8.399,6.599,15,15,15h60c8.401,0,15-6.601,15-15v-60c0-8.401-6.599-15-15-15h-15V90H497z  M452,422h-15c-8.401,0-15,6.599-15,15v15H90v-15c0-8.291-6.709-15-15-15H60V90h15c8.401,0,15-6.601,15-15V60h332v15 c0,8.291,6.709,15,15,15h15V422z"></path></g></g><g><g><path d="M361,105H151c-8.291,0-15,6.709-15,15v60c0,6.064,3.647,11.543,9.258,13.857c5.625,2.329,12.056,1.04,16.348-3.252 L187.211,165H226v176.459l-27.48,42.221c-3.062,4.6-3.354,10.518-0.747,15.396S205.463,407,211,407h90 c5.537,0,10.62-3.047,13.228-7.925c2.608-4.878,2.314-10.796-0.747-15.396L286,341.459V165h38.789l25.605,25.605 c4.307,4.307,10.781,5.596,16.348,3.252c5.61-2.314,9.258-7.793,9.258-13.857v-60C376,111.709,369.291,105,361,105z"></path></g></g></svg>'},{name:"upload",title:"Upload image",icon:'<svg id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" xml:space="preserve"><path d="M412.907,214.08C398.4,140.693,333.653,85.333,256,85.333c-61.653,0-115.093,34.987-141.867,86.08 C50.027,178.347,0,232.64,0,298.667c0,70.72,57.28,128,128,128h277.333C464.213,426.667,512,378.88,512,320 C512,263.68,468.16,218.027,412.907,214.08z M298.667,277.333v85.333h-85.333v-85.333h-64L256,170.667l106.667,106.667H298.667z"></path></svg>'},{name:"background",title:"Canvas option",icon:'<svg viewBox="0 0 512 512"><path d="M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"/></svg>'},{name:"ruler",title:"Mostrar réguas e guias (Shift+R)",icon:'<svg viewBox="0 0 512 512"><path d="M177.9 494.1c-18.7 18.7-49.1 18.7-67.9 0L17.9 401.9c-18.7-18.7-18.7-49.1 0-67.9l50.7-50.7 48 48c6.2 6.2 16.4 6.2 22.6 0s6.2-16.4 0-22.6l-48-48 41.4-41.4 48 48c6.2 6.2 16.4 6.2 22.6 0s6.2-16.4 0-22.6l-48-48 41.4-41.4 48 48c6.2 6.2 16.4 6.2 22.6 0s6.2-16.4 0-22.6l-48-48 41.4-41.4 48 48c6.2 6.2 16.4 6.2 22.6 0s6.2-16.4 0-22.6l-48-48 50.7-50.7c18.7-18.7 49.1-18.7 67.9 0l92.1 92.1c18.7 18.7 18.7 49.1 0 67.9L177.9 494.1z"/></svg>'},{name:"templates",title:"Tempaltes",icon:'<svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.675 3h.825v18h-2.175c-3.59 0-5.385 0-6.61-.966a4.497 4.497 0 0 1-.749-.748C3 18.06 3 16.266 3 12.675v-1.35c0-3.59 0-5.385.966-6.61a4.5 4.5 0 0 1 .748-.749C5.94 3 7.734 3 11.325 3h1.35Zm6.61 17.034c-.926.73-2.178.909-4.285.952v-9.968h6v1.657c0 3.59 0 5.386-.966 6.61-.22.279-.47.53-.748.749Zm1.709-10.516H15V3.014c2.107.044 3.36.222 4.286.952.278.22.529.47.748.748.788 1 .933 2.38.96 4.804Z" fill="currentColor"></path></svg>'}];const t=[{name:"animation",title:"Play animation",icon:'<svg viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg" >  <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393"/></svg>'},{name:"clear",title:"Clear",icon:'<svg  fill="currentColor" class="bi bi-eraser-fill" viewBox="0 0 16 16"><path d="M8.086 2.207a2 2 0 0 1 2.828 0l3.879 3.879a2 2 0 0 1 0 2.828l-5.5 5.5A2 2 0 0 1 7.879 15H5.12a2 2 0 0 1-1.414-.586l-2.5-2.5a2 2 0 0 1 0-2.828zm.66 11.34L3.453 8.254 1.914 9.793a1 1 0 0 0 0 1.414l2.5 2.5a1 1 0 0 0 .707.293H7.88a1 1 0 0 0 .707-.293z"/></svg>'},{name:"undo",title:"Undo",icon:'<svg id="Capa_1" x="0px" y="0px" viewBox="0 0 512.011 512.011" xml:space="preserve"><path d="M511.136,286.255C502.08,194.863,419.84,128.015,328,128.015H192v-80c0-6.144-3.52-11.744-9.056-14.432             c-5.568-2.656-12.128-1.952-16.928,1.92l-160,128C2.208,166.575,0,171.151,0,176.015s2.208,9.44,5.984,12.512l160,128             c2.912,2.304,6.464,3.488,10.016,3.488c2.368,0,4.736-0.512,6.944-1.568c5.536-2.688,9.056-8.288,9.056-14.432v-80h139.392             c41.856,0,80,30.08,84.192,71.712c4.832,47.872-32.704,88.288-79.584,88.288H208c-8.832,0-16,7.168-16,16v64             c0,8.832,7.168,16,16,16h128C438.816,480.015,521.472,391.151,511.136,286.255z"></path></svg>'},{name:"redo",title:"Redo",icon:'<svg id="Capa_1" x="0px" y="0px" viewBox="0 0 512.011 512.011" xml:space="preserve" style="transform: scale(-1, 1);"><path d="M511.136,286.255C502.08,194.863,419.84,128.015,328,128.015H192v-80c0-6.144-3.52-11.744-9.056-14.432             c-5.568-2.656-12.128-1.952-16.928,1.92l-160,128C2.208,166.575,0,171.151,0,176.015s2.208,9.44,5.984,12.512l160,128             c2.912,2.304,6.464,3.488,10.016,3.488c2.368,0,4.736-0.512,6.944-1.568c5.536-2.688,9.056-8.288,9.056-14.432v-80h139.392             c41.856,0,80,30.08,84.192,71.712c4.832,47.872-32.704,88.288-79.584,88.288H208c-8.832,0-16,7.168-16,16v64             c0,8.832,7.168,16,16,16h128C438.816,480.015,521.472,391.151,511.136,286.255z"></path></svg>'},{name:"save",title:"Save",icon:'<svg viewBox="0 0 448 512"><path d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V173.3c0-17-6.7-33.3-18.7-45.3L352 50.7C340 38.7 323.7 32 306.7 32H64zm0 96c0-17.7 14.3-32 32-32H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V128zM224 288a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/></svg>'},{name:"download",title:"Download",icon:'<svg viewBox="0 0 512 512"><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"/></svg>'},{name:"fullscreen",title:"Fullscreen",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path d="M32 32C14.3 32 0 46.3 0 64v96c0 17.7 14.3 32 32 32s32-14.3 32-32V96h64c17.7 0 32-14.3 32-32s-14.3-32-32-32H32zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7 14.3 32 32 32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H64V352zM320 32c-17.7 0-32 14.3-32 32s14.3 32 32 32h64v64c0 17.7 14.3 32 32 32s32-14.3 32-32V64c0-17.7-14.3-32-32-32H320zM448 352c0-17.7-14.3-32-32-32s-32 14.3-32 32v64H320c-17.7 0-32 14.3-32 32s14.3 32 32 32h96c17.7 0 32-14.3 32-32V352z"/></svg>'}];window.ImageEditor.prototype.initializeToolbar=function(){const n=this;let i=[],a=[];Array.isArray(this.buttons)&&this.buttons.length?(e.forEach((e=>{this.buttons.includes(e.name)&&i.push(e)})),t.forEach((e=>{this.buttons.includes(e.name)&&a.push(e)}))):(i=e,a=t),this.getCanvasJSON=function(){const e=this.canvas.getObjects().filter((e=>e.metadata&&(e.metadata.isGuide||e.metadata.isMargin))),t=e.map((e=>({obj:e,excludeFromExport:e.excludeFromExport})));e.forEach((e=>{e.excludeFromExport=!1}));const n=JSON.stringify(this.canvas.toJSON(["metadata","excludeFromExport"]));return t.forEach((e=>{e.obj.excludeFromExport=e.excludeFromExport})),n},this.toJSONWithGuides=function(){const e=this.canvas.toJSON(["metadata"]),t=this.canvas.getObjects().filter((e=>e.metadata&&(e.metadata.isGuide||e.metadata.isMargin))).map((e=>e.toObject(["metadata"])));return 0===t.length||(e.objects||(e.objects=[]),e.objects=e.objects.concat(t)),e},this.saveToBrowser=function(){const e=this.canvas.getObjects().filter((e=>e.metadata&&(e.metadata.isGuide||e.metadata.isMargin))),t=e.map((e=>({obj:e,excludeFromExport:e.excludeFromExport})));e.forEach((e=>{e.excludeFromExport=!1})),saveInBrowser.save("canvasEditor",this.canvas.toJSON(["metadata","excludeFromExport"])),t.forEach((e=>{e.obj.excludeFromExport=e.excludeFromExport}))},this.checkSnapping=function(e){if(!this.canvas||!e)return!1;if(e.metadata&&(e.metadata.isGuide||e.metadata.isMargin))return!1;const t=10/this.canvas.getZoom(),n=e.getBoundingRect(),i=n.left,a=n.top,o=n.left+n.width,s=n.top+n.height,l=i+n.width/2,r=a+n.height/2,c=this.canvas.getObjects().filter((e=>e.metadata&&(e.metadata.isGuide||e.metadata.isMargin)));let d=null,h=t;if(c.forEach((e=>{if(e.metadata.isGuide&&e.metadata.isHorizontal||e.metadata.isMargin&&("marginTop"===e.metadata.id||"marginBottom"===e.metadata.id)){const t=e.y1,n=Math.abs(t-a);n<h&&(h=n,d={axis:"y",target:a,value:t,guide:e});const i=Math.abs(t-r);i<h&&(h=i,d={axis:"y",target:r,value:t,guide:e});const o=Math.abs(t-s);o<h&&(h=o,d={axis:"y",target:s,value:t,guide:e})}else if(e.metadata.isGuide&&!e.metadata.isHorizontal||e.metadata.isMargin&&("marginLeft"===e.metadata.id||"marginRight"===e.metadata.id)){const t=e.x1,n=Math.abs(t-i);n<h&&(h=n,d={axis:"x",target:i,value:t,guide:e});const a=Math.abs(t-l);a<h&&(h=a,d={axis:"x",target:l,value:t,guide:e});const s=Math.abs(t-o);s<h&&(h=s,d={axis:"x",target:o,value:t,guide:e})}})),d){if(d.guide.metadata.isGuide&&d.guide.set({stroke:"#ff3860",strokeWidth:2,opacity:1}),"y"===d.axis){const t=d.value-d.target;e.set({top:e.top+t})}else{const t=d.value-d.target;e.set({left:e.left+t})}const t=this;return setTimeout((()=>{d.guide&&d.guide.metadata&&d.guide.metadata.isGuide&&(d.guide.active||d.guide.set({stroke:"#00a8ff",strokeWidth:2,opacity:.7}),t.canvas.renderAll())}),300),!0}return!1},this.forceGuidesMovable=function(){if(!this.canvas)return;const e=this.canvas.getObjects().filter((e=>e.metadata&&e.metadata.isGuide));0!==e.length&&(e.forEach(((e,t)=>{try{const t=e.metadata.isHorizontal;e.set({selectable:!0,evented:!0,lockMovementX:t,lockMovementY:!t,hasControls:!1,hasBorders:!0,padding:8,strokeWidth:2,hoverCursor:t?"ns-resize":"ew-resize",moveCursor:t?"ns-resize":"ew-resize",excludeFromExport:!0,opacity:e.active?1:.7})}catch(e){console.error(`Erro ao configurar guia ${t+1}:`,e)}})),this.canvas.renderAll())};try{const e='<div id="tinyartist-logo">\n            <img width="40" height="35" src="https://uat.marascott.ai/wp-content/uploads/mascotte-remotedsi-tinyartistgradient-square-150x150.png">\n            <span>TinyArtist Editor</span>\n        </div>';this.containerEl.append(`<div class="toolbar" id="toolbar"><div class="main-buttons"></div>${e}<div class="extended-buttons"></div></div>`);const t=window.matchMedia?window.matchMedia("(orientation: portrait)"):null,o=()=>{const e=t?t.matches:window.innerHeight>window.innerWidth;n.containerEl.toggleClass("vertical-toolbar-layout",e),$(`${n.containerSelector} #toolbar`).toggleClass("vertical",e)};o(),window.addEventListener("resize",o),t&&(t.addEventListener?t.addEventListener("change",o):t.addListener&&t.addListener(o)),(()=>{i.forEach((e=>{$(`${this.containerSelector} #toolbar .main-buttons`).append(`<button id="${e.name}">${e.icon}</button>`)})),$(`${this.containerSelector} #toolbar .main-buttons button`).click((function(){let e=$(this).attr("id");if("ruler"===e)return n.toggleRulers(),void $(this).toggleClass("active");const t=$(this),i=`${n.containerSelector} .toolpanel#${e}-panel`,a=$(i).hasClass("visible");if(t.hasClass("active")&&a)return t.removeClass("active"),void n.setActiveTool(e);$(`${n.containerSelector} #toolbar button`).removeClass("active"),t.addClass("active"),n.setActiveTool(e)}))})(),(()=>{a.forEach((e=>{$(`${this.containerSelector} #toolbar .extended-buttons`).append(`<button id="${e.name}">${e.icon}</button>`)})),$(`${this.containerSelector} #toolbar .extended-buttons button`).click((async function(){let e=$(this).attr("id");"save"===e?(console.log(n.canvas),console.log(n.canvas.toJSON()),console.log(n.canvas.toJSON(["metadata","excludeFromExport"])),n.saveToBrowser(),n.toast("Success")):"clear"===e?await((e,t={})=>"function"==typeof n.confirm?n.confirm(e,t):Promise.resolve(!0))("This will clear the canvas! Are you sure?",{confirmLabel:"Clear",cancelLabel:"Cancel"})&&(n.canvas.clear(),saveInBrowser.remove("canvasEditor")):"download"===e?($(n.containerSelector).append('<div class="custom-modal-container">\n              <div class="custom-modal-content">\n                <div class="button-download" id="svg">Download as SVG</div>\n                <div class="button-download" id="png">Download as PNG</div>\n                <div class="button-download" id="jpg">Download as JPG</div>\n                <div class="button-download" id="webp">Download as WEBP</div>\n                <div class="button-download" id="json">Download as JSON</div>\n              </div>\n            </div>'),$(".custom-modal-container").click((function(){$(this).remove()})),$(".custom-modal-container .button-download").click((function(e){let t=$(this).attr("id"),i=n.canvas;i.setBackgroundColor("#FFFFFF");const a=i.getObjects().filter((e=>e.metadata&&(e.metadata.isGuide||e.metadata.isMargin)));if(a.forEach((e=>{e.visible=!1})),i.renderAll(),"svg"===t)n.downloadSVG(i.toSVG({suppressPreamble:!0}));else if("png"===t)n.downloadImage(i.toDataURL());else if("jpg"===t)n.downloadImage(i.toDataURL({format:"jpeg"}),"jpg","image/jpeg");else if("webp"===t)n.downloadImage(i.toDataURL({format:"webp"}),"webp","image/webp");else if("json"===t){const e=n.canvas.getObjects().filter((e=>e.metadata&&(e.metadata.isGuide||e.metadata.isMargin))),t={};e.forEach(((e,n)=>{t[n]=e.excludeFromExport,e.excludeFromExport=!1}));const i=JSON.stringify(n.canvas.toJSON(["metadata","excludeFromExport"]));n.downloadJSON(i),e.forEach(((e,n)=>{e.excludeFromExport=t[n]}))}a.forEach((e=>{e.visible=!0})),i.renderAll()}))):"undo"===e?n.undo():"redo"===e?n.redo():"animation"===e&&n.animations.runAnimation()}))})(),$(`${this.containerSelector}`).append('<div id="footerbar" class="toolbar"></div>')}catch(e){console.error("can't create toolbar")}}}(),window.ImageEditor.prototype.initializeAligningGuidelines=function(e){var t,n=e.getSelectionContext(),i=1,a="rgb(0,255,0)",o=1;function s(e){l(e.x1>e.x2?e.x2:e.x1,e.y+.5,e.x2>e.x1?e.x2:e.x1,e.y+.5)}function l(e,s,l,r){n.save(),n.lineWidth=i,n.strokeStyle=a,n.beginPath(),n.moveTo(e*o+t[4],s*o+t[5]),n.lineTo(l*o+t[4],r*o+t[5]),n.stroke(),n.restore()}function r(e,t){e=Math.round(e),t=Math.round(t);for(var n=e-4,i=e+4;n<=i;n++)if(n===t)return!0;return!1}var c=[],d=[];e.on("mouse:down",(function(){t=e.viewportTransform,o=e.getZoom()})),e.on("object:moving",(function(n){var i=n.target,a=e.getObjects(),o=i.getCenterPoint(),s=o.x,l=o.y,h=i.getBoundingRect(),p=h.height/t[3],u=h.width/t[0],v=!1,g=!1;if(e._currentTransform){for(var m=a.length;m--;)if(a[m]!==i){var f=a[m].getCenterPoint(),b=f.x,y=f.y,w=a[m].getBoundingRect(),k=w.height/t[3],x=w.width/t[0];r(s+u/2,b-x/2)&&(g=!0,c.push({x:b-x/2,y1:y<l?y-k/2-5:y+k/2+5,y2:l>y?l+p/2+5:l-p/2-5}),i.setPositionByOrigin(new fabric.Point(b-x/2-u/2,l),"center","center")),r(s-u/2,b+x/2)&&(g=!0,c.push({x:b+x/2,y1:y<l?y-k/2-5:y+k/2+5,y2:l>y?l+p/2+5:l-p/2-5}),i.setPositionByOrigin(new fabric.Point(b+x/2+u/2,l),"center","center")),r(y+k/2,l-p/2)&&(v=!0,d.push({y:y+k/2,x1:b<s?b-x/2-5:b+x/2+5,x2:s>b?s+u/2+5:s-u/2-5}),i.setPositionByOrigin(new fabric.Point(s,y+k/2+p/2),"center","center")),r(y-k/2,l+p/2)&&(v=!0,d.push({y:y-k/2,x1:b<s?b-x/2-5:b+x/2+5,x2:s>b?s+u/2+5:s-u/2-5}),i.setPositionByOrigin(new fabric.Point(s,y-k/2-p/2),"center","center")),r(b,s)&&(g=!0,c.push({x:b,y1:y<l?y-k/2-5:y+k/2+5,y2:l>y?l+p/2+5:l-p/2-5}),i.setPositionByOrigin(new fabric.Point(b,l),"center","center")),r(b-x/2,s-u/2)&&(g=!0,c.push({x:b-x/2,y1:y<l?y-k/2-5:y+k/2+5,y2:l>y?l+p/2+5:l-p/2-5}),i.setPositionByOrigin(new fabric.Point(b-x/2+u/2,l),"center","center")),r(b+x/2,s+u/2)&&(g=!0,c.push({x:b+x/2,y1:y<l?y-k/2-5:y+k/2+5,y2:l>y?l+p/2+5:l-p/2-5}),i.setPositionByOrigin(new fabric.Point(b+x/2-u/2,l),"center","center")),r(y,l)&&(v=!0,d.push({y,x1:b<s?b-x/2-5:b+x/2+5,x2:s>b?s+u/2+5:s-u/2-5}),i.setPositionByOrigin(new fabric.Point(s,y),"center","center")),r(y-k/2,l-p/2)&&(v=!0,d.push({y:y-k/2,x1:b<s?b-x/2-5:b+x/2+5,x2:s>b?s+u/2+5:s-u/2-5}),i.setPositionByOrigin(new fabric.Point(s,y-k/2+p/2),"center","center")),r(y+k/2,l+p/2)&&(v=!0,d.push({y:y+k/2,x1:b<s?b-x/2-5:b+x/2+5,x2:s>b?s+u/2+5:s-u/2-5}),i.setPositionByOrigin(new fabric.Point(s,y+k/2-p/2),"center","center"))}v||(d.length=0),g||(c.length=0)}})),e.on("before:render",(function(){e.contextTop&&e.clearContext(e.contextTop)})),e.on("after:render",(function(){for(var e=c.length;e--;)l((t=c[e]).x+.5,t.y1>t.y2?t.y2:t.y1,t.x+.5,t.y2>t.y1?t.y2:t.y1);var t;for(e=d.length;e--;)s(d[e]);c.length=d.length=0})),e.on("mouse:up",(function(){c.length=d.length=0,e.renderAll()}))},window.ImageEditor.prototype.initializeCenteringGuidelines=function(e){for(var t,n=e.getWidth(),i=e.getHeight(),a=n/2,o=i/2,s={},l={},r=e.getSelectionContext(),c=a-4,d=a+4;c<=d;c++)s[Math.round(c)]=!0;for(c=o-4,d=o+4;c<=d;c++)l[Math.round(c)]=!0;function h(e,n,i,a){r.save(),r.strokeStyle="rgba(255,0,241,0.5)",r.lineWidth=1,r.beginPath(),r.moveTo(e*t[0],n*t[3]),r.lineTo(i*t[0],a*t[3]),r.stroke(),r.restore()}var p,u;e.on("mouse:down",(function(){t=e.viewportTransform})),e.on("object:moving",(function(t){var n=t.target,i=n.getCenterPoint();e._currentTransform&&(p=Math.round(i.x)in s,((u=Math.round(i.y)in l)||p)&&n.setPositionByOrigin(new fabric.Point(p?a:i.x,u?o:i.y),"center","center"))})),e.on("before:render",(function(){e.contextTop&&e.clearContext(e.contextTop)})),e.on("after:render",(function(){p&&h(a+.5,0,a+.5,i),u&&h(0,o+.5,n,o+.5)})),e.on("mouse:up",(function(){p=u=null,e.renderAll()}))},function(){"use strict";window.ImageEditor.prototype.initializeCanvas=function(){try{$(`${this.containerSelector} .main-panel`).append('<div class="canvas-holder" id="canvas-holder"><div class="content"><canvas id="c"></canvas></div></div>'),fabric.Object.prototype.toObject=(t=fabric.Object.prototype.toObject,function(e){var n=t.call(this,e);return n.animation=this.animation,n}),fabric.Object.prototype.initialize=(e=fabric.Object.prototype.initialize,function(t){e.call(this,t),this.animation=t.animation||null}),fabric.Object.prototype.originX="center",fabric.Object.prototype.originY="center";const n={renderOnAddRemove:!1},i=new fabric.Canvas("c",n).setDimensions(this.dimensions);i.originalW=i.width,i.originalH=i.height,fabric.Object.prototype.transparentCorners=!1,fabric.Object.prototype.cornerStyle="circle",fabric.Object.prototype.borderColor="#8b3dff",fabric.Object.prototype.cornerColor="#ffffff",fabric.Object.prototype.cornerStrokeColor="#6d6d6d",fabric.Object.prototype.padding=0;const a=`data:image/svg+xml;utf8,${encodeURIComponent('\n        <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <g filter="url(#filter0_d)">\n            <circle cx="9" cy="9" r="5" fill="white"/>\n            <circle cx="9" cy="9" r="4.75" stroke="black" stroke-opacity="0.3" stroke-width="0.5"/>\n          </g>\n            <path d="M10.8047 11.1242L9.49934 11.1242L9.49934 9.81885" stroke="black" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round"/>\n            <path d="M6.94856 6.72607L8.25391 6.72607L8.25391 8.03142" stroke="black" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round"/>\n            <path d="M9.69517 6.92267C10.007 7.03301 10.2858 7.22054 10.5055 7.46776C10.7252 7.71497 10.8787 8.01382 10.9517 8.33642C11.0247 8.65902 11.0148 8.99485 10.9229 9.31258C10.831 9.63031 10.6601 9.91958 10.4262 10.1534L9.49701 11.0421M8.25792 6.72607L7.30937 7.73554C7.07543 7.96936 6.90454 8.25863 6.81264 8.57636C6.72073 8.89408 6.71081 9.22992 6.78381 9.55251C6.8568 9.87511 7.01032 10.174 7.23005 10.4212C7.44978 10.6684 7.72855 10.8559 8.04036 10.9663" stroke="black" stroke-width="0.5" stroke-linecap="round" stroke-linejoin="round"/>\n          <defs>\n          <filter id="filter0_d" x="0" y="0" width="18" height="18" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n            <feFlood flood-opacity="0" result="BackgroundImageFix"/>\n            <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/>\n            <feOffset/>\n            <feGaussianBlur stdDeviation="2"/>\n            <feColorMatrix type="matrix" values="0 0 0 0 0.137674 0 0 0 0 0.190937 0 0 0 0 0.270833 0 0 0 0.15 0"/>\n            <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow"/>\n            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>\n          </filter>\n          </defs>\n        </svg>\n        ')}`,o=document.createElement("img");function s(e,t,n,i,a){var s=this.cornerSize;e.save(),e.translate(t,n),e.rotate(fabric.util.degreesToRadians(a.angle)),e.drawImage(o,-s/2,-s/2,s,s),e.restore()}o.src=a,fabric.Object.prototype.controls.mtr=new fabric.Control({x:0,y:.5,offsetX:0,offsetY:40,actionHandler:fabric.controlsUtils.rotationWithSnapping,actionName:"rotate",render:s,cornerSize:38,withConnection:!0}),i.preserveObjectStacking=!0,i.on("selection:created",(e=>this.setActiveSelection(e.selected))),i.on("selection:updated",(e=>this.setActiveSelection(e.selected))),i.on("selection:cleared",(e=>this.setActiveSelection(null))),i.on("object:rotating",(e=>{e.e.shiftKey?e.target.snapAngle=15:e.target.snapAngle=!1})),i.on("object:rotating",(e=>{var t=e.target,n=Math.round(t.angle);if(t.angleText)a=t.angleText.item(1),o=t.angleText.item(0),a.set("text",n+"°"),o.set({width:a.width+20,height:a.height+20}),t.angleText.setCoords();else{var a=new fabric.Text(n+"°",{fontSize:18,fill:"white",fontFamily:"sans-serif",originX:"center",originY:"center"}),o=new fabric.Rect({fill:"#333333",width:a.width+20,height:a.height+20,rx:5,ry:5,stroke:"white",strokeWidth:1,originX:"center",originY:"center"});t.angleText=new fabric.Group([o,a],{originX:"center",originY:"center"}),i.on("mouse:move",(function(e){if(t.angleText){const n=i.getPointer(e.e);t.angleText.set({left:n.x+50,top:n.y+50}),i.renderAll()}})),i.add(t.angleText)}t.angleText.set({left:t.left,top:t.top-10}),t.set({hasControls:!1}),i.renderAll()})),i.on("mouse:up",(function(e){i.getActiveObject()&&i.getActiveObject().angleText&&(i.remove(i.getActiveObject().angleText),i.getActiveObject().angleText=null,i.renderAll())})),i.on("object:moving",(e=>{var t=e.target;this.handleObjectMoving(i,t),t.set({hasControls:!1})})),i.on("object:scaling",(e=>{e.target.set({hasControls:!1})})),i.on("object:modified",(e=>{if(this.canvas){let e=this.canvas.toJSON();this.history?this.history.push(JSON.stringify(e)):console.error("History (this.history) is not defined.")}else console.error("Canvas (this.canvas) is not defined.");this.clearGuidesline(i);var t=e.target;!t||t.metadata||t.metadata?.isGuide||t.metadata?.isMargin||t.set({hasControls:!0})}));let l=null;if(window.saveInBrowser)try{l=window.saveInBrowser.load("canvasEditor"),l&&(console.log("loading canvas from local storage",l),i.loadFromJSON(l,(()=>{i.getObjects().forEach((e=>{e.locked&&(e.lockMovementX=!0,e.lockMovementY=!0,e.lockScalingX=!0,e.lockScalingY=!0,e.lockRotation=!0,e.lockUniScaling=!0,e.lockSkewingX=!0,e.lockSkewingY=!0,e.selectable=!0,e.hasControls=!0,e.hasRotatingPoint=!0)})),i.renderAll()})))}catch(r){console.error("Erro ao carregar canvas salvo:",r)}else console.warn("saveInBrowser não está disponível. O canvas não será carregado do armazenamento local.");return document.addEventListener("keydown",(e=>{const t=e.which||e.keyCode;let n;document.querySelectorAll("textarea:focus, input:focus").length>0||(37!==t&&38!==t&&39!==t&&40!==t||(e.preventDefault(),n=i.getActiveObject(),n))&&(37===t?n.left-=1:39===t?n.left+=1:38===t?n.top-=1:40===t&&(n.top+=1),37!==t&&38!==t&&39!==t&&40!==t||(n.setCoords(),i.renderAll(),i.fire("object:modified")))})),document.addEventListener("keydown",(e=>{46===(e.which||e.keyCode)&&0===document.querySelectorAll("textarea:focus, input:focus").length&&(i.getActiveObjects().forEach((e=>{i.remove(e)})),i.discardActiveObject().requestRenderAll(),i.fire("object:modified"))})),document.addEventListener("mousedown",(e=>{document.getElementById("canvas-holder")==e.target&&(i.discardActiveObject(),i.renderAll())})),setTimeout((()=>{let e=i.toJSON();this.history&&this.history.push(JSON.stringify(e))}),1e3),this.canvas=i,this.initRulerComponent?this.initRulerComponent():console.warn("initRulerComponent não está disponível"),setTimeout((()=>{this.setupRulerAfterCanvasReady?this.setupRulerAfterCanvasReady():console.warn("setupRulerAfterCanvasReady não está disponível")}),500),i}catch(c){return console.error("can't create canvas instance",c),null}var e,t}}(),function(){"use strict";const e=['<svg viewBox="-10 -10 120 120"><polygon points="0 0, 0 100, 100 100, 100 0" stroke-width="8" stroke="#000" fill="none"></polygon></svg>','<svg viewBox="-8 -8 120 120"><polygon fill="none" stroke-width="8" stroke="black" points="50 0, 85 50, 50 100, 15 50"></polygon></svg>','<svg viewBox="-10 -10 120 120"><polygon points="25 0, 0 100, 75 100, 100 0" stroke-width="8" stroke="#000" fill="none"></polygon></svg>','<svg viewBox="-8 -8 120 120"><polygon points="0,100 30,10 70,10 100,100" stroke-width="8" stroke="#000" fill="none"></polygon></svg>','<svg viewBox="-10 -10 120 120"><path d="M 80,80 V 20 H 20 v 60 z m 20,20 V 0 H 0 v 100 z" stroke-width="8" stroke="#000" fill-rule="evenodd" fill="none"></path></svg>','<svg viewBox="0 0 100 100"><polygon points="26,86 11.2,40.4 50,12.2 88.8,40.4 74,86 " stroke="#000" stroke-width="8" fill="none"></polygon></svg>','<svg viewBox="0 0 100 100"><polygon points="30.1,84.5 10.2,50 30.1,15.5 69.9,15.5 89.8,50 69.9,84.5" stroke-width="8" stroke="#000" fill="none"></polygon></svg>','<svg viewBox="0 0 100 100"><polygon points="34.2,87.4 12.3,65.5 12.3,34.5 34.2,12.6 65.2,12.6 87.1,34.5 87.1,65.5 65.2,87.4" stroke-width="8" stroke="#000" fill="none"></polygon></svg>','<svg viewBox="0 0 100 100"><polygon points="11.2,70 11.2,40 50,12.2 88.8,40 88.8,70" stroke="#000" stroke-width="8" fill="none"></polygon></svg>','<svg viewBox="0 0 100 100"><polygon points="10.2,70 10.2,35 30.1,15 69.9,15 89.8,35 89.8,70" stroke-width="8" stroke="#000" fill="none"></polygon></svg>','<svg viewBox="-10 -10 120 120"><polygon points="50 15, 100 100, 0 100" stroke-width="8" stroke="#000" fill="none"></polygon></svg>','<svg viewBox="-10 -10 120 120"><polygon points="0 0, 100 100, 0 100" stroke-width="8" stroke="#000" fill="none"></polygon></svg>','<svg viewBox="-10 -10 120 120"><path d="M 26,85 50,45 74,85 Z m -26,15 50,-85 50,85 z" stroke-width="8" stroke="#000" fill="none"></path></svg>','<svg viewBox="8 50 100 100"><path d="M 62.68234,131.5107 H 26.75771 V 96.075507 Z M 11.572401,146.76255 V 59.66782 l 87.983665,87.09473 z" stroke-width="8" stroke="#000" fill="none" fill-rule="evenodd"></path></svg>','<svg viewBox="-2 -2 100 100"><circle cx="50" cy="50" r="40" stroke="#000" stroke-width="8" fill="none"></circle></svg>','<svg x="0px" y="0px" viewBox="0 0 96 120" xml:space="preserve"><path stroke="#000" stroke-width="8" fill="none" d="M9.113,65.022C11.683,45.575,28.302,30.978,48,30.978c19.696,0,36.316,14.598,38.887,34.045H9.113z"></path></svg>','<svg viewBox="-15 -15 152 136"><path stroke="#000000" stroke-width="8" d="m0 0l57.952755 0l0 0c32.006428 -1.4055393E-14 57.952755 23.203636 57.952755 51.82677c0 28.623135 -25.946327 51.82677 -57.952755 51.82677l-57.952755 0z" fill="none"></path></svg>','<svg viewBox="-5 -50 140 140"><path stroke="#000000" stroke-width="8" d="m20.013628 0l84.37401 0l0 0c11.053215 -1.04756605E-14 20.013626 9.282301 20.013626 20.7326c0 11.450296 -8.960411 20.7326 -20.013626 20.7326l-84.37401 0l0 0c-11.053222 0 -20.013628 -9.282303 -20.013628 -20.7326c-5.2380687E-15 -11.450298 8.960406 -20.7326 20.013628 -20.7326z" fill="none"></path></svg>','<svg viewBox="-8 -8 136 136"><path stroke="#000000" stroke-width="8" d="m0 51.82677l0 0c0 -28.623135 23.203636 -51.82677 51.82677 -51.82677l0 0c13.745312 0 26.927654 5.4603047 36.64706 15.17971c9.719406 9.719404 15.17971 22.901749 15.17971 36.64706l0 0c0 28.623135 -23.203636 51.82677 -51.82677 51.82677l0 0c-28.623135 0 -51.82677 -23.203636 -51.82677 -51.82677zm25.913385 0l0 0c0 14.311565 11.60182 25.913387 25.913385 25.913387c14.311565 0 25.913387 -11.601822 25.913387 -25.913387c0 -14.311565 -11.601822 -25.913385 -25.913387 -25.913385l0 0c-14.311565 0 -25.913385 11.60182 -25.913385 25.913385z" fill="none"></path></svg>','<svg viewBox="-7 -35 133 105"><path stroke="#000000" stroke-width="8" d="m0 57.952755l0 0c0 -32.006424 25.946333 -57.952755 57.952755 -57.952755c32.006428 0 57.952755 25.946333 57.952755 57.952755l-28.97638 0c0 -16.003212 -12.97316 -28.976377 -28.976376 -28.976377c-16.003212 0 -28.976377 12.9731655 -28.976377 28.976377z" fill="none"></path></svg>','<svg viewBox="-10 -10 150 150" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10"><path stroke="#000000" stroke-width="8" stroke-linejoin="round" stroke-linecap="butt" d="m0 51.82677l42.665005 -9.161766l9.161766 -42.665005l9.161766 42.665005l42.665005 9.161766l-42.665005 9.161766l-9.161766 42.665005l-9.161766 -42.665005z" fill-rule="evenodd" fill="none"></path></svg>','<svg viewBox="-15 -15 137 130"><path stroke="#000000" stroke-width="8" d="m1.09633125E-4 37.631077l39.59224 2.632141E-4l12.234421 -37.63134l12.234425 37.63134l39.59224 -2.632141E-4l-32.030952 23.257183l12.234924 37.631172l-32.030636 -23.257607l-32.03064 23.257607l12.234926 -37.631172z" fill="none"></path></svg>','<svg viewBox="-10 -10 150 150" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10"><path stroke="#000000" stroke-width="8" stroke-linejoin="round" stroke-linecap="butt" d="m0 59.82677l27.527777 -8.654488l-19.512508 -21.258898l28.167 6.268881l-6.268881 -28.167l21.258898 19.512508l8.654488 -27.527777l8.654491 27.527777l21.258896 -19.512508l-6.2688828 28.167l28.167 -6.268881l-19.512512 21.258898l27.527779 8.654488l-27.527779 8.654491l19.512512 21.258896l-28.167 -6.2688828l6.2688828 28.167l-21.258896 -19.512512l-8.654491 27.527779l-8.654488 -27.527779l-21.258898 19.512512l6.268881 -28.167l-28.167 6.2688828l19.512508 -21.258896z" fill-rule="evenodd"></path></svg>','<svg viewBox="-10 -10 150 150" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10"><path stroke="#000000" stroke-width="8" stroke-linejoin="round" stroke-linecap="butt" d="m0 59.82677l33.496998 -3.4664993l-31.45845 -12.017807l33.252647 5.321434l-27.275928 -19.750513l30.742428 13.746485l-21.234838 -26.137014l26.137014 21.234838l-13.746485 -30.742428l19.750513 27.275928l-5.321434 -33.252647l12.017807 31.45845l3.4664993 -33.496998l3.4664993 33.496998l12.017811 -31.45845l-5.321434 33.252647l19.750511 -27.275928l-13.746483 30.742428l26.137009 -21.234838l-21.234833 26.137014l30.742424 -13.746485l-27.275925 19.750513l33.252647 -5.321434l-31.45845 12.017807l33.496994 3.4664993l-33.496994 3.4664993l31.45845 12.017811l-33.252647 -5.321434l27.275925 19.750511l-30.742424 -13.746483l21.234833 26.137009l-26.137009 -21.234833l13.746483 30.742424l-19.750511 -27.275925l5.321434 33.252647l-12.017811 -31.45845l-3.4664993 33.496994l-3.4664993 -33.496994l-12.017807 31.45845l5.321434 -33.252647l-19.750513 27.275925l13.746485 -30.742424l-26.137014 21.234833l21.234838 -26.137009l-30.742428 13.746483l27.275928 -19.750511l-33.252647 5.321434l31.45845 -12.017811z" fill-rule="evenodd"></path></svg>','<svg viewBox="-10 -10 150 150" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10"><path stroke="#000000" stroke-width="8" stroke-linejoin="round" stroke-linecap="butt" d="m0 59.82677l9.952638 -6.5662766l-7.91409 -8.91803l11.312678 -3.7663116l-5.3359585 -10.662767l11.902236 -0.7101288l-2.3946476 -11.680401l11.680401 2.3946476l0.7101288 -11.902236l10.662767 5.3359585l3.7663116 -11.312678l8.91803 7.91409l6.5662766 -9.952638l6.5662804 9.952638l8.91803 -7.91409l3.7663116 11.312678l10.6627655 -5.3359585l0.7101288 11.902236l11.680397 -2.3946476l-2.3946457 11.680401l11.902237 0.7101288l-5.3359604 10.662767l11.312683 3.7663116l-7.914093 8.91803l9.952637 6.5662766l-9.952637 6.5662804l7.914093 8.91803l-11.312683 3.7663116l5.3359604 10.6627655l-11.902237 0.7101288l2.3946457 11.680397l-11.680397 -2.3946457l-0.7101288 11.902237l-10.6627655 -5.3359604l-3.7663116 11.312683l-8.91803 -7.914093l-6.5662804 9.952637l-6.5662766 -9.952637l-8.91803 7.914093l-3.7663116 -11.312683l-10.662767 5.3359604l-0.7101288 -11.902237l-11.680401 2.3946457l2.3946476 -11.680397l-11.902236 -0.7101288l5.3359585 -10.6627655l-11.312678 -3.7663116l7.91409 -8.91803z" fill-rule="evenodd"></path></svg>','<svg viewBox="-10 -40 140 140" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10"><path stroke="#000000" stroke-width="8" stroke-linejoin="round" stroke-linecap="butt" d="m0 14.960629l89.732285 0l0 -14.960629l29.921257 29.921259l-29.921257 29.921259l0 -14.9606285l-89.732285 0z" fill-rule="evenodd"></path></svg>','<svg viewBox="-10 -60 180 180" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10"><path stroke="#000000" stroke-width="8" stroke-linecap="butt" d="m0 32.238846l27.590551 -27.590551l0 13.795275l82.80315 0l0 -13.795275l27.590553 27.590551l-27.590553 27.59055l0 -13.795273l-82.80315 0l0 13.795273z" fill-rule="evenodd"></path></svg>','<svg viewBox="-10 -10 150 150" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10"><path stroke="#000000" stroke-width="8" stroke-linecap="butt" d="m0.005249344 89.74016l29.913385 -29.913387l0 14.956692l44.87008 0l0 -44.87008l-14.956692 0l29.913387 -29.913385l29.913383 29.913385l-14.956688 0l0 74.78347l-74.78347 0l0 14.956688z" fill-rule="evenodd"></path></svg>','<svg viewBox="-10 -20 200 200" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10"><path stroke="#000000" stroke-width="8" stroke-linecap="butt" d="m0.005249344 89.74016l29.913385 -29.913387l0 14.956692l40.35827 0l0 -44.87008l-14.956692 0l29.913387 -29.913385l29.913383 29.913385l-14.956688 0l0 44.87008l40.35826 0l0 -14.956692l29.913391 29.913387l-29.913391 29.913383l0 -14.956688l-110.62992 0l0 14.956688z" fill-rule="evenodd"></path></svg>','<svg viewBox="-10 -10 150 150" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10"><path stroke="#000000" stroke-width="8" stroke-linecap="butt" d="m0.005249344 59.82677l26.922047 -19.30849l0 9.424511l23.020744 0l0 -23.020744l-9.424511 0l19.30849 -26.922047l19.30849 26.922047l-9.424507 0l0 23.020744l23.020744 0l0 -9.424511l26.922043 19.30849l-26.922043 19.30849l0 -9.424507l-23.020744 0l0 23.020744l9.424507 0l-19.30849 26.922043l-19.30849 -26.922043l9.424511 0l0 -23.020744l-23.020744 0l0 9.424507z" fill-rule="evenodd"></path></svg>','<svg viewBox="-10 -10 158 136" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10"><path stroke="#000000" stroke-width="8" stroke-linecap="butt" d="m0 77.22078l81.043304 0l0 -51.480316l-12.870079 0l25.740158 -25.740158l25.740158 25.740158l-12.870079 0l0 77.220474l-106.78346 0z" fill-rule="evenodd"></path></svg>','<svg viewBox="-10 -10 136 136" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10"><path stroke="#000000" stroke-width="8" stroke-linecap="butt" d="m0 102.96063l0 -57.915356l0 0c0 -24.87782 20.167458 -45.045277 45.045277 -45.045277l0 0l0 0c11.946751 0 23.404194 4.7458277 31.851818 13.193456c8.447632 8.447627 13.193459 19.905071 13.193459 31.851822l0 6.4350395l12.870079 0l-25.740158 25.740158l-25.740158 -25.740158l12.870079 0l0 -6.4350395c0 -10.661922 -8.643196 -19.305119 -19.305119 -19.305119l0 0l0 0c-10.661922 0 -19.305119 8.643196 -19.305119 19.305119l0 57.915356z" fill-rule="evenodd"></path></svg>','<svg viewBox="-10 -10 180 180" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10"><path stroke="#000000" stroke-width="8" stroke-linecap="butt" d="m0 0l25.742783 0l0 0l38.614174 0l90.09974 0l0 52.74803l0 0l0 22.6063l0 15.070862l-90.09974 0l-61.5304 52.813744l22.916225 -52.813744l-25.742783 0l0 -15.070862l0 -22.6063l0 0z" fill-rule="evenodd"></path></svg>','<svg viewBox="-10 -10 180 180" fill="none" stroke="none" stroke-linecap="square" stroke-miterlimit="10"><path stroke="#000000" stroke-width="8" stroke-linejoin="round" stroke-linecap="butt" d="m1.0425826 140.35696l25.78009 -49.87359l0 0c-30.142242 -17.309525 -35.62507 -47.05113 -12.666686 -68.71045c22.958385 -21.65932 66.84442 -28.147947 101.387596 -14.990329c34.543175 13.1576185 48.438576 41.655407 32.10183 65.83693c-16.336761 24.181526 -57.559166 36.132935 -95.233955 27.61071z" fill-rule="evenodd"></path></svg>','<svg viewBox="0 -5 100 100" x="0px" y="0px"><path fill="none" stroke="#000" stroke-width="6" d="M55.2785222,56.3408313 C51.3476874,61.3645942 45.2375557,64.5921788 38.3756345,64.5921788 C31.4568191,64.5921788 25.3023114,61.3108505 21.3754218,56.215501 C10.6371566,55.0276798 2.28426396,45.8997866 2.28426396,34.8156425 C2.28426396,27.0769445 6.35589452,20.2918241 12.4682429,16.4967409 C14.7287467,7.0339786 23.2203008,0 33.3502538,0 C38.667844,0 43.5339584,1.93827732 47.284264,5.14868458 C51.0345695,1.93827732 55.9006839,0 61.2182741,0 C73.0769771,0 82.6903553,9.6396345 82.6903553,21.5307263 C82.6903553,22.0787821 82.6699341,22.6220553 82.629813,23.1598225 C87.1459866,27.1069477 90,32.9175923 90,39.396648 C90,51.2877398 80.3866218,60.9273743 68.5279188,60.9273743 C63.5283115,60.9273743 58.9277995,59.2139774 55.2785222,56.3408313 L55.2785222,56.3408313 Z M4.79695431,82 C7.44623903,82 9.59390863,80.6668591 9.59390863,79.0223464 C9.59390863,77.3778337 7.44623903,76.0446927 4.79695431,76.0446927 C2.1476696,76.0446927 0,77.3778337 0,79.0223464 C0,80.6668591 2.1476696,82 4.79695431,82 Z M13.7055838,71.9217877 C18.4995275,71.9217877 22.3857868,69.4606044 22.3857868,66.424581 C22.3857868,63.3885576 18.4995275,60.9273743 13.7055838,60.9273743 C8.91163999,60.9273743 5.02538071,63.3885576 5.02538071,66.424581 C5.02538071,69.4606044 8.91163999,71.9217877 13.7055838,71.9217877 Z"></path></svg>','<svg viewBox="-25 -25 550 550" x="0px" y="0px"><path d="M369.214 159.814c-91.389-55.601-48.533-134.078-46.693-137.34A14.999 14.999 0 0 0 309.515 0c-47.043 0-83.881 13.366-109.49 39.729-43.759 45.044-41.729 115.151-40.862 145.088.097 3.317.179 6.182.179 8.311 0 22.228 3.566 42.748 6.713 60.854 2.028 11.668 3.779 21.744 4.091 29.664.333 8.482-1.216 10.424-1.281 10.503-.221.263-2.062 1.241-7.036 1.241-5.674 0-9.856-1.854-13.563-6.009-14.476-16.233-15.477-60.554-12.709-84.667a14.999 14.999 0 0 0-14.898-16.732c-38.945 0-68.047 63.688-68.047 120.632 0 26.769 5.385 52.991 16.004 77.94 10.266 24.119 24.904 45.885 43.512 64.696C150.877 490.425 201.97 512 255.993 512c54.242 0 105.321-21.27 143.831-59.889 38.41-38.521 59.564-89.482 59.564-143.499 0-68.921-53.927-126.746-90.174-148.798z" fill="#000000" stroke-width="0" stroke="transparent"></path></svg>','<svg  viewBox="0 -28 512 512"><path d="M471.383 44.578C444.879 15.832 408.512 0 368.973 0c-29.555 0-56.621 9.344-80.45 27.77C276.5 37.07 265.605 48.45 256 61.73c-9.602-13.277-20.5-24.66-32.527-33.96C199.648 9.344 172.582 0 143.027 0c-39.539 0-75.91 15.832-102.414 44.578C14.426 72.988 0 111.801 0 153.871c0 43.3 16.137 82.938 50.781 124.742 30.992 37.395 75.535 75.356 127.117 119.313 17.614 15.012 37.579 32.027 58.309 50.152A30.023 30.023 0 0 0 256 455.516a30.03 30.03 0 0 0 19.785-7.43c20.73-18.129 40.707-35.152 58.328-50.172 51.575-43.95 96.117-81.906 127.11-119.305C495.867 236.81 512 197.172 512 153.867c0-42.066-14.426-80.879-40.617-109.289zm0 0" fill="#000000" stroke-width="0" stroke="transparent"></path></svg>','<svg viewBox="0 0 24 24"><path d="M6 0H1a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1zm0 8.5H1a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1zm9.5 6v-5a1 1 0 0 0-1-1h-5a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1zm0-8.5V1a1 1 0 0 0-1-1h-5a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1zM23 0h-5a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1zm-5 15.5h5a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1h-5a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1zm0 8.5h5a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1h-5a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1zM0 18v5a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1H1a1 1 0 0 0-1 1zm8.5 0v5a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1h-5a1 1 0 0 0-1 1z" fill="#00000" stroke-width="0" stroke="transparent"></path></svg>','<svg viewBox="0 0 511.999 511.999" ><path d="M498.523 246.291c37.941-67.923-8.514-149.499-85.88-157.204l-28.232-2.813c-20.59-2.053-38.982-10.974-54.263-28.128-53.185-59.695-152.219-44.954-184.82 26.764-7.94 17.466-22.298 31.438-40.428 39.344l-39.773 17.34c-63.399 27.64-84.894 104.334-44.848 159.183l25.236 34.563c5.481 7.508 9.482 15.807 11.893 24.666l12.532 46.073c17.167 63.115 88.755 97.22 151.241 70.693l5.35-2.271c15.901-6.751 33.992-8.387 50.932-4.616l82.048 18.269c79.933 17.798 150.39-51.574 132.54-127.825l-10.384-44.351c-4.203-17.953-1.524-36.78 7.544-53.012l9.312-16.675z" fill="#00000" stroke-width="0" stroke="transparent"></path></svg>','<svg  viewBox="0 0 200 200" ><path  d="M170 129.496C170 168.434 138.66 200 100 200s-70-31.566-70-70.504c0-36.857 35.84-81.29 65.113-122.542 2.4-3.381 7.425-3.415 9.861-.06C135.351 48.737 170 92.591 170 129.496Z" fill="#00000" stroke-width="0" stroke="transparent"></path></svg>'];window.ImageEditor.prototype.initializeShapes=function(){const t=this;let n=e;Array.isArray(this.shapes)&&this.shapes.length&&n.push(...this.shapes),$(`${this.containerSelector} .main-panel`).append('<div class="toolpanel" id="shapes-panel"><div class="content"><p class="title">Shapes</p></div></div>'),n.forEach((e=>{$(`${this.containerSelector} .toolpanel#shapes-panel .content`).append(`<div class="button">${e}</div>`)})),$(`${this.containerSelector} .toolpanel#shapes-panel .content .button`).click((function(){let e=$(this).html();try{fabric.loadSVGFromString(e,((e,n)=>{var i=fabric.util.groupSVGElements(e,n);i.scaleToWidth(300),i.scaleToHeight(300),i.set({left:100,top:100,strokeUniform:!0,strokeLineJoin:"miter",strokeWidth:0,fill:"#000000"}),t.canvas.add(i).setActiveObject(i).renderAll(),t.canvas.fire("object:modified")}))}catch(e){console.error("can't add shape")}}))}}(),function(){"use strict";const e=[];window.ImageEditor.prototype.initializeImages=function(){const t=this;let n=e;Array.isArray(this.images)&&this.images.length&&(n=this.images),$(`${this.containerSelector} .main-panel`).append('<div class="toolpanel" id="images-panel"><div class="content"><p class="title">Images</p></div></div>'),$(`${this.containerSelector} .toolpanel#images-panel .content`).append('<div class="drag-drop-input"><div>Drag & drop files<br>or click to browse.<br>JPG, PNG, WEBP or SVG only!</div></div>'),$(`${this.containerSelector} .toolpanel#images-panel .content`).append('<div class="list-images"></div>'),n.forEach((e=>{$(`${this.containerSelector} .toolpanel#images-panel .content .list-images`).append(`<div class="button"><img src="${e}" alt="" loading="lazy" /></div>`)})),$(`${this.containerSelector} .toolpanel#images-panel .content .list-images`).on("click",".button",(function(){let e=$(this).find("img").attr("src");try{t.addImageFromUrl(e)}catch(e){console.error("can't add image",e)}}))}}(),function(){"use strict";const e=[];window.ImageEditor.prototype.initializeTemplates=function(){const t=this;let n=[...e];Array.isArray(this.templates)&&this.templates.length&&n.push(...this.templates),$(`${this.containerSelector} .main-panel`).append('<div class="toolpanel" id="templates-panel"><div class="content"><p class="title">Templates</p></div></div>');const i=(e,t)=>{const n=JSON.stringify(e.toJSON());return{uuid:t,preview:e.toDataURL({format:"png",multiplier:.2}),data:n,timestamp:(new Date).getTime()}},a=(e,t)=>{const n=document.querySelector(`${e} .toolpanel#templates-panel .content .list-templates`);n.innerHTML="",t.forEach(((e,t)=>{const i=document.createElement("div");i.className="button list-templates-item",i.setAttribute("data-index",t);const a=document.createElement("img");a.src=e.preview,a.setAttribute("data-index",t),i.appendChild(a),n.appendChild(i)}))},o=(e,t)=>{const n=new CustomEvent("ImageEditor."+t,{detail:e});window.dispatchEvent(n)},s=(e,n={})=>"function"==typeof t.confirm?t.confirm(e,n):Promise.resolve(!0),l=e=>{const t=this,i=n[e],a=JSON.parse(i.data);t.canvas.loadFromJSON(a,(()=>{t.canvas.renderAll()}))},r=document.createElement("button");r.className="button btn",r.innerHTML="Add Template",r.onclick=()=>{const e=crypto.randomUUID(),s=i(t.canvas,e);n.push(s),t.templates=n,t.toast("Template added successfully"),o(s,"newTemplate"),a(t.containerSelector,n)};const c=document.createElement("div");c.className="tab-content",c.append(r),$(`${this.containerSelector} .toolpanel#templates-panel .content`).append(c),$(`${this.containerSelector} .toolpanel#templates-panel .content`).append('<div class="list-templates"></div>'),a(t.containerSelector,n),new ContextMenu(".list-templates-item",[{name:"Preview",fn:function(e){console.log("Preview",e);try{t.toast("Preview coming soon")}catch(e){console.warn("Preview coming soon")}}},{name:"Salvar",fn:function(e){const l=e.getAttribute("data-index");(async e=>{if(e>=0&&e<n.length){if(!await s("Are you sure you want to save and replace this template?",{confirmLabel:"Save",cancelLabel:"Cancel"}))return;const l=n[e].uuid,r=i(t.canvas,l);n[e]=r,t.templates=n,o(r,"saveTemplate"),a(t.containerSelector,n),t.toast("Template salvo com sucesso")}})(parseInt(l))}},{name:"Clone",fn:function(e){const i=e.getAttribute("data-index");(e=>{if(e>=0&&e<n.length){const i=n[e],s={...i,timestamp:(new Date).getTime(),uuid:crypto.randomUUID(),preview:i.preview};n.push(s),t.templates=n,o(s,"newTemplate"),a(t.containerSelector,n),t.toast("Template cloned successfully")}})(parseInt(i))}},{},{name:"Delete",fn:function(e){const i=e.getAttribute("data-index");(async e=>{if(e>=0&&e<n.length){if(!await s("Are you sure you want to delete this template?",{confirmLabel:"Delete",cancelLabel:"Cancel"}))return;const i=n[e];n.splice(e,1),t.templates=n,o(i,"deleteTemplate"),a(t.containerSelector,n),t.toast("Template excluído com sucesso")}})(parseInt(i))}}]),$(`${this.containerSelector} .toolpanel#templates-panel .content .list-templates`).on("click",".button",(function(){try{let e=$(this).data("index");l(e)}catch(e){console.error("can't add template",e)}}))}}(),function(){"use strict";window.ImageEditor.prototype.initializeFreeDrawSettings=function(){let e=1,t="pencil",n="black";const i=this;$(`${this.containerSelector} .main-panel`).append('<div class="toolpanel" id="draw-panel"><div class="content"><p class="title">Free Draw</p></div></div>'),$(`${this.containerSelector} .toolpanel#draw-panel .content`).append('\n      <div>\n        <div class="input-container">\n          <label>Brush Width</label>\n          <div class="custom-number-input">\n          <button class="decrease">-</button>\n          <input type="number" min="1" value="1" id="input-brush-width"/>\n          <button class="increase">+</button>\n          </div>\n        </div>\n        <div class="input-container">\n          <label>Brush Type</label>\n          <select id="input-brush-type">\n            <option value="pencil" selected>Pencil</option>\n            <option value="circle">Circle</option>\n            <option value="spray">Spray</option>\n          </select>\n        </div>\n        <div class="input-container">\n          <label>Brush Color</label>\n          <input id="color-picker" value=\'black\'/>\n        </div>\n      </div>\n    ');let a=()=>{try{switch(t){case"circle":i.canvas.freeDrawingBrush=new fabric.CircleBrush(i.canvas);break;case"spray":i.canvas.freeDrawingBrush=new fabric.SprayBrush(i.canvas);break;default:i.canvas.freeDrawingBrush=new fabric.PencilBrush(i.canvas)}i.canvas.freeDrawingBrush.width=e,i.canvas.freeDrawingBrush.color=n}catch(e){}};$(`${this.containerSelector} .toolpanel#draw-panel .content #input-brush-width`).change((function(){try{e=parseInt($(this).val()),a()}catch(e){}})),$(`${this.containerSelector} .toolpanel#draw-panel .content #input-brush-type`).change((function(){t=$(this).val(),a()})),$(`${this.containerSelector} .toolpanel#draw-panel .content #color-picker`).spectrum({type:"color",showInput:"true",showInitial:"true",allowEmpty:"false"}),$(`${this.containerSelector} .toolpanel#draw-panel .content #color-picker`).change((function(){try{n=$(this).val(),a()}catch(e){}}))}}(),function(){"use strict";window.ImageEditor.prototype.initializeCanvasSettingPanel=function(){const e=this;$(`${this.containerSelector} .main-panel`).append('<div class="toolpanel" id="background-panel"><div class="content"><p class="title">Canvas Settings</p></div></div>');const t=(e,t,n)=>{if(window.EyeDropper)$(`${e} .eyedropper-btn[data-target="${t}"]`).click((async function(){try{$(this).addClass("active"),$("body").css("cursor","crosshair");const i=new EyeDropper,a=await i.open();a&&a.sRGBHex&&($(`${e} #${t}`).spectrum("set",a.sRGBHex),$(`${e} #${t}`).trigger("change"),n&&"function"==typeof n&&n(a.sRGBHex),console.log("Cor de fundo selecionada:",a.sRGBHex))}catch(e){"AbortError"!==e.name&&(console.error("Erro ao usar EyeDropper:",e),alert("Ocorreu um erro ao selecionar a cor. Tente novamente."))}finally{$(this).removeClass("active"),$("body").css("cursor","default")}}));else{console.warn("EyeDropper API não é suportada neste navegador");const t=$(`${e} .eyedropper-not-supported`);t.length&&t.show()}};!1===e.canvasSizeBlock&&(()=>{$(`${this.containerSelector} .toolpanel#background-panel .content`).append('\n        <div class="canvas-size-setting">\n          <p>Canvas Size</p>\n          <div class="input-container">\n            <label>Width</label>\n            <div class="custom-number-input">\n            <button class="decrease">-</button>\n            <input type="number" min="100" id="input-width" value="1360"/>\n            <button class="increase">+</button>\n            </div>\n          </div>\n          <div class="input-container">\n            <label>Height</label>\n            <div class="custom-number-input">\n            <button class="decrease">-</button>\n            <input type="number" min="100" id="input-height" value="768"/>\n            <button class="increase">+</button>\n            </div>\n          </div>\n        </div>\n      ');var t=()=>{try{let t=$(`${this.containerSelector} .toolpanel#background-panel .content #input-width`).val(),n=$(`${this.containerSelector} .toolpanel#background-panel .content #input-height`).val();e.canvas.setWidth(t),e.canvas.originalW=t,e.canvas.setHeight(n),e.canvas.originalH=n,e.canvas.renderAll(),e.canvas.fire("object:modified")}catch(e){}};$(`${this.containerSelector} .toolpanel#background-panel .content #input-width`).change(t),$(`${this.containerSelector} .toolpanel#background-panel .content #input-height`).change(t)})(),(()=>{$(`${this.containerSelector} .toolpanel#background-panel .content`).append(`\n      <div class="color-settings">\n        <p>Background Color</p>\n        <div class="tab-container">\n          <div class="tabs">\n            <div class="tab-label" data-value="color-fill">Color Fill</div>\n            <div class="tab-label" data-value="gradient-fill">Gradient Fill</div>\n          </div>\n          <div class="tab-content" data-value="color-fill">\n            <div class="color-picker-container">\n              <input id="color-picker" value=''/>\n              ${window.EyeDropper?'<button type="button" class="eyedropper-btn" data-target="color-picker" title="Conta-gotas (selecionar cor da tela)">\n        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eyedropper" viewBox="0 0 16 16">\n          <path d="M13.354.646a1.207 1.207 0 0 0-1.708 0L8.5 3.793l-.646-.647a.5.5 0 1 0-.708.708L8.293 5l-7.147 7.146A.5.5 0 0 0 1 12.5v1.793l-.854.853a.5.5 0 1 0 .708.707L1.707 15H3.5a.5.5 0 0 0 .354-.146L11 7.707l1.146 1.147a.5.5 0 0 0 .708-.708l-.647-.646 3.147-3.146a1.207 1.207 0 0 0 0-1.708zM2 12.707l7-7L10.293 7l-7 7H2z"/>\n        </svg>\n      </button>':""}\n            </div>\n            ${window.EyeDropper?"":'<div class="eyedropper-not-supported">Conta-gotas não suportado neste navegador</div>'}\n            <br>\n          </div>\n          <div class="tab-content" data-value="gradient-fill">\n            <div id="gradient-picker"></div>\n\n            <div class="gradient-orientation-container">\n              <div class="input-container">\n                <label>Orientation</label>\n                <select id="select-orientation">\n                  <option value="linear">Linear</option>\n                  <option value="radial">Radial</option>\n                </select>\n              </div>\n              <div id="angle-input-container" class="input-container">\n                <label>Angle</label>\n                <div class="custom-number-input">\n                  <button class="decrease">-</button>\n                  <input type="number" min="0" max="360" value="0" id="input-angle">\n                  <button class="increase">+</button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `),$(`${this.containerSelector} .toolpanel#background-panel .content .tab-label`).click((function(){$(`${e.containerSelector} .toolpanel#background-panel .content .tab-label`).removeClass("active"),$(this).addClass("active");let t=$(this).data("value");if($(this).closest(".tab-container").find(".tab-content").hide(),$(this).closest(".tab-container").find(`.tab-content[data-value=${t}]`).show(),"color-fill"===t){let t=$(`${e.containerSelector} .toolpanel#background-panel .content #color-picker`).val();try{e.canvas.backgroundColor=t,e.canvas.renderAll()}catch(e){console.log("can't update background color")}}else i()})),$(`${this.containerSelector} .toolpanel#background-panel .content .tab-label[data-value=color-fill]`).click(),$(`${this.containerSelector} .toolpanel#background-panel .content #color-picker`).spectrum({showPalette:!0,showButtons:!1,type:"color",showInput:"true",allowEmpty:"false",move:function(t){let n="transparent";t&&(n=t.toHexString()),e.canvas.backgroundColor=n,e.canvas.renderAll()}}),t(this.containerSelector+" .toolpanel#background-panel .content","color-picker",(t=>{e.canvas.backgroundColor=t,e.canvas.renderAll()}));const n=new Grapick({el:`${this.containerSelector} .toolpanel#background-panel .content #gradient-picker`,colorEl:'<input id="colorpicker"/>'});n.setColorPicker((e=>{const t=e.getEl().querySelector("#colorpicker");$(t).spectrum({showPalette:!1,showButtons:!1,type:"color",showInput:"true",allowEmpty:"false",color:e.getColor(),showAlpha:!0,change(t){e.setColor(t.toRgbString())},move(t){e.setColor(t.toRgbString(),0)}})})),n.addHandler(0,"red"),n.addHandler(100,"blue");const i=()=>{let t=n.getHandlers(),i=$(`${this.containerSelector} .toolpanel#background-panel .content .gradient-orientation-container #select-orientation`).val(),a=parseInt($(`${this.containerSelector} .toolpanel#background-panel .content .gradient-orientation-container #input-angle`).val()),o=e.generateFabricGradientFromColorStops(t,e.canvas.width,e.canvas.height,i,a);e.canvas.setBackgroundColor(o),e.canvas.renderAll()};n.on("change",(e=>{i()})),$(`${this.containerSelector} .toolpanel#background-panel .content .gradient-orientation-container #select-orientation`).change((function(){"radial"===$(this).val()?$(this).closest(".gradient-orientation-container").find("#angle-input-container").hide():$(this).closest(".gradient-orientation-container").find("#angle-input-container").show(),i()})),$(`${this.containerSelector} .toolpanel#background-panel .content .gradient-orientation-container #input-angle`).change((function(){i()}))})()}}(),function(){"use strict";const e=[{value:{strokeDashArray:[],strokeLineCap:"butt"},label:"Stroke"},{value:{strokeDashArray:[1,10],strokeLineCap:"butt"},label:"Dash-1"},{value:{strokeDashArray:[1,10],strokeLineCap:"round"},label:"Dash-2"},{value:{strokeDashArray:[15,15],strokeLineCap:"square"},label:"Dash-3"},{value:{strokeDashArray:[15,15],strokeLineCap:"round"},label:"Dash-4"},{value:{strokeDashArray:[25,25],strokeLineCap:"square"},label:"Dash-5"},{value:{strokeDashArray:[25,25],strokeLineCap:"round"},label:"Dash-6"},{value:{strokeDashArray:[1,8,16,8,1,20],strokeLineCap:"square"},label:"Dash-7"},{value:{strokeDashArray:[1,8,16,8,1,20],strokeLineCap:"round"},label:"Dash-8"}];window.ImageEditor.prototype.initializeSelectionSettings=function(){const t=this;$(`${this.containerSelector} .main-panel`).append('<div class="toolpanel" id="select-panel"><div class="content"><p class="title">Selection Settings</p></div></div>');const n=(e,t)=>window.EyeDropper?`<button type="button" class="eyedropper-btn" data-target="${t}" title="Conta-gotas (selecionar cor da tela)">\n        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eyedropper" viewBox="0 0 16 16">\n          <path d="M13.354.646a1.207 1.207 0 0 0-1.708 0L8.5 3.793l-.646-.647a.5.5 0 1 0-.708.708L8.293 5l-7.147 7.146A.5.5 0 0 0 1 12.5v1.793l-.854.853a.5.5 0 1 0 .708.707L1.707 15H3.5a.5.5 0 0 0 .354-.146L11 7.707l1.146 1.147a.5.5 0 0 0 .708-.708l-.647-.646 3.147-3.146a1.207 1.207 0 0 0 0-1.708zM2 12.707l7-7L10.293 7l-7 7H2z"/>\n        </svg>\n      </button>`:"",i=(e,t,n)=>{if(window.EyeDropper)$(`${e} .eyedropper-btn[data-target="${t}"]`).click((async function(){try{$(this).addClass("active"),$("body").css("cursor","crosshair");const i=new EyeDropper,a=await i.open();a&&a.sRGBHex&&($(`${e} #${t}`).spectrum("set",a.sRGBHex),$(`${e} #${t}`).trigger("change"),n&&"function"==typeof n&&n(a.sRGBHex),console.log("Cor selecionada:",a.sRGBHex))}catch(e){"AbortError"!==e.name&&(console.error("Erro ao usar EyeDropper:",e),alert("Ocorreu um erro ao selecionar a cor. Tente novamente."))}finally{$(this).removeClass("active"),$("body").css("cursor","default")}}));else{console.warn("EyeDropper API não é suportada neste navegador");const t=$(`${e} .eyedropper-not-supported`);t.length&&t.show()}};(()=>{$(`${this.containerSelector} .toolpanel#select-panel .content`).append(`\n        <div class="text-section">\n          <h4>Font Style</h4>\n          <div class="style">\n            <button id="bold"><svg id="Capa_1" x="0px" y="0px" viewBox="-70 -70 450 450" xml:space="preserve"><path d="M218.133,144.853c20.587-14.4,35.2-37.653,35.2-59.52C253.333,37.227,216.107,0,168,0H34.667v298.667h150.187 c44.693,0,79.147-36.267,79.147-80.853C264,185.387,245.547,157.76,218.133,144.853z M98.667,53.333h64c17.707,0,32,14.293,32,32 s-14.293,32-32,32h-64V53.333z M173.333,245.333H98.667v-64h74.667c17.707,0,32,14.293,32,32S191.04,245.333,173.333,245.333z"></path></svg></button>\n            <button id="italic"><svg id="Capa_1" x="0px" y="0px" viewBox="-70 -70 450 450" xml:space="preserve"><polygon points="106.667,0 106.667,64 153.92,64 80.747,234.667 21.333,234.667 21.333,298.667 192,298.667 192,234.667 144.747,234.667 217.92,64 277.333,64 277.333,0  "></polygon></svg></button>\n            <button id="underline"><svg id="Capa_1" x="0px" y="0px" viewBox="-70 -70 450 450" xml:space="preserve"><path d="M192,298.667c70.72,0,128-57.28,128-128V0h-53.333v170.667c0,41.28-33.387,74.667-74.667,74.667 s-74.667-33.387-74.667-74.667V0H64v170.667C64,241.387,121.28,298.667,192,298.667z"></path><rect x="42.667" y="341.333" width="298.667" height="42.667"></rect></svg></button>\n            <button id="linethrough"><svg id="Capa_1" x="0px" y="0px" viewBox="-70 -70 450 450" xml:space="preserve"><polygon points="149.333,160 234.667,160 234.667,96 341.333,96 341.333,32 42.667,32 42.667,96 149.333,96"></polygon><rect x="149.333" y="288" width="85.333" height="64"></rect><rect x="0" y="202.667" width="384" height="42.667"></rect></svg></button>\n            <button id="subscript"><svg id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" xml:space="preserve"><path d="M248.257,256l103.986-103.758c2.777-2.771,4.337-6.532,4.337-10.455c0-3.923-1.561-7.684-4.337-10.455l-49.057-48.948 c-5.765-5.753-15.098-5.753-20.863,0L178.29,186.188L74.258,82.384c-5.764-5.751-15.098-5.752-20.863,0L4.337,131.333 C1.561,134.103,0,137.865,0,141.788c0,3.923,1.561,7.684,4.337,10.455L108.324,256L4.337,359.758 C1.561,362.528,0,366.29,0,370.212c0,3.923,1.561,7.684,4.337,10.455l49.057,48.948c5.765,5.753,15.098,5.753,20.863,0 l104.033-103.804l104.032,103.804c2.883,2.876,6.657,4.315,10.432,4.315s7.549-1.438,10.432-4.315l49.056-48.948 c2.777-2.771,4.337-6.532,4.337-10.455c0-3.923-1.561-7.684-4.337-10.455L248.257,256z"></path><path d="M497.231,384.331h-44.973l35.508-31.887c14.878-13.36,20.056-34.18,13.192-53.04 c-6.874-18.89-23.565-31.044-43.561-31.717c-0.639-0.021-1.283-0.032-1.928-0.032c-31.171,0-56.531,25.318-56.531,56.439 c0,8.157,6.613,14.769,14.769,14.769c8.156,0,14.769-6.613,14.769-14.769c0-14.833,12.109-26.901,26.992-26.901 c0.316,0,0.631,0.005,0.937,0.016c11.573,0.39,15.78,9.511,16.795,12.297c2.163,5.946,1.942,14.574-5.171,20.962l-64.19,57.643 c-4.552,4.088-6.112,10.56-3.923,16.273c2.189,5.714,7.673,9.486,13.792,9.486h83.523c8.157,0,14.769-6.613,14.769-14.769 S505.387,384.331,497.231,384.331z"></path></svg></button>\n            <button id="superscript"><svg id="Capa_1" x="0px" y="0px" viewBox="0 0 512 512" xml:space="preserve"><path d="M248.257,259.854l103.986-103.758c2.777-2.771,4.337-6.532,4.337-10.455c0-3.923-1.561-7.684-4.337-10.455l-49.057-48.948 c-5.765-5.753-15.098-5.753-20.863,0L178.29,190.042L74.258,86.238c-5.764-5.751-15.099-5.752-20.863,0L4.337,135.187 C1.561,137.958,0,141.719,0,145.642s1.561,7.684,4.337,10.455l103.986,103.758L4.337,363.612C1.561,366.383,0,370.145,0,374.067 c0,3.922,1.561,7.684,4.337,10.455l49.057,48.948c5.765,5.753,15.098,5.753,20.863,0l104.033-103.804l104.032,103.804 c2.883,2.876,6.657,4.315,10.432,4.315s7.549-1.438,10.432-4.315l49.056-48.948c2.777-2.771,4.337-6.532,4.337-10.455 s-1.561-7.684-4.337-10.455L248.257,259.854z"></path><path d="M497.231,190.893h-44.973l35.508-31.887c14.878-13.36,20.056-34.18,13.192-53.04 c-6.874-18.89-23.565-31.044-43.561-31.717c-0.639-0.021-1.283-0.032-1.928-0.032c-31.171,0-56.531,25.318-56.531,56.439 c0,8.157,6.613,14.769,14.769,14.769c8.156,0,14.769-6.613,14.769-14.769c0-14.833,12.109-26.901,26.992-26.901 c0.316,0,0.631,0.005,0.937,0.016c11.573,0.39,15.78,9.511,16.795,12.297c2.163,5.946,1.942,14.574-5.171,20.962l-64.19,57.643 c-4.552,4.088-6.112,10.56-3.923,16.273c2.189,5.714,7.673,9.486,13.792,9.486h83.523c8.157,0,14.769-6.613,14.769-14.769 S505.387,190.893,497.231,190.893z"></path></svg></button>\n          </div>\n          <div class="family">\n            <div class="input-container">\n            <label>Font Family</label>\n            <select id="font-family">\n              <option value=""></option>\n              ${this.fonts&&this.fonts.length>0?`\n                <optgroup label="Fontes Personalizadas">\n                  ${[...new Set(this.fonts.map((e=>e.name)))].map((e=>`<option value="'${e}', sans-serif">${e}</option>`)).join("")}\n                </optgroup>\n              `:""}\n              <optgroup label="Fontes do Sistema">\n                <option value="'Open Sans', sans-serif">Open Sans</option>                \n                <option value="'Oswald', sans-serif">Oswald</option>\n                <option value="'Playfair Display', serif">Playfair Display</option>\n                <option value="'Cormorant Garamond', serif">Cormorant Garamond</option>\n                <option value="Impact, Charcoal, sans-serif">Impact</option>\n                <option value="'Lucida Console', Monaco, monospace">Lucida Console</option>\n                <option value="'Comic Sans MS', 'Comic Sans', cursive, sans-serif">Comic Sans</option>\n                <option value="'Dancing Script', cursive">Dancing Script</option>\n                <option value="'Indie Flower', cursive">Indie Flower</option>\n                <option value="'Amatic SC', cursive">Amatic SC</option>\n                <option value="'Permanent Marker', cursive">Permanent Marker</option>\n              </optgroup>\n            </select>\n            </div>\n          </div>\n          <div class="sizes">\n            <div class="input-container"><label>Font Size</label>\n              <div class="custom-number-input">\n              <button class="decrease">-</button>\n              <input type="number" min="1" value="20" id="fontSize">\n              <button class="increase">+</button>\n              </div>\n            </div>\n            <div class="input-container"><label>Line Height</label>\n              <div class="custom-number-input">\n              <button class="decrease">-</button>\n              <input type="number" min="0" max="3" value="1" step="0.1" id="lineHeight">\n              <button class="increase">+</button>\n              </div>\n            </div>\n            <div class="input-container"><label>Letter Spacing</label>\n              <div class="custom-number-input">\n              <button class="decrease">-</button>\n              <input type="number" min="0" max="2000" step="100" value="0" id="charSpacing">\n              <button class="increase">+</button>\n              </div>\n            </div>\n            </p>\n          </div>\n          <div class="align">\n            <div class="input-container">\n            <label>Text Alignment</label>\n            <select id="text-align">\n              <option value="left">Left</option>\n              <option value="center">Center</option>\n              <option value="right">Right</option>\n              <option value="justify">Justify</option>\n            </select>\n            </div>\n          </div>\n          <div class="color">\n            <div class="input-container">\n            <label>Text Color</label>\n            <div class="color-picker-container">\n              <input id="color-picker" value="black">\n              ${n(0,"color-picker")}\n            </div>\n            ${window.EyeDropper?"":'<div class="eyedropper-not-supported">Conta-gotas não suportado neste navegador</div>'}\n            </div>\n          </div>\n          <hr>\n        </div>\n      `),$(`${this.containerSelector} .toolpanel#select-panel .style button`).click((function(){switch($(this).attr("id")){case"bold":t.setActiveFontStyle(t.activeSelection,"fontWeight","bold"===t.getActiveFontStyle(t.activeSelection,"fontWeight")?"":"bold");break;case"italic":t.setActiveFontStyle(t.activeSelection,"fontStyle","italic"===t.getActiveFontStyle(t.activeSelection,"fontStyle")?"":"italic");break;case"underline":t.setActiveFontStyle(t.activeSelection,"underline",!t.getActiveFontStyle(t.activeSelection,"underline"));break;case"linethrough":t.setActiveFontStyle(t.activeSelection,"linethrough",!t.getActiveFontStyle(t.activeSelection,"linethrough"));break;case"subscript":t.getActiveFontStyle(t.activeSelection,"deltaY")>0?(t.setActiveFontStyle(t.activeSelection,"fontSize",void 0),t.setActiveFontStyle(t.activeSelection,"deltaY",void 0)):(t.activeSelection.setSubscript(),t.canvas.renderAll());break;case"superscript":t.getActiveFontStyle(t.activeSelection,"deltaY")<0?(t.setActiveFontStyle(t.activeSelection,"fontSize",void 0),t.setActiveFontStyle(t.activeSelection,"deltaY",void 0)):(t.activeSelection.setSuperscript(),t.canvas.renderAll())}t.canvas.renderAll(),t.canvas.fire("object:modified")})),$(`${this.containerSelector} .toolpanel#select-panel .family #font-family`).change((function(){let e=$(this).val();t.setActiveFontStyle(t.activeSelection,"fontFamily",e),t.canvas.renderAll(),t.canvas.fire("object:modified")})),$(`${this.containerSelector} .toolpanel#select-panel .sizes input`).change((function(){let e=parseFloat($(this).val()),n=$(this).attr("id");t.setActiveFontStyle(t.activeSelection,n,e),t.canvas.renderAll(),t.canvas.fire("object:modified")})),$(`${this.containerSelector} .toolpanel#select-panel .align #text-align`).change((function(){let e=$(this).val();t.setActiveFontStyle(t.activeSelection,"textAlign",e),t.canvas.renderAll(),t.canvas.fire("object:modified")})),$(`${this.containerSelector} .toolpanel#select-panel .color #color-picker`).spectrum({type:"color",showInput:"true",allowEmpty:"false"}),i(this.containerSelector+" .toolpanel#select-panel .text-section","color-picker",(e=>{t.setActiveFontStyle(t.activeSelection,"fill",e),t.canvas.renderAll(),t.canvas.fire("object:modified")})),$(`${this.containerSelector} .toolpanel#select-panel .color #color-picker`).change((function(){let e=$(this).val();t.setActiveFontStyle(t.activeSelection,"fill",e),t.canvas.renderAll(),t.canvas.fire("object:modified")}))})(),(()=>{$(`${this.containerSelector} .toolpanel#select-panel .content`).append(`\n        <div class="fill-section">\n          <div class="tab-container">\n            <div class="input-container">\n              <label>\n                <h4>Fill</h4>\n              </label>\n              <label>\n                <div class="tabs">\n                  <div class="tab-label" data-value="color-fill">\n                    <button type="">Color</button>\n                  </div>\n                  <div class="tab-label" data-value="gradient-fill">\n                    <button type="">Gradient</button>\n                  </div>\n                </div>\n              </label>\n            </div>\n            <div class="tab-content" data-value="color-fill">\n              <div class="input-container">\n                <label>Color</label>\n                <div class="color-picker-container">\n                  <input id="color-picker" value="${t.activeSelection?t.activeSelection.fill:"#000000"}">\n                  ${n(0,"color-picker")}\n                </div>\n                ${window.EyeDropper?"":'<div class="eyedropper-not-supported">Conta-gotas não suportado neste navegador</div>'}\n              </div>\n            </div>\n            <div class="tab-content" data-value="gradient-fill">\n              <div id="gradient-picker"></div>\n              <div class="gradient-orientation-container">\n                <div class="input-container">\n                  <label>Orientation</label>\n                  <select id="select-orientation">\n                    <option value="linear">Linear</option>\n                    <option value="radial">Radial</option>\n                  </select>\n                </div>\n                <div id="angle-input-container" class="input-container">\n                  <label>Angle</label>\n                  <div class="custom-number-input">\n                    <button class="decrease">-</button>\n                    <input type="number" min="0" max="360" value="0" id="input-angle">\n                    <button class="increase">+</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <hr>\n        </div>\n      `),$(`${this.containerSelector} .toolpanel#select-panel .content .tab-label`).click((function(){$(`${t.containerSelector} .toolpanel#select-panel .content .tab-label`).removeClass("active"),$(this).addClass("active");let e=$(this).data("value");if($(this).closest(".tab-container").find(".tab-content").hide(),$(this).closest(".tab-container").find(`.tab-content[data-value=${e}]`).show(),"color-fill"===e){let e=$(`${t.containerSelector} .toolpanel#select-panel .fill-section #color-picker`).val();try{t.canvas.getActiveObjects().forEach((t=>t.set("fill",e))),t.canvas.renderAll(),t.canvas.fire("object:modified")}catch(e){console.log("can't update background color")}}else a()})),$(`${t.containerSelector} .toolpanel#select-panel .content .tab-label[data-value=color-fill]`).click(),$(`${this.containerSelector} .toolpanel#select-panel .fill-section #color-picker`).spectrum({showButtons:!1,type:"color",showInput:"true",allowEmpty:"false",move:function(e){let n="transparent";e&&(n=e.toRgbString()),t.canvas.getActiveObjects().forEach((e=>e.set("fill",n))),t.canvas.renderAll(),t.canvas.fire("object:modified")}}),i(this.containerSelector+" .toolpanel#select-panel .fill-section","color-picker",(e=>{t.canvas.getActiveObjects().forEach((t=>t.set("fill",e))),t.canvas.renderAll(),t.canvas.fire("object:modified")}));const e=new Grapick({el:`${this.containerSelector} .toolpanel#select-panel .fill-section #gradient-picker`,colorEl:'<input id="colorpicker"/>'});e.setColorPicker((e=>{const t=e.getEl().querySelector("#colorpicker");$(t).spectrum({showPalette:!0,showButtons:!1,type:"color",color:e.getColor(),showAlpha:!0,change(t){e.setColor(t.toRgbString())},move(t){e.setColor(t.toRgbString(),0)}})})),e.addHandler(0,"red"),e.addHandler(100,"blue");const a=()=>{let n=e.getHandlers(),i=$(`${this.containerSelector} .toolpanel#select-panel .content .gradient-orientation-container #select-orientation`).val(),a=parseInt($(`${this.containerSelector} .toolpanel#select-panel .content .gradient-orientation-container #input-angle`).val()),o=t.generateFabricGradientFromColorStops(n,t.activeSelection.width,t.activeSelection.height,i,a);t.activeSelection.set("fill",o),t.canvas.renderAll()};e.on("change",(e=>{a()})),$(`${this.containerSelector} .toolpanel#select-panel .content .gradient-orientation-container #select-orientation`).change((function(){let e=$(this).val();console.log("orientation",e),"radial"===e?$(this).closest(".gradient-orientation-container").find("#angle-input-container").hide():$(this).closest(".gradient-orientation-container").find("#angle-input-container").show(),a()})),$(`${this.containerSelector} .toolpanel#select-panel .content .gradient-orientation-container #input-angle`).change((function(){a()}))})(),(()=>{$(`${this.containerSelector} .toolpanel#select-panel .content`).append(`\n        <div class="border-section">\n          <h4>Border</h4>\n          <div class="input-container"><label>Width</label>\n            <div class="custom-number-input">\n            <button class="decrease">-</button>\n            <input type="number" min="0" value="0" id="input-border-width">\n            <button class="increase">+</button>\n            </div>\n          </div>\n          <div class="input-container"><label>Style</label><select id="input-border-style">${e.map((e=>`<option value='${JSON.stringify(e.value)}'>${e.label}</option>`))}</select></div>\n          <div class="input-container"><label>Corner Type</label><select id="input-corner-type"><option value="miter" selected>Square</option><option value="round">Round</option><option value="circle">Circle</option></select></div>\n          <div class="input-container">\n            <label>Color</label>\n            <div class="color-picker-container">\n              <input id="color-picker" value="black">\n              ${n(0,"color-picker")}\n            </div>\n            ${window.EyeDropper?"":'<div class="eyedropper-not-supported">Conta-gotas não suportado neste navegador</div>'}\n          </div>\n          <hr>\n        </div>\n      `),$(`${this.containerSelector} .toolpanel#select-panel .border-section #color-picker`).spectrum({showButtons:!1,type:"color",showInput:"true",allowEmpty:"false",move:function(e){let n="transparent";e&&(n=e.toRgbString()),t.canvas.getActiveObjects().forEach((e=>e.set("stroke",n))),t.canvas.renderAll(),t.canvas.fire("object:modified")}}),i(this.containerSelector+" .toolpanel#select-panel .border-section","color-picker",(e=>{t.canvas.getActiveObjects().forEach((t=>t.set("stroke",e))),t.canvas.renderAll(),t.canvas.fire("object:modified")})),$(`${this.containerSelector} .toolpanel#select-panel .border-section #input-border-width`).change((function(){let e=parseInt($(this).val());t.canvas.getActiveObjects().forEach((t=>t.set({strokeUniform:!0,strokeWidth:e}))),t.canvas.renderAll(),t.canvas.fire("object:modified")})),$(`${this.containerSelector} .toolpanel#select-panel .border-section #input-border-style`).change((function(){try{let e=JSON.parse($(this).val());t.canvas.getActiveObjects().forEach((t=>t.set({strokeUniform:!0,strokeDashArray:e.strokeDashArray,strokeLineCap:e.strokeLineCap}))),t.canvas.renderAll(),t.canvas.fire("object:modified")}catch(e){}})),$(`${this.containerSelector} .toolpanel#select-panel .border-section #input-corner-type`).change((function(){let e=$(this).val();t.canvas.getActiveObjects().forEach((t=>t.set("strokeLineJoin",e))),t.canvas.renderAll(),t.canvas.fire("object:modified")}))})(),(()=>{$(`${this.containerSelector} .toolpanel#select-panel .content`).append('\n        <div class="effect-section">\n          <h4>Effect</h4>\n          <div class="input-container"><label>Opacity</label><input id="opacity" type="range" min="0" max="1" value="1" step="0.01"></div>\n          <div class="input-container"><label>Blur</label><input class="effect" id="blur" type="range" min="0" max="100" value="50"></div>\n          <div class="input-container"><label>Brightness</label><input class="effect" id="brightness" type="range" min="0" max="100" value="50"></div>\n          <div class="input-container"><label>Saturation</label><input class="effect" id="saturation" type="range" min="0" max="100" value="50"></div>\n          <h5>Gamma</h5>\n          <div class="input-container"><label>Red</label><input class="effect" id="gamma.r" type="range" min="0" max="100" value="50"></div>\n          <div class="input-container"><label>Green</label><input class="effect" id="gamma.g" type="range" min="0" max="100" value="50"></div>\n          <div class="input-container"><label>Blue</label><input class="effect" id="gamma.b" type="range" min="0" max="100" value="50"></div>\n          <hr>\n        </div>\n      '),$(`${this.containerSelector} .toolpanel#select-panel .effect-section #opacity`).change((function(){let e=parseFloat($(this).val());t.activeSelection.set("opacity",e),t.canvas.renderAll(),t.canvas.fire("object:modified")})),$(`${this.containerSelector} .toolpanel#select-panel .effect-section .effect`).change((function(){let e=$(this).attr("id"),n=parseFloat($(this).val()),i=t.getCurrentEffect(t.activeSelection);t.activeSelection.filters=t.getUpdatedFilter(i,e,n),t.activeSelection.applyFilters(),t.canvas.renderAll(),t.canvas.fire("object:modified")}))})(),this.setSelectionValues=()=>{const e=this;if(1==e.canvas.getActiveObjects().length){let t=e.activeSelection;if(t){const{strokeWidth:n,stroke:i,strokeLineCap:a,cornerStyle:o,fill:s,fontFamily:l,fontSize:r,lineHeight:c,charSpacing:d,textAlign:h,type:p,animation:u}=t,v=(t,n)=>{null!=n&&$(`${e.containerSelector} .toolpanel#select-panel ${t}`).val(n).trigger("change")};v(".fill-section #color-picker",s),v(".border-section #color-picker",i),v(".border-section #input-border-width",n),null!=a&&v(".border-section #input-border-style",JSON.stringify({strokeDashArray:t.strokeDashArray??[],strokeLineCap:a})),v(".border-section #input-corner-type",o),"textbox"!==p&&"i-text"!==p||(v(".text-section #font-family",l),v(".text-section #fontSize",r),v(".text-section #lineHeight",c),v(".text-section #charSpacing",d),v(".text-section #text-align",h),v(".text-section #color-picker",s)),u&&v(".animate-section #animate-type",u.type)}}}}}(),function(){"use strict";let e;window.ImageEditor.prototype.initializeShortcuts=function(){const t=this;function n(t){return Object.values(e).find((e=>e.name===t))}function i(){document.querySelectorAll(".menu .item[data-action]").forEach((e=>{const t=n(e.getAttribute("data-action"));if(t){const n=e.querySelector(".shortcutkey");n&&(n.textContent=t.shortcut)}}))}e=t.getAllActions(),document.addEventListener("keydown",(async n=>{const i=n.key.toUpperCase(),a=n.ctrlKey,o=n.altKey,s=n.shiftKey;let l=i;"ª"===i?l="[":"º"===i&&(l="]");let r=[];a&&r.push("Ctrl"),o&&r.push("Alt"),s&&r.push("Shift"),r.push(l);const c=r.join("+"),d=Object.values(e).find((e=>e.shortcut===c&&e.enabled));if(d)return n.preventDefault(),void t.executeAction(d.name)})),i(),this.getShortcutByAction=n,this.updateMenuShortcuts=i}}(),function(){"use strict";let e=null;const t={copy:{name:"copy",icon:"uil-copy",label:"Copiar",shortcut:"Ctrl+C",enabled:!0,handler:async t=>{e=null;const n=t.getActiveObject();if(n&&("i-text"===n.type||"textbox"===n.type)){const e=n.getSelectedText();if(e)return void await navigator.clipboard.writeText(e)}n?n.clone((n=>{e=n,t.fire("copy",{id:n.id,type:n.type})}),["id"]):t.fire("copy:failed",{message:"Nenhum objeto selecionado"})}},paste:{name:"paste",icon:"uil-clipboard",label:"Colar",shortcut:"Ctrl+V",enabled:!0,handler:async t=>{console.log("copiedObject",e),e?e.clone((e=>{t.discardActiveObject(),e.set({left:e.left+20,top:e.top+20,id:`${e.id}_copia_${Date.now()}`}),t.add(e),t.setActiveObject(e),t.renderAll(),t.fire("paste",{id:e.id,type:e.type})}),["id"]):t.fire("paste:failed",{message:"Nenhum objeto copiado"})}},duplicate:{name:"duplicate",icon:"uil-minus-path",label:"Duplicar",shortcut:"Ctrl+D",enabled:!0,handler:function(e){const t=e.getActiveObjects();if(t.locked)return void alert("Objeto bloqueado");const n=[];if(t.forEach((i=>{i.clone((a=>{e.add(a.set({strokeUniform:!0,left:i.aCoords.tl.x+20,top:i.aCoords.tl.y+20})),1===t.length&&e.setActiveObject(a),n.push(a)}))})),n.length>1){let t=new fabric.ActiveSelection(n,{canvas:e});e.setActiveObject(t)}e.requestRenderAll(),e.fire("object:modified")}},delete:{name:"delete",icon:"uil-trash-alt",label:"Excluir",shortcut:"DELETE",enabled:!0,handler:function(e){const t=e.getActiveObject();t&&(e.remove(t),e.requestRenderAll(),e.fire("object:modified"))}},group:{name:"group",icon:"uil-object-group",label:"Agrupar",shortcut:"Ctrl+G",enabled:!0,handler:function(e){const t=e.getActiveObject();t&&"activeSelection"===t.type&&t.getObjects().length>1&&(t.toGroup(),e.requestRenderAll(),e.fire("object:modified"),e.fire("group:added"))}},ungroup:{name:"ungroup",icon:"uil-object-ungroup",label:"Desagrupar",shortcut:"Ctrl+Shift+G",enabled:!0,handler:function(e){const t=e.getActiveObject();t&&"group"===t.type&&(t.toActiveSelection(),e.requestRenderAll(),e.fire("object:modified"),e.fire("group:removed"))}},moveForward:{name:"move-forward",icon:"uil-top-arrow-to-top",label:"Mover para frente",shortcut:"Ctrl+]",enabled:!0,handler:function(e){const t=e.getActiveObject();t&&(t.bringForward(),e.requestRenderAll(),e.fire("object:modified"))}},moveFullForward:{name:"move-full-forward",icon:"uil-top-arrow-to-top",label:"Trazer para frente",shortcut:"Ctrl+Alt+]",enabled:!0,handler:function(e){const t=e.getActiveObject();t&&(t.bringToFront(),e.requestRenderAll(),e.fire("object:modified"))}},moveBackward:{name:"move-backward",icon:"uil-arrow-to-bottom",label:"Mover para trás",shortcut:"Ctrl+[",enabled:!0,handler:function(e){const t=e.getActiveObject();t&&(t.sendBackwards(),e.requestRenderAll(),e.fire("object:modified"))}},moveFullBackward:{name:"move-full-backward",icon:"uil-arrow-to-bottom",label:"Enviar para trás",shortcut:"Ctrl+Alt+[",enabled:!0,handler:function(e){const t=e.getActiveObject();t&&(t.sendToBack(),e.requestRenderAll(),e.fire("object:modified"))}},showLayers:{name:"show-layers",icon:"uil-layers",label:"Mostrar camadas",shortcut:"Alt+1",enabled:!1,handler:function(e){document.querySelector(".image-editor-layers").style.display="block"}},comment:{name:"comment",icon:"uil-comment-plus",label:"Comentar",shortcut:"Ctrl+Alt+N",enabled:!1,handler:function(e){alert("coming soon")}},addLink:{name:"add-link",icon:"uil-link",label:"Adicionar link",shortcut:"Ctrl+K",enabled:!1,handler:function(e){alert("coming soon")}},flipHorizontal:{name:"flip-horizontal",icon:"uil-flip-h",label:"Inverter horizontalmente",shortcut:"Ctrl+H",enabled:!0,handler:function(e){const t=e.getActiveObject();t&&(t.set("flipX",!t.flipX),e.requestRenderAll(),e.fire("object:modified"))}},flipVertical:{name:"flip-vertical",icon:"uil-flip-v",label:"Inverter verticalmente",shortcut:"Ctrl+V",enabled:!0,handler:function(e){const t=e.getActiveObject();t&&(t.set("flipY",!t.flipY),e.requestRenderAll(),e.fire("object:modified"))}},lock:{name:"lock",icon:"uil-lock-open-alt",label:"Bloquear",shortcut:!1,enabled:!0,handler:function(e){const t=e.getActiveObject();t&&(t.lockMovementX=!0,t.lockMovementY=!0,t.lockScalingX=!0,t.lockScalingY=!0,t.lockRotation=!0,t.lockUniScaling=!0,t.lockSkewingX=!0,t.lockSkewingY=!0,t.hasControls=!0,t.hasRotatingPoint=!0,t.locked=!0,e.requestRenderAll(),e.fire("object:modified"),e.setActiveObject(t))}},unlock:{name:"unlock",icon:"uil-lock-alt",label:"Desbloquear",shortcut:!1,enabled:!0,handler:function(e){const t=e.getActiveObject();t&&(t.lockMovementX=!1,t.lockMovementY=!1,t.lockScalingX=!1,t.lockScalingY=!1,t.lockRotation=!1,t.evented=!0,t.locked=!1,e.requestRenderAll(),e.fire("object:modified"))}},showDuration:{name:"show-duration",icon:"uil-clock",label:"Show duration",shortcut:!1,enabled:!1,handler:function(e){alert("coming soon")}},addLink:{name:"add-link",icon:"uil-link",label:"Add link",shortcut:"Ctrl+K",enabled:!1,handler:function(e){alert("coming soon")}},removeLink:{name:"remove-link",icon:"uil-link-broken",label:"Remove link",shortcut:"Ctrl+Shift+K",enabled:!1,handler:function(e){alert("coming soon")}},editLink:{name:"edit-link",icon:"uil-link",label:"Edit link",shortcut:"Ctrl+K",enabled:!1,handler:function(e){alert("coming soon")}}};window.ImageEditor.prototype.initializeCanvasActions=function(){const e=this.canvas;let n=null;this.executeAction=function(i){const a=t[i];a&&a.handler&&(a.handler(e),n&&n())},this.getAction=function(e){return t[e]},this.getAllActions=function(){return t},this.registerMenuUpdateFunction=function(e){n=e}}}(),function(){"use strict";const e='\n      <div class="actions">\n        <div class="actions-item" data-action="group" title="Group">\n          <span>Group</span>\n        </div>\n        <div class="actions-item" data-action="ungroup" title="Ungroup">\n          <span>Ungroup</span>\n        </div>\n        <div class="actions-item" data-action="comment" title="Comment">\n          <i class="uil uil-comment-plus"></i>\n        </div>\n        <div class="actions-item" data-action="lock" title="Lock">\n          <i class="uil uil-lock-open-alt"></i>\n        </div>\n        <div class="actions-item" data-action="unlock" title="Unlock">\n          <i class="uil uil-lock-alt"></i>\n        </div>        \n        <div class="actions-item" data-action="duplicate" title="Duplicate">\n          <i class="uil uil-minus-path"></i>\n        </div>\n        <div class="actions-item" data-action="delete" title="Delete">\n          <i class="uil uil-trash-alt"></i>\n        </div>\n        <div class="actions-item" id="action-menu" title="Actions">\n          <i class="uil uil-ellipsis-h"></i>\n        </div>\n      </div>\n    ',t='\n      <div class="menu-wrapper" style="visibility: hidden;">\n        <div class="content">\n          <ul class="menu">\n            <li class="item" data-action="copy">\n              <i class="uil uil-copy"></i>\n              <span>Copy</span>\n              <span class="shortcutkey">Ctrl+C</span>\n            </li>\n            <li class="item" data-action="paste">\n              <i class="uil uil-clipboard"></i>\n              <span>Paste</span>\n              <span class="shortcutkey">Ctrl+V</span>\n            </li>\n            <li class="item" data-action="duplicate">\n              <i class="uil uil-minus-path"></i>\n              <span>Duplicate</span>\n              <span class="shortcutkey">Ctrl+D</span>\n            </li>\n            <li class="item" data-action="delete">\n              <i class="uil uil-trash-alt"></i>\n              <span>Delete</span>\n              <span class="shortcutkey">DELETE</span>\n            </li>\n\n            <div class="divisor"></div>\n            <li class="item sub-nivel">\n              <div>\n                <i class="uil uil-layers"></i>\n                <span>Layers</span>\n              </div>\n              <i class="uil uil-angle-right"></i>\n              <ul class="sub-nivel-menu">\n                <li class="item" data-action="moveForward">\n                  <i class="uil uil-top-arrow-to-top"></i>\n                  <span>Forward</span>\n                  <span class="shortcutkey">Ctrl+]</span>\n                </li>\n                <li class="item" data-action="moveFullForward">\n                  <i class="uil uil-top-arrow-to-top"></i>\n                  <span>Bring to Front</span>\n                  <span class="shortcutkey">Ctrl+]</span>\n                </li>\n                <li class="item" data-action="moveBackward">\n                  <i class="uil uil-arrow-to-bottom"></i>\n                  <span>Backward</span>\n                  <span class="shortcutkey">Ctrl+Alt+[</span>\n                </li>\n                <li class="item" data-action="moveFullBackward">\n                  <i class="uil uil-arrow-to-bottom"></i>\n                  <span>Send Backward</span>\n                  <span class="shortcutkey">Ctrl+Alt[</span>\n                </li>\n                <div class="divisor"></div>\n                <li class="item" data-action="showLayers">\n                  <i class="uil uil-layers"></i>\n                  <span>Show Layers</span>\n                  <span class="shortcutkey">Alt+1</span>\n                </li>\n              </ul>\n            </li>\n            <li class="item sub-nivel">\n              <div>\n                <i class="uil uil-horizontal-align-left"></i>\n                <span>Align to Page</span>\n              </div>\n              <i class="uil uil-angle-right"></i>\n              <ul class="sub-nivel-menu">\n                <li class="item" data-action="alignLeft">\n                  <i class="uil uil-horizontal-align-left"></i>\n                  <span>Align Left</span>\n                </li>\n                <li class="item" data-action="alignCenter">\n                  <i class="uil uil-horizontal-align-center"></i>\n                  <span>Align Center</span>\n                </li>\n                <li class="item" data-action="alignRight">\n                  <i class="uil uil-horizontal-align-right"></i>\n                  <span>Align Right</span>\n                </li>\n                <div class="divisor"></div>\n\n                <li class="item" data-action="alignTop">\n                  <i class="uil uil-vertical-align-top"></i>\n                  <span>Align Top</span>\n                </li>\n                <li class="item" data-action="alignCenterVertical">\n                  <i class="uil uil-vertical-align-center"></i>\n                  <span>Align Center</span>\n                </li>\n                <li class="item" data-action="alignBottom">\n                  <i class="uil uil-vertical-align-bottom"></i>\n                  <span>Align Bottom</span>\n                </li>\n              </ul>\n            </li>\n            <li class="item sub-nivel">\n              <div>\n                <i class="uil uil-flip-v-alt"></i>\n                <span>Flip</span>\n              </div>\n              <i class="uil uil-angle-right"></i>\n              <ul class="sub-nivel-menu">\n                <li class="item" data-action="flipHorizontal">\n                  <i class="uil uil-flip-h"></i>\n                  <span>Flip Horizontal</span>\n                </li>\n                <li class="item" data-action="flipVertical">\n                  <i class="uil uil-flip-v"></i>\n                  <span>Flip Vertical</span>\n                </li>                \n              </ul>\n            </li>\n            <div class="divisor"></div>\n            <li class="item" data-action="group">\n              <i class="uil uil-object-group"></i>\n              <span>Group</span>\n              <span class="shortcutkey">Ctrl+G</span>\n            </li>\n            <li class="item" data-action="ungroup">\n              <i class="uil uil-object-ungroup"></i>\n              <span>Ungroup</span>\n              <span class="shortcutkey">Ctrl+Shift+G</span>\n            </li>\n            <li class="item" data-action="lock">\n              <i class="uil uil-lock-open-alt"></i>\n              <span>Lock</span>\n            </li>\n            <li class="item" data-action="unlock">\n              <i class="uil uil-lock-alt"></i>\n              <span>Unlock</span>\n            </li>\n            <li class="item" data-action="showDuration">\n              <i class="uil uil-clock"></i>\n              <span>Show Duration</span>\n            </li>\n            <li class="item" data-action="comment">\n              <i class="uil uil-comment-plus"></i>\n              <span>Comment</span>\n              <span class="shortcutkey">Ctrl+Alt+N</span>\n            </li>\n            <li class="item" data-action="addLink">\n              <i class="uil uil-link-add"></i>\n              <span>Add Link</span>\n              <span class="shortcutkey">Ctrl+K</span>\n            </li>\n            <li class="item" data-action="removeLink">\n              <i class="uil uil-link-broken"></i>\n              <span>Remove Link</span>\n              <span class="shortcutkey">Ctrl+Shift+K</span>\n            </li>\n            <li class="item" data-action="editLink">\n              <i class="uil uil-link"></i>\n              <span>Edit Link</span>\n              <span class="shortcutkey">Ctrl+K</span>\n            </li>\n          </ul>\n        </div>\n      </div>\n    ';window.ImageEditor.prototype.initializeCanvasActionsMenu=function(){const n=this,i=this.canvas;this.containerEl[0];let a=document.querySelector("#obj-menu"),o=document.querySelector(".canvas-container"),s=null;this.initializeCanvasActions(),this.registerMenuUpdateFunction(v),a||(a=document.createElement("div"),a.id="obj-menu",a.innerHTML=e,o.appendChild(a));const l=document.createElement("div");l.innerHTML=t,document.body.appendChild(l);const r=document.querySelector("#obj-menu"),c=document.querySelector(".menu-wrapper"),d=document.querySelectorAll(".sub-nivel"),h=document.querySelector("#action-menu");function p(){const e=document.querySelectorAll("[data-action]");if(!s)return r.style.display="none",e.forEach((e=>{"paste"===e.getAttribute("data-action")||"comment"===e.getAttribute("data-action")?e.style.display="":e.style.display="none"})),void u();r.style.display="block",h.style.display="block",s.locked&&(h.style.display="none"),e.forEach((e=>{const t=e.getAttribute("data-action");if(s.locked&&"unlock"!==t)e.style.display="none";else switch(t){case"group":e.style.display=!s.isType("group")&&i.getActiveObjects().length>1?"":"none";break;case"ungroup":e.style.display=s.isType("group")?"":"none";break;case"lock":case"delete":e.style.display=s.locked?"none":"";break;case"unlock":e.style.display=s.locked?"":"none";break;case"moveForward":case"moveFullForward":case"moveBackward":case"moveFullBackward":const t=!s.isType("group")||s.isType("group")&&!s.locked;e.style.display=t?"":"none";break;case"addLink":e.style.display=s.link?"none":"";break;case"removeLink":case"editLink":e.style.display=s.link?"":"none";break;case"showDuration":case"comment":case"addLink":case"removeLink":case"editLink":e.style.display="function"==typeof s.getObjects&&s.getObjects().length>1&&!s.isType("group")?"none":"";break;default:e.style.display=""}})),u()}function u(){const e=document.querySelectorAll(".sub-nivel"),t=document.querySelectorAll(".divisor");let n=!0;e.forEach((e=>{const t=e.querySelectorAll(".sub-nivel-menu .item");let i=!0;t.forEach((e=>{"none"!==e.style.display&&(i=!1)})),i?e.style.display="none":(e.style.display="",n=!1)})),n?t.forEach((e=>{e.style.display="none"})):t.forEach((e=>{e.style.display=""}))}function v(){if(!s)return;if(s.metadata&&(s.metadata.isMargin||s.metadata.isGuide))return void(s=null);const e=i.getActiveObject();e&&"activeSelection"===e.type&&e.getObjects().length>1&&(s=e),p();const t=s.getBoundingRect(),n=i.getZoom();i._offset;let o=s.left*n,l=s.top*n;"left"===s.originX&&"top"===s.originY?(o=o+t.width/2-a.offsetWidth/2,l=l-a.offsetHeight-10):(o-=a.offsetWidth/2,l=l-t.height/2-a.offsetHeight-10),a.style.left=`${o}px`,a.style.top=`${l}px`,a.style.display="block"}function g(e){if(e.preventDefault(),"contextmenu"===e.type&&(r.style.display="none",i.discardActiveObject(),i.renderAll(),s=null),"contextmenu"===e.type){i.getPointer(e);const t=i.findTarget(e,!1);t&&(i.setActiveObject(t),i.renderAll(),s=t)}if(p(),d.forEach((e=>e.classList.remove("active"))),e.target.closest("#action-menu")&&"visible"===c.style.visibility)return void(c.style.visibility="hidden");c.querySelector(".content");const{clientX:t,clientY:n}=e,a=window.innerWidth,o=window.innerHeight,l=c.offsetWidth,h=c.offsetHeight;let u=t>a-l?a-l-5:t,v=n>o-h?o-h-5:n;c.style.left=`${u}px`,c.style.top=`${v}px`,c.style.visibility="visible",c.querySelectorAll(".sub-nivel-menu").forEach((e=>{const n=e.getBoundingClientRect();e.style.transform=t>a-l-n.width?`translateX(-${l+15}px)`:`translateX(${l-5}px)`,n.top+n.height>o?e.style.top=`-${n.height-(o-n.top)+5}px`:e.style.top="0"}))}i.on("layer:locked",(e=>{console.log("layer:locked",e),v()})),i.on("selection:created",(e=>{s=e.selected[0],v()})),i.on("selection:updated",(e=>{s=e.selected[0],v()})),i.on("selection:cleared",(()=>{s=null,a.style.display="none"})),i.on("object:scaling",(()=>{s&&(r.style.display="none")})),i.on("object:modified",(e=>{s&&"activeSelection"===s.type&&(s=i.getActiveObject(),v()),!s||"rotate"!==e.action&&"scale"!==e.action&&"drag"!==e.action||(r.style.display="",v())})),i.on("object:moving",(()=>{s&&(r.style.display="none")})),i.on("object:rotating",(()=>{s&&(r.style.display="none")})),i.on("group:added",(e=>{console.log("group:added",s),s=i.getActiveObject(),s&&v()})),i.on("group:removed",(e=>{console.log("group:removed",e),s=i.getActiveObject(),s&&v()})),o.addEventListener("contextmenu",g),r.addEventListener("click",g),document.querySelectorAll("[data-action]").forEach((e=>{e.addEventListener("click",(e=>{const t=e.target.closest("[data-action]").getAttribute("data-action");n.executeAction(t),c.style.visibility="hidden"}))})),document.addEventListener("click",(e=>{e.target.closest("#action-menu")||e.target.closest(".sub-nivel")||(c.style.visibility="hidden"),e.target.closest(".sub-nivel.active")||document.querySelectorAll(".sub-nivel").forEach((e=>e.classList.remove("active"))),e.target.closest(".sub-nivel")&&e.target.closest(".sub-nivel").classList.toggle("active")})),o.querySelector("#obj-menu").addEventListener("contextmenu",(e=>{e.preventDefault(),e.stopPropagation()})),o.querySelectorAll("#obj-menu *").forEach((e=>{e.addEventListener("contextmenu",(e=>{e.preventDefault(),e.stopPropagation()}))})),this.initializeShortcuts()}}(),window.ImageEditor.prototype.initializeLineDrawing=function(e){let t,n,i,a=!1;e.on("mouse:down",(o=>{e.isDrawingLineMode&&(a=!0,n=e.getPointer(o.e),i=[n.x,n.y,n.x,n.y],t=new fabric.Line(i,{strokeWidth:2,stroke:"#000000"}),t.selectable=!1,t.evented=!1,t.strokeUniform=!0,e.add(t))})),e.on("mouse:move",(o=>{if(a){if(n=e.getPointer(o.e),o.e.shiftKey){let e=i[0],a=i[1],o=n.x-e,s=n.y-a,l=Math.sqrt(o*o+s*s),r=Math.atan2(s,o)/Math.PI*180;r=15*parseInt((r+7.5)%360/15);let c=l*Math.cos(r*Math.PI/180),d=l*Math.sin(r*Math.PI/180);t.set({x2:c+e,y2:d+a})}else t.set({x2:n.x,y2:n.y});e.renderAll()}})),e.on("mouse:up",(()=>{a&&(t.setCoords(),a=!1,e.fire("object:modified"))}))},function(){const e=(e,t,n,i,a)=>Math.abs(t-i)<=e&&Math.abs(n-a)<=e;window.ImageEditor.prototype.initializePathDrawing=t=>{let n,i,a,o,s,l=!1,r=!1,c=!1;t.on("mouse:down",(e=>{if(t.isDrawingPathMode){if(r=!0,l=!0,i=t.getPointer(e.e),!n)return n=new fabric.Path(`M${i.x} ${i.y} L${i.x} ${i.y}`,{strokeWidth:2,stroke:"#000000",fill:!1}),n.selectable=!1,n.evented=!1,n.strokeUniform=!0,void t.add(n);if(n){n.path.push(["L",i.x,i.y]);let e=n._calcDimensions();return n.set({width:e.width,height:e.height,left:e.left,top:e.top,pathOffset:{x:e.width/2+e.left,y:e.height/2+e.top},dirty:!0}),n.setCoords(),void t.renderAll()}}})),t.on("mouse:move",(d=>{if(!t.isDrawingPathMode)return;if(!l)return;if(i=t.getPointer(d.e),c||(a=["L",i.x,i.y]),n.path.pop(),d.e.shiftKey&&!c){let e=[...n.path].pop(),t=e[1],o=e[2],s=i.x-t,l=i.y-o,r=Math.sqrt(s*s+l*l),c=Math.atan2(l,s)/Math.PI*180;c=15*parseInt((c+7.5)%360/15);let d=r*Math.cos(c*Math.PI/180),h=r*Math.sin(c*Math.PI/180);a[1]=d+t,a[2]=h+o}if(n.path.length>1&&!c){let t=[...n.path];t.pop();for(let n of t){if(("L"===n[0]||"M"===n[0])&&e(10,i.x,i.y,n[1],n[2])){a[1]=n[1],a[2]=n[2];break}if("Q"===n[0]&&e(10,i.x,i.y,n[3],n[4])){a[1]=n[3],a[2]=n[4];break}}}if(r)if(!c&&n.path.length>1){c=!0;let e=n.path.pop();"Q"===e[0]?(a=["Q",e[3],e[4],e[3],e[4]],o=e[3],s=e[4]):(a=["Q",e[1],e[2],e[1],e[2]],o=e[1],s=e[2])}else if(c){let e=i.x-a[3],t=i.y-a[4];a=["Q",o-e,s-t,o,s]}n.path.push(a);let h=n._calcDimensions();n.set({width:h.width,height:h.height,left:h.left,top:h.top,pathOffset:{x:h.width/2+h.left,y:h.height/2+h.top},dirty:!0}),t.renderAll()})),t.on("mouse:up",(e=>{if(!t.isDrawingPathMode)return r=!1,void(c=!1);if(r=!1,c){i=t.getPointer(e.e),n.path.push(["L",i.x,i.y]);let a=n._calcDimensions();n.set({width:a.width,height:a.height,left:a.left,top:a.top,pathOffset:{x:a.width/2+a.left,y:a.height/2+a.top},dirty:!0}),n.setCoords(),t.renderAll()}c=!1}));const d=()=>{if(n.path.pop(),n.path.length>1){let e=n._calcDimensions();n.set({width:e.width,height:e.height,left:e.left,top:e.top,pathOffset:{x:e.width/2+e.left,y:e.height/2+e.top},dirty:!0})}else t.remove(n);t.renderAll(),t.fire("object:modified"),n=null,l=!1};document.addEventListener("keydown",(e=>{l&&27===(e.which||e.keyCode)&&d()})),document.addEventListener("mousedown",(e=>{l&&(document.querySelector(".canvas-container").contains(e.target)||d())}))}}(),window.ImageEditor.prototype.initializeRectDrawing=function(e){let t,n,i,a=!1;e.on("mouse:down",(o=>{e.isDrawingRectMode&&(a=!0,i=e.getPointer(o.e),t=i.x,n=i.y,boxRect=new fabric.Rect({left:t,top:n,width:i.x-t,height:i.y-n,strokeWidth:1,stroke:"#C00000",fill:"rgba(192, 0, 0, 0.2)",transparentCorners:!1,originX:"left",originY:"top",isTemporary:!0}),e.add(boxRect))})),e.on("mouse:move",(o=>{if(!a)return;i=e.getPointer(o.e);const s=o.e.shiftKey;t>i.x&&boxRect.set({left:Math.abs(i.x)}),n>i.y&&boxRect.set({top:Math.abs(i.y)});let l=Math.abs(t-i.x),r=Math.abs(n-i.y);if(s){const e=Math.max(l,r);l=e,r=e}boxRect.set({width:l,height:r}),e.renderAll()})),e.on("mouse:up",(()=>{if(!a)return;let t;const n={left:boxRect.left,top:boxRect.top,width:boxRect.width<80?80:boxRect.width,height:boxRect.height<80?80:boxRect.height,fill:"#000000",strokeWidth:0,stroke:"transparent",selectable:!0,originX:"left",originY:"top"};a=!1,t=new fabric.Rect(n),e.remove(boxRect),e.add(t).setActiveObject(t),t.set({originX:"center",originY:"center",left:t.left+t.width/2,top:t.top+t.height/2}),e.fire("object:modified")}))},window.ImageEditor.prototype.initializeCircleDrawing=function(e){let t,n,i,a=!1;e.on("mouse:down",(o=>{e.isDrawingCircleMode&&(a=!0,i=e.getPointer(o.e),t=i.x,n=i.y,boxRect=new fabric.Ellipse({left:t,top:n,rx:i.x-t,ry:i.y-n,strokeWidth:1,stroke:"#C00000",fill:"rgba(192, 0, 0, 0.2)",transparentCorners:!1,originX:"left",originY:"top",isTemporary:!0}),e.add(boxRect))})),e.on("mouse:move",(o=>{if(!a)return;i=e.getPointer(o.e);const s=o.e.shiftKey;t>i.x&&boxRect.set({left:Math.abs(i.x)}),n>i.y&&boxRect.set({top:Math.abs(i.y)});let l=Math.abs(t-i.x),r=Math.abs(n-i.y);if(s){const e=Math.max(l,r);l=e,r=e}boxRect.set({rx:l/2,ry:r/2}),e.renderAll()})),e.on("mouse:up",(()=>{if(!a)return;if(boxRect.width<20||boxRect.height<20)return e.remove(boxRect),void(a=!1);let t;const n={left:boxRect.left,top:boxRect.top,rx:boxRect.width/2,ry:boxRect.height/2,originX:"left",originY:"top",fill:"#000000",stroke:"transparent",strokeWidth:0,selectable:!0};t=new fabric.Ellipse(n),a=!1,e.remove(boxRect),e.add(t).setActiveObject(t),t.set({originX:"center",originY:"center",left:t.left+t.rx,top:t.top+t.ry}),e.fire("object:modified")}))},window.ImageEditor.prototype.initializeTriangleDrawing=function(e){let t,n,i,a=!1;e.on("mouse:down",(o=>{e.isDrawingTriangleMode&&(a=!0,i=e.getPointer(o.e),t=i.x,n=i.y,boxTriangle=new fabric.Triangle({left:t,top:n,width:i.x-t,height:i.y-n,strokeWidth:1,stroke:"#C00000",fill:"rgba(192, 0, 0, 0.2)",transparentCorners:!1,originX:"left",originY:"top",isTemporary:!0}),e.add(boxTriangle))})),e.on("mouse:move",(o=>{if(!a)return;i=e.getPointer(o.e);const s=o.e.shiftKey;t>i.x&&boxTriangle.set({left:Math.abs(i.x)}),n>i.y&&boxTriangle.set({top:Math.abs(i.y)});let l=Math.abs(t-i.x),r=Math.abs(n-i.y);if(s){const e=Math.max(l,r);l=e,r=e}boxTriangle.set({width:l,height:r}),e.renderAll()})),e.on("mouse:up",(()=>{if(!a)return;let t;const n={left:boxTriangle.left,top:boxTriangle.top,width:boxTriangle.width<80?80:boxTriangle.width,height:boxTriangle.height<80?80:boxTriangle.height,fill:"#000000",strokeWidth:0,stroke:"transparent",selectable:!0,originX:"left",originY:"top"};a=!1,t=new fabric.Triangle(n),e.remove(boxTriangle),e.add(t).setActiveObject(t),t.set({originX:"center",originY:"center",left:t.left+t.width/2,top:t.top+t.height/2}),e.fire("object:modified")}))},window.ImageEditor.prototype.initializeTextBoxDrawing=function(e){let t,n,i,a,o=!1;e.on("mouse:down",(s=>{e.isDrawingTextMode&&(o=!0,a=e.getPointer(s.e),n=a.x,i=a.y,t=new fabric.Rect({left:n,top:i,width:a.x-n,height:a.y-i,strokeWidth:1,stroke:"#C00000",fill:"rgba(192, 0, 0, 0.2)",transparentCorners:!1,originX:"left",originY:"top"}),e.add(t))})),e.on("mouse:move",(s=>{o&&(a=e.getPointer(s.e),n>a.x&&t.set({left:Math.abs(a.x)}),i>a.y&&t.set({top:Math.abs(a.y)}),t.set({width:Math.abs(n-a.x)}),t.set({height:Math.abs(i-a.y)}),e.renderAll())})),e.on("mouse:up",(()=>{if(!o)return;let n;const i={left:t.left,top:t.top,width:t.width<80?80:t.width,fontSize:30,fontFamily:"'Open Sans', sans-serif",lineHeight:1.2,letterSpacing:0};o=!1,n=t.width>80?new fabric.Textbox("Your text goes here...",i):new fabric.IText("Your text goes here...",i),e.remove(t),e.add(n).setActiveObject(n),e.fire("object:modified")}))},function(){"use strict";window.ImageEditor.prototype.initializeTipSection=function(){const e=["Tip: use arrows to move a selected object by 1 pixel!","Tip: Shift + Click to select and modify multiple objects!","Tip: hold Shift when rotating an object for 15° angle jumps!","Tip: hold Shift when drawing a line for 15° angle jumps!","Tip: Ctrl +/-, Ctrl + wheel to zoom in and zoom out!","Tip: Shift + R to toggle rulers!","Tip: hold Shift when drawing a circle or rectangle to keep the 1:1 ratio!"],t=this;$(`${this.containerSelector} #footerbar`).prepend(`\n    <div id="tip-container">${e[parseInt(Math.random()*e.length)]}</div>`),this.hideTip=function(){$(`${t.containerSelector} #footerbar #tip-container`).hide()},this.showTip=function(){$(`${t.containerSelector} #footerbar #tip-container`).show()},this.updateTip=function(e){"string"==typeof e&&$(`${t.containerSelector} #footerbar #tip-container`).html(e)},this.updateTipRandom=function(){const t=e[parseInt(Math.random()*e.length)];this.updateTip(t)}}}(),window.ImageEditor.prototype.initializeUpload=function(){const e=this,t=$(e.containerSelector).find(".canvas-holder"),n=$(e.containerSelector);n.on("click",".drag-drop-input",(function(){console.log("click drag drop"),$(`${e.containerSelector} #btn-image-upload`).click()})),t.on("dragover",".canvas-container",(function(e){e.preventDefault(),e.stopPropagation(),$(this).addClass("dragging")})),t.on("dragleave",".canvas-container",(function(e){e.preventDefault(),e.stopPropagation(),$(this).removeClass("dragging")})),t.on("drop",".canvas-container",(function(e){if(e.preventDefault(),e.stopPropagation(),$(this).removeClass("dragging"),e.originalEvent.dataTransfer&&e.originalEvent.dataTransfer.files.length){let t=e.originalEvent.dataTransfer.files;i(t),$(".custom-modal-container").remove()}})),n.on("dragover",".drag-drop-input",(function(e){e.preventDefault(),e.stopPropagation(),$(this).addClass("dragging")})),n.on("dragleave",".drag-drop-input",(function(e){e.preventDefault(),e.stopPropagation(),$(this).removeClass("dragging")})),n.on("drop",".drag-drop-input",(function(e){if(e.preventDefault(),e.stopPropagation(),$(this).removeClass("dragging"),e.originalEvent.dataTransfer&&e.originalEvent.dataTransfer.files.length){let t=e.originalEvent.dataTransfer.files;i(t),$(".custom-modal-container").remove()}})),this.openDragDropPanel=function(){console.log("open drag drop panel"),n.append('<div class="custom-modal-container">\n        <div class="custom-modal-content">\n          <div class="drag-drop-input">\n            <div>Drag & drop files<br>or click to browse.<br>JPG, PNG, WEBP or SVG only!</div>\n          </div>\n        </div>\n      </div>'),n.on("click",".custom-modal-container",(function(){$(this).remove()}))};const i=t=>{if(0===t.length)return;const n=["image/jpeg","image/png","image/svg+xml","image/webp"];for(let i of t){if(!n.includes(i.type))continue;if("image/svg+xml"!==i.type&&void 0!==e.api.upload&&null!==e.api.upload){a(i);continue}let t=new FileReader;"image/svg+xml"!==i.type?(t.onload=t=>{e.addImageFromUrl(t.target.result)},t.readAsDataURL(i)):(t.onload=t=>{fabric.loadSVGFromString(t.target.result,((t,n)=>{let i=fabric.util.groupSVGElements(t,n);i.set({left:0,top:0}).setCoords(),e.canvas.add(i),e.canvas.renderAll(),e.canvas.fire("object:modified")}))},t.readAsText(i))}},a=t=>{var n=new FormData;n.append("file",t),fetch(e.api.upload,{method:"POST",body:n}).then((e=>e.json())).then((t=>{t.success?(e.images.push(t.url),$(`${e.containerSelector} .toolpanel#Images-panel .content .list-images`).prepend(`<div class="button"><img src="${t.url}" /></div>`),e.addImageFromUrl(t.url)):console.error("Failed uploading file")})).catch((e=>{console.error("Error uploading file:",e)}))};this.containerEl.append('<input id="btn-image-upload" type="file" accept="image/*" multiple hidden>'),document.querySelector(`${this.containerSelector} #btn-image-upload`).addEventListener("change",(function(e){0!==e.target.files.length&&i(e.target.files)}))},function(){"use strict";window.ImageEditor.prototype.initializeCopyPaste=e=>{document.addEventListener("copy",(t=>{e.getActiveObject()&&("image"===e.getActiveObject().type&&(t.preventDefault(),t.clipboardData.setData("text/plain",e.getActiveObject().toDataURL())),"image"!==e.getActiveObject().type&&(t.preventDefault(),e.getActiveObject().clone((e=>{t.clipboardData.setData("text/plain",JSON.stringify(e.toJSON()))}))))})),document.addEventListener("paste",(t=>{let n=t.clipboardData.getData("text");if(n&&(e=>{try{return e=e.split("base64,").pop(),window.atob(e),!0}catch(e){return!1}})(n))return void fabric.Image.fromURL(n,(t=>{t.set({left:0,top:0,crossOrigin:"anonymous"}),t.scaleToHeight(100),t.scaleToWidth(100),e.add(t),e.setActiveObject(t),e.fire("object:modified")}),{crossorigin:"anonymous"});if(t.clipboardData.items.length>0)for(let n=0;n<t.clipboardData.items.length;n++)if(0===t.clipboardData.items[n].type.indexOf("image")){let i=t.clipboardData.items[n].getAsFile();if(null!==i){let t=new FileReader;t.onload=t=>{fabric.Image.fromURL(t.target.result,(t=>{t.set({left:0,top:0,crossOrigin:"anonymous"}),t.scaleToHeight(100),t.scaleToWidth(100),e.add(t),e.setActiveObject(t),e.fire("object:modified")}),{crossorigin:"anonymous"})},t.readAsDataURL(i)}}let i=["rect","circle","line","path","polygon","polyline","textbox","group"];if((e=>{try{const t=JSON.parse(e);return!!t&&"object"==typeof t&&!Array.isArray(t)}catch{return!1}})(n)){let t=JSON.parse(n);if(!i.includes(t.type))return;fabric.util.enlivenObjects([t],(function(t){t.forEach((function(t){t.set({left:0,top:0}),e.add(t),t.setCoords(),e.setActiveObject(t)})),e.renderAll(),e.fire("object:modified")}))}}))}}(),function(){"use strict";window.ImageEditor.prototype.initializeZoomEvents=function(){const e=this;$(`${this.containerSelector} #footerbar`).append('<div class="zoom-level-container"></div>'),$(`${this.containerSelector} #footerbar .zoom-level-container`).append(`\n          <button id="zoom-fit">\n           <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path d="M344 0H488c13.3 0 24 10.7 24 24V168c0 9.7-5.8 18.5-14.8 22.2s-19.3 1.7-26.2-5.2l-39-39-87 87c-9.4 9.4-24.6 9.4-33.9 0l-32-32c-9.4-9.4-9.4-24.6 0-33.9l87-87L327 41c-6.9-6.9-8.9-17.2-5.2-26.2S334.3 0 344 0zM168 512H24c-13.3 0-24-10.7-24-24V344c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2l39 39 87-87c9.4-9.4 24.6-9.4 33.9 0l32 32c9.4 9.4 9.4 24.6 0 33.9l-87 87 39 39c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8z"/></svg> \n          </button>\n          <input type="range" id="input-zoom-level" min="0.1" max="3" step="0.05" value="1" oninput="updateZoomValue(this.value)">\n          <div id="zoom-value">${Math.round(100)}%</div>\n        `),$(`${this.containerSelector} #footerbar .zoom-level-container button`).click((function(){"function"==typeof e.fitZoom&&e.fitZoom()})),window.updateZoomValue=function(t){if("fit"===t)"function"==typeof e.fitZoom&&e.fitZoom();else{let n=parseFloat(t);"function"==typeof e.applyZoom&&e.applyZoom(n)}},"function"==typeof e.applyZoom&&e.applyZoom(1);const t=.05;this.applyZoom=e=>{this.canvas.setZoom(e),this.canvas.setWidth(this.canvas.originalW*this.canvas.getZoom()),this.canvas.setHeight(this.canvas.originalH*this.canvas.getZoom()),this.inputZoomLevel(e)},this.fitZoom=()=>{const e=document.querySelector(this.containerSelector+" .canvas-holder"),n=e.clientWidth,i=e.clientHeight,a=n/this.canvas.originalW,o=i/this.canvas.originalH,s=Math.min(a,o)-.05,l=Math.max(t,Math.min(3,s)).toFixed(2);this.applyZoom(l)},document.addEventListener("keydown",(e=>{const n=e.which||e.keyCode;if(189===n&&e.ctrlKey){if(e.preventDefault(),this.canvas.getZoom()===t)return;let n=parseInt(100*this.canvas.getZoom());if(n%25!=0)for(;n%25!=0;)n-=1;else n-=25;n/=100,n=n<=0?t:n,this.applyZoom(n)}if(187===n&&e.ctrlKey){if(e.preventDefault(),3===this.canvas.getZoom())return;let t=parseInt(100*this.canvas.getZoom());if(t%25!=0)for(;t%25!=0;)t+=1;else t+=25;t/=100,t=t>3?3:t,this.applyZoom(t)}96!==n&&48!==n&&192!==n||!e.ctrlKey||(e.preventDefault(),this.applyZoom(1))})),document.addEventListener("wheel",(e=>{if(!e.ctrlKey)return;e.preventDefault();let n=this.canvas.getZoom();n=(100*n+(e.deltaY>0?-5:5))/100,n<t||n>3||this.applyZoom(n)}),{passive:!1}),this.inputZoomLevel=e=>{const t=document.querySelector(this.containerSelector+" #input-zoom-level");t&&(t.value=e,document.getElementById("zoom-value").textContent=Math.round(100*e)+"%")}}}(),function(){"use strict";window.ImageEditor&&(window.ImageEditor.prototype.initializeLayers=function(){const e=this,t=document.createElement("div");t.className="image-editor-layers";const n=document.createElement("div");n.className="layers-header",n.innerHTML='<p>Layers</p><button class="layers-header-button layers-header-button-minus"><i class="uil uil-minus"></i></button><button class="layers-header-button layers-header-button-times"><i class="uil uil-times"></i></button>',n.style.display="flex",t.appendChild(n),n.querySelector(".layers-header-button-minus").addEventListener("click",(e=>{t.toggleAttribute("closed")})),n.querySelector(".layers-header-button-times").addEventListener("click",(e=>{t.style.display="none"}));const i=document.createElement("div");i.className="layers-list",t.appendChild(i),e.containerEl.find(".main-panel").append(t);let a=null,o=null;function s(){e.canvas.getObjects().forEach(((e,t)=>{!function(e){if(!e.id){const t=(new Date).getTime();e.id=`${e.type}-${t}`}}(e),e.zIndex=t})),i.innerHTML="",e.canvas.getObjects().filter((e=>!(e.metadata&&(e.metadata.isGuide||e.metadata.isMargin)||e.id&&(e.id.startsWith("vertical-")||e.id.startsWith("horizontal-"))||e.isTemporary))).reverse().slice().reverse().forEach((t=>{const n=function(t){const n=document.createElement("div");n.className="layer-item",n.dataset.objectId=t.id,n.draggable=!0,"group"===t.type&&(console.log("group",t),t.getObjects().forEach((e=>{})));let s='<i class="uil uil-file-alt"></i>';"image"===t.type?s='<i class="uil uil-image"></i>':"text"===t.type||"textbox"===t.type||"i-text"===t.type?s='<i class="uil uil-font"></i>':"rect"===t.type?s='<i class="uil uil-square"></i>':"circle"===t.type||"ellipse"===t.type?s='<i class="uil uil-circle"></i>':"triangle"===t.type?s='<i class="uil uil-triangle"></i>':"path"===t.type?s='<i class="uil uil-pathfinder "></i>':"group"===t.type&&(s='<i class="uil uil-layer-group"></i>');let l=t.type?t.type.charAt(0).toUpperCase()+t.type.slice(1):"Object";return n.innerHTML=`\n        <div class="layer-info">\n          <span class="layer-icon">${s}</span> <span class="layer-name">${l}</span>\n        </div>\n        <div class="layer-controls">\n          <button class="layer-lock" style="opacity: ${t.locked?"1":"0.3"}; "><i class="uil ${t.locked?"uil-lock-alt":"uil-lock-open-alt"}"></i></button>\n          <button class="layer-visibility" style="opacity: ${t.visible?"1":"0.5"}; "><i class="uil ${t.visible?"uil-eye":"uil-eye-slash"}"></i></button>\n          <button class="layer-delete"><i class="uil uil-trash-alt"></i></button>\n        </div>\n      `,n.addEventListener("dragstart",(e=>{a=n,n.style.opacity="0.5",e.dataTransfer.effectAllowed="move",o=document.createElement("div"),o.className="layer-item-placeholder",o.style.cssText=`height: ${n.offsetHeight}px;`})),n.addEventListener("dragend",(()=>{n.style.opacity="1",o&&o.parentNode&&o.parentNode.removeChild(o),a=null,o=null})),n.addEventListener("dragover",(e=>{if(e.preventDefault(),a!==n){const t=n.getBoundingClientRect(),i=t.top+t.height/2;e.clientY<i?n.parentNode.insertBefore(o,n):n.parentNode.insertBefore(o,n.nextSibling)}})),n.querySelector(".layer-visibility").addEventListener("click",(n=>{n.stopPropagation(),t.visible=!t.visible,n.target.style.opacity=t.visible?"1":"0.5",e.canvas.fire("object:modified"),e.canvas.renderAll()})),n.querySelector(".layer-lock").addEventListener("click",(n=>{n.stopPropagation(),t.lockMovementX=!t.lockMovementX,t.lockMovementY=!t.lockMovementY,t.lockScalingX=!t.lockScalingX,t.lockScalingY=!t.lockScalingY,t.lockRotation=!t.lockRotation,t.lockUniScaling=!t.lockUniScaling,t.lockSkewingX=!t.lockSkewingX,t.lockSkewingY=!t.lockSkewingY,t.hasControls=!t.hasControls,t.hasRotatingPoint=!t.hasRotatingPoint,t.locked=!t.locked,n.target.style.opacity=t.locked?"1":"0.5",e.canvas.fire("layer:locked"),e.canvas.fire("object:modified"),e.canvas.renderAll()})),n.querySelector(".layer-delete").addEventListener("click",(i=>{i.stopPropagation(),e.canvas.remove(t),n.remove(),e.canvas.renderAll()})),n.addEventListener("click",(()=>{e.canvas.setActiveObject(t),e.canvas.renderAll()})),i.appendChild(n),n}(t);e.canvas.getActiveObject()===t&&(n.style.background="#e4e4e4")}))}i.addEventListener("dragover",(e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"})),i.addEventListener("drop",(t=>{if(t.preventDefault(),console.log("drop in container",a),a){const t=Array.from(i.children),n=t.indexOf(o);if(t.indexOf(a),-1!==n){const t=e.canvas.getObjects().filter((e=>!e.id||!e.id.startsWith("vertical-")&&!e.id.startsWith("horizontal-"))),i=a.dataset.objectId,o=t.find((e=>e.id===i));if(o){console.log("Object to move:",o),e.canvas.remove(o);const i=fabric.util.object.clone(o);e.canvas.insertAt(i,t.length-1-n),e.canvas.renderAll(),s()}else console.warn("Object to be moved not found in canvas with ID:",i)}}})),e.canvas.on("object:added",s),e.canvas.on("object:removed",s),e.canvas.on("object:modified",s),e.canvas.on("selection:created",s),e.canvas.on("selection:updated",s),e.canvas.on("selection:cleared",s),s()})}(),function(){"use strict";window.ImageEditor.prototype.initializeRuler=function(){const e=this,t=20,n="rgba(0, 162, 255, 0.5)",i="rgba(0, 162, 255, 0.8)",a="rgba(255, 0, 0, 0.5)",o="imageEditor_rulersVisible",s="imageEditor_marginsConfig";this.margins={show:!1,top:70,right:70,bottom:70,left:70},this.saveRulerSettings=function(){if(window.saveInBrowser)try{window.saveInBrowser.save(o,this.isRulersVisible),window.saveInBrowser.save(s,this.margins)}catch(e){console.error("Erro ao salvar configurações de réguas:",e)}},this.loadRulerSettings=function(){if(window.saveInBrowser)try{const e=window.saveInBrowser.load(o);null!=e&&(this.isRulersVisible=e);const t=window.saveInBrowser.load(s);t&&(this.margins=t)}catch(e){console.error("Erro ao carregar configurações de réguas:",e)}},this.initRulers=function(){$(`${this.containerSelector}  .canvas-holder .content`).append('<canvas id="ruler-horizontal" class="ruler horizontal-ruler"></canvas>\n         <canvas id="ruler-vertical" class="ruler vertical-ruler"></canvas>\n         <div id="ruler-corner" class="ruler-corner"></div>\n         <div id="ruler-menu" class="ruler-menu" style="display: none;">\n           <button id="toggle-margins">Mostrar margens</button>\n           <button id="clear-guides">Limpar guias</button>\n         </div>'),$(`${this.containerSelector} .horizontal-ruler`).css({position:"absolute",top:"0",left:"20px",height:"20px",right:"0","background-color":"#f0f0f0","border-bottom":"1px solid #ccc",display:"none"}),$(`${this.containerSelector} .vertical-ruler`).css({position:"absolute",top:"20px",left:"0",width:"20px",bottom:"0","background-color":"#f0f0f0","border-right":"1px solid #ccc",display:"none"}),$(`${this.containerSelector} .ruler-corner`).css({position:"absolute",top:"0",left:"0",width:"20px",height:"20px","background-color":"#f0f0f0","border-right":"1px solid #ccc","border-bottom":"1px solid #ccc",display:"none",cursor:"pointer"}),$(`${this.containerSelector} .ruler-menu`).css({position:"absolute",top:"25px",left:"25px",padding:"5px","background-color":"#fff",border:"1px solid #ccc","border-radius":"4px","box-shadow":"0px 2px 5px rgba(0,0,0,0.2)","z-index":"1000"}),$(`${this.containerSelector} .ruler-menu button`).css({display:"block",margin:"5px 0",padding:"5px 10px",width:"100%","text-align":"left",background:"none",border:"none",cursor:"pointer"}),$(`${this.containerSelector} .ruler-menu button:hover`).css({"background-color":"#f0f0f0"}),this.horizontalRuler=document.getElementById("ruler-horizontal"),this.verticalRuler=document.getElementById("ruler-vertical"),this.horizontalRuler&&this.verticalRuler&&(this.ctxH=this.horizontalRuler.getContext("2d"),this.ctxV=this.verticalRuler.getContext("2d")),$(`${this.containerSelector} .ruler-corner`).click((function(t){const n=$(`${e.containerSelector} .ruler-menu`);n.is(":visible")?n.hide():n.show(),t.stopPropagation()})),$(document).click((function(t){$(t.target).closest(".ruler-corner, .ruler-menu").length||$(`${e.containerSelector} .ruler-menu`).hide()})),$(`${this.containerSelector} #toggle-margins`).click((function(){e.margins.show=!e.margins.show,$(this).text(e.margins.show?"Ocultar margens":"Mostrar margens"),e.drawCanvasElements(),$(`${e.containerSelector} .ruler-menu`).hide(),e.saveRulerSettings()})),$(`${this.containerSelector} #clear-guides`).click((function(){e.clearGuides(),$(`${e.containerSelector} .ruler-menu`).hide()}))},this.resizeRulers=function(){if(this.canvas)try{const e=document.querySelector(this.containerSelector+"  .canvas-holder .content"),n=e.clientWidth,i=e.clientHeight,a=document.querySelector(this.containerSelector+" .canvas-container"),o=a?a.getBoundingClientRect():null;o&&o.left,this.horizontalRuler.width=n-t,this.horizontalRuler.height=t,this.verticalRuler.width=t,this.verticalRuler.height=i-t,this.horizontalRuler.style.left="20px",this.horizontalRuler.style.top="0",this.verticalRuler.style.left="0",this.verticalRuler.style.top="20px",this.drawRulers()}catch(e){console.error("Erro ao redimensionar réguas:",e)}},this.drawMargins=function(){if(!this.margins.show||!this.canvas)return;this.logCanvasDimensions("drawMargins");const e=this.dimensions?this.dimensions.width:this.canvas.width||1e3,t=this.dimensions?this.dimensions.height:this.canvas.height||1e3;console.log("Dimensões do canvas para margens:",e,"x",t);const n=this.margins.left,i=e-this.margins.right,a=this.margins.top,o=t-this.margins.bottom;this.updateOrCreateMargin("marginTop",[0,a,e,a]),this.updateOrCreateMargin("marginRight",[i,0,i,t]),this.updateOrCreateMargin("marginBottom",[0,o,e,o]),this.updateOrCreateMargin("marginLeft",[n,0,n,t])},this.updateOrCreateMargin=function(e,t){if(!this.canvas)return null;let n=this.canvas.getObjects().find((t=>t.metadata&&t.metadata.isMargin&&t.metadata.id===e));return n?n.set({x1:t[0],y1:t[1],x2:t[2],y2:t[3],excludeFromExport:!0}):(n="marginTop"===e||"marginBottom"===e?new fabric.Line(t,{stroke:a,strokeWidth:2,strokeDashArray:[5,5],selectable:!0,evented:!0,lockMovementX:!0,lockMovementY:!1,hasControls:!1,hasBorders:!0,hoverCursor:"ns-resize",moveCursor:"ns-resize",padding:5,originX:"center",originY:"center",excludeFromExport:!0,metadata:{isMargin:!0,id:e,isHorizontal:!0}}):new fabric.Line(t,{stroke:a,strokeWidth:2,strokeDashArray:[5,5],selectable:!0,evented:!0,lockMovementX:!1,lockMovementY:!0,hasControls:!1,hasBorders:!0,hoverCursor:"ew-resize",moveCursor:"ew-resize",padding:5,originX:"center",originY:"center",excludeFromExport:!0,metadata:{isMargin:!0,id:e,isHorizontal:!1}}),this.canvas.add(n)),n},this.clearGuides=function(){this.canvas&&(this.canvas.getObjects().filter((e=>e.metadata&&e.metadata.isGuide)).forEach((e=>{this.canvas.remove(e)})),this.canvas.renderAll())},this.clearMargins=function(){this.canvas&&(this.canvas.getObjects().filter((e=>e.metadata&&e.metadata.isMargin)).forEach((e=>{this.canvas.remove(e)})),this.canvas.renderAll())},this.drawRulers=function(){if(this.ctxH&&this.ctxV&&this.canvas)try{const e=this.canvas.getZoom(),n=this.canvas.viewportTransform;this.ctxH.clearRect(0,0,this.horizontalRuler.width,this.horizontalRuler.height),this.ctxV.clearRect(0,0,this.verticalRuler.width,this.verticalRuler.height),this.ctxH.font="9px Arial",this.ctxH.fillStyle="#666",this.ctxH.strokeStyle="#666",this.ctxV.font="9px Arial",this.ctxV.fillStyle="#666",this.ctxV.strokeStyle="#666";const i=e>=1?10:50,a=document.querySelector(this.containerSelector+" .canvas-container"),o=a?a.getBoundingClientRect():null,s=(o&&o.left,Math.floor(-n[4]/e/i)*i),l=Math.floor(-n[5]/e/i)*i;for(let a=s;a<=s+this.horizontalRuler.width/e;a+=i){const i=(a-s)*e+n[4],o=a%100==0,l=o?15:10;this.ctxH.beginPath(),this.ctxH.moveTo(i,t),this.ctxH.lineTo(i,t-l),this.ctxH.stroke(),o&&this.ctxH.fillText(a.toString(),i+2,10)}for(let a=l;a<=l+this.verticalRuler.height/e;a+=i){const i=(a-l)*e+n[5],o=a%100==0,s=o?15:10;this.ctxV.beginPath(),this.ctxV.moveTo(t,i),this.ctxV.lineTo(t-s,i),this.ctxV.stroke(),o&&(this.ctxV.save(),this.ctxV.translate(10,i+10),this.ctxV.rotate(-Math.PI/2),this.ctxV.fillText(a.toString(),0,0),this.ctxV.restore())}this.lastMousePosition&&this.drawCursorOnly(this.lastMousePosition.x,this.lastMousePosition.y)}catch(e){console.error("Erro ao desenhar réguas:",e)}},this.drawCursorOnly=function(e,n){if(this.isRulersVisible&&this.ctxH&&this.ctxV)try{const i=document.querySelector(`${this.containerSelector}  .canvas-holder .content`);if(!i)return;const a=i.getBoundingClientRect(),o=e-a.left,s=n-a.top;o>t&&(this.ctxH.fillStyle="rgba(255, 0, 0, 0.5)",this.ctxH.fillRect(o-t,0,1,t)),s>t&&(this.ctxV.fillStyle="rgba(255, 0, 0, 0.5)",this.ctxV.fillRect(0,s-t,t,1))}catch(e){console.error("Erro ao desenhar cursor nas réguas:",e)}},this.drawCanvasElements=function(){this.canvas&&(this.margins.show?this.drawMargins():this.clearMargins(),this.canvas.renderAll())},this.addGuide=function(e,t){if(!this.canvas)return console.error("Canvas não está disponível para adicionar guia"),null;try{this.logCanvasDimensions("addGuide início");const i=this.dimensions?this.dimensions.width:this.canvas.width||1e3,a=this.dimensions?this.dimensions.height:this.canvas.height||1e3,o=this.canvas.getElement().getBoundingClientRect(),s=this.canvas.getZoom(),l=this.canvas.viewportTransform;let r,c;return e?(r=(t-o.top)/s-l[5]/s,r<0&&(r=0),r>a&&(r=a)):(r=(t-o.left)/s-l[4]/s,r<0&&(r=0),r>i&&(r=i)),c=e?new fabric.Line([0,r,i,r],{stroke:n,strokeWidth:3,selectable:!0,evented:!0,lockMovementX:!0,lockMovementY:!1,hasControls:!1,hasBorders:!0,hoverCursor:"ns-resize",moveCursor:"ns-resize",padding:5,originX:"center",originY:"center",opacity:.7,excludeFromExport:!0,metadata:{isGuide:!0,isHorizontal:!0}}):new fabric.Line([r,0,r,a],{stroke:n,strokeWidth:3,selectable:!0,evented:!0,lockMovementX:!1,lockMovementY:!0,hasControls:!1,hasBorders:!0,hoverCursor:"ew-resize",moveCursor:"ew-resize",padding:5,originX:"center",originY:"center",opacity:.7,excludeFromExport:!0,metadata:{isGuide:!0,isHorizontal:!1}}),c.active=!1,this.canvas.add(c),c.bringToFront(),this.canvas.renderAll(),this.canvas.setActiveObject(c),c}catch(e){return console.error("Erro ao adicionar guia:",e),null}},this.checkSnapping=function(e){if(!this.canvas||!e)return!1;if(e.metadata&&(e.metadata.isGuide||e.metadata.isMargin))return!1;try{const t=10/this.canvas.getZoom(),a=e.getBoundingRect(),o=a.left,s=a.top,l=a.left+a.width,r=a.top+a.height,c=o+a.width/2,d=s+a.height/2,h=this.canvas.getObjects().filter((e=>e.metadata&&(e.metadata.isGuide||e.metadata.isMargin)));let p=null,u=t;if(h.forEach((e=>{if(e.metadata.isGuide&&e.metadata.isHorizontal||e.metadata.isMargin&&("marginTop"===e.metadata.id||"marginBottom"===e.metadata.id)){const t=e.y1,n=Math.abs(t-s);n<u&&(u=n,p={axis:"y",target:s,value:t,guide:e});const i=Math.abs(t-d);i<u&&(u=i,p={axis:"y",target:d,value:t,guide:e});const a=Math.abs(t-r);a<u&&(u=a,p={axis:"y",target:r,value:t,guide:e})}else if(e.metadata.isGuide&&!e.metadata.isHorizontal||e.metadata.isMargin&&("marginLeft"===e.metadata.id||"marginRight"===e.metadata.id)){const t=e.x1,n=Math.abs(t-o);n<u&&(u=n,p={axis:"x",target:o,value:t,guide:e});const i=Math.abs(t-c);i<u&&(u=i,p={axis:"x",target:c,value:t,guide:e});const a=Math.abs(t-l);a<u&&(u=a,p={axis:"x",target:l,value:t,guide:e})}})),p){if(p.guide.metadata.isGuide&&(p.guide.stroke,p.guide.strokeWidth,p.guide.opacity,p.guide.set({stroke:i,strokeWidth:2,opacity:1})),"y"===p.axis){const t=p.value-p.target;e.set({top:e.top+t})}else{const t=p.value-p.target;e.set({left:e.left+t})}return setTimeout((()=>{p.guide&&p.guide.metadata&&p.guide.metadata.isGuide&&(p.guide.active||p.guide.set({stroke:n,strokeWidth:3,opacity:.7}),this.canvas.renderAll())}),300),!0}}catch(e){console.error("Erro ao verificar snapping:",e)}return!1},this.toggleRulers=function(){this.isRulersVisible=!this.isRulersVisible;const e=this.isRulersVisible?"block":"none";$(`${this.containerSelector} .ruler`).css("display",e),$(`${this.containerSelector} .ruler-corner`).css("display",e),$(`${this.containerSelector} .ruler-menu`).hide(),this.isRulersVisible?($(`${this.containerSelector}  .canvas-holder .content .content`).css({"padding-top":"20px","padding-left":"20px"}),this.logCanvasDimensions("toggleRulers - mostrar"),setTimeout((()=>this.forceGuidesMovable()),100)):($(`${this.containerSelector}  .canvas-holder .content .content`).css({"padding-top":"0","padding-left":"0"}),this.margins&&this.margins.show&&(this.margins.show=!1,this.clearMargins())),this.isRulersVisible&&this.canvas&&(this.resizeRulers(),this.drawCanvasElements(),this.updateGuidesAfterCanvasChange()),this.saveRulerSettings(),this.fitZoom()},this.setupRulerInteractions=function(){const e=this;$(`${this.containerSelector}  .canvas-holder .content`).mousemove((function(t){if(!e.isRulersVisible||!e.canvas)return;this.getBoundingClientRect();const n=t.clientX,i=t.clientY;e.drawRulerCursors(n,i)})),$(`${this.containerSelector} .horizontal-ruler`).mousedown((function(t){if(!e.canvas)return;const n=t.clientY;this.getBoundingClientRect(),e.addGuide(!0,n)?console.log("Horizontal guide added at Y:",n):console.error("Failed to add horizontal guide")})),$(`${this.containerSelector} .vertical-ruler`).mousedown((function(t){if(!e.canvas)return;const n=t.clientX;this.getBoundingClientRect(),e.addGuide(!1,n)?console.log("Vertical guide added at X:",n):console.error("Failed to add vertical guide")})),this.canvas&&(this.canvas.on("object:moving",(function(t){if(t.target)if(t.target.metadata&&t.target.metadata.isGuide)try{const n=e.dimensions?e.dimensions.width:e.canvas.width||1e3,i=e.dimensions?e.dimensions.height:e.canvas.height||1e3;t.target.metadata.isHorizontal?(t.target.top<0&&(t.target.top=0),t.target.top>i&&(t.target.top=i),t.target.set({x1:0,y1:t.target.top,x2:n,y2:t.target.top,opacity:1})):(t.target.left<0&&(t.target.left=0),t.target.left>n&&(t.target.left=n),t.target.set({x1:t.target.left,y1:0,x2:t.target.left,y2:i,opacity:1}))}catch(e){console.error("Erro ao mover guia:",e)}else e.isRulersVisible&&e.checkSnapping(t.target)})),this.canvas.on("mouse:dblclick",(function(t){t.target&&t.target.metadata&&t.target.metadata.isGuide&&(e.canvas.remove(t.target),e.canvas.renderAll())})),this.canvas.on("mouse:wheel",(function(){e.isRulersVisible&&(e.drawRulers(),e.updateGuidesAfterCanvasChange())})),this.canvas.on("mouse:down",(function(t){(t.e.altKey||t.e.metaKey)&&(e.isPanning=!0)})),this.canvas.on("mouse:up",(function(){e.isPanning&&(e.isPanning=!1,e.isRulersVisible&&e.updateGuidesAfterCanvasChange())})),this.canvas.on("object:modified",(function(t){const n=t.target;n&&n.metadata&&n.metadata.isGuide&&(n.active||n.set({opacity:.7}),setTimeout((()=>e.forceGuidesMovable()),100),e.canvas.renderAll())}))),$(document).keydown((function(t){t.shiftKey&&"R"===t.key&&(e.toggleRulers(),$(`${e.containerSelector} #toolbar button#ruler`).toggleClass("active"),t.preventDefault())})),this.canvas.on("selection:created",(function(t){if(t.selected&&1===t.selected.length&&t.selected[0].metadata&&t.selected[0].metadata.isGuide){const n=t.selected[0];n.set({stroke:i,strokeWidth:2,opacity:1}),n.active=!0,e.canvas.renderAll()}})),this.canvas.on("selection:updated",(function(t){if(e.canvas.getObjects().filter((e=>e.metadata&&e.metadata.isGuide)).forEach((e=>{e.active=!1,e.set({stroke:n,strokeWidth:3,opacity:.7})})),t.selected&&1===t.selected.length&&t.selected[0].metadata&&t.selected[0].metadata.isGuide){const n=t.selected[0];n.set({stroke:i,strokeWidth:2,opacity:1}),n.active=!0,e.canvas.renderAll()}})),this.canvas.on("selection:cleared",(function(){const t=e.canvas.getObjects().filter((e=>e.metadata&&e.metadata.isGuide));t.length>0&&(t.forEach((e=>{e.active=!1,e.set({stroke:n,strokeWidth:3,opacity:.7})})),e.canvas.renderAll())})),this.canvas.on("mouse:down",(function(t){if(t.target&&!t.target.metadata?.isGuide){const n=e.canvas.getActiveObject();n&&n.metadata&&n.metadata.isGuide&&(e.canvas.discardActiveObject(),setTimeout((()=>{e.canvas.setActiveObject(t.target),e.canvas.renderAll()}),50))}}))},this.initRulerComponent=function(){this.isRulersVisible=!1,this.loadRulerSettings(),this.initRulers()},this.setupRulerAfterCanvasReady=function(){if(this.canvas){if(this.setupRulerInteractions(),this.resizeRulers(),this.logCanvasDimensions("setupRulerAfterCanvasReady"),this.forceGuidesMovable(),this.canvas.on("after:render",(function(){e.calcOffset&&e.calcOffset()})),this.forceGuidesMovable(),this.canvas.on("mouse:up",(function(){e.isRulersVisible&&setTimeout((()=>e.forceGuidesMovable()),100)})),this.isRulersVisible){const e="block";$(`${this.containerSelector} .ruler`).css("display",e),$(`${this.containerSelector} .ruler-corner`).css("display",e),$(`${this.containerSelector}  .canvas-holder .content .content`).css({"padding-top":"20px","padding-left":"20px"}),$(`${this.containerSelector} #toggle-margins`).text(this.margins.show?"Ocultar margens":"Mostrar margens"),this.margins.show&&this.drawCanvasElements()}}else console.error("Canvas ainda não está pronto para configurar réguas")},this.drawRulerCursors=function(e,t){if(this.isRulersVisible)try{this.lastMousePosition={x:e,y:t},this.drawRulers()}catch(e){console.error("Erro ao desenhar cursores nas réguas:",e)}},this.logCanvasDimensions=function(e){if(!this.canvas)return;const t=this.dimensions?this.dimensions.width:this.canvas.width||1e3,n=this.dimensions?this.dimensions.height:this.canvas.height||1e3,i=this.canvas.getZoom(),a=this.canvas.viewportTransform;console.log(`--- Dimensões do Canvas (${e}) ---`),console.log("Dimensões:",t,"x",n),console.log("this.dimensions:",this.dimensions),console.log("this.canvas.width/height:",this.canvas.width,"x",this.canvas.height),console.log("Zoom atual:",i),console.log("ViewportTransform:",a),console.log("---------------------------------------")},this.updateGuidesAfterCanvasChange=function(){if(!this.canvas)return;const e=this.dimensions?this.dimensions.width:this.canvas.width||1e3,t=this.dimensions?this.dimensions.height:this.canvas.height||1e3,n=this.canvas.getObjects().filter((e=>e.metadata&&e.metadata.isGuide));0!==n.length&&(n.forEach((n=>{try{if(n.metadata.isHorizontal){const t=void 0!==n.top?n.top:void 0!==n.y1?n.y1:0;n.set({x1:0,y1:t,x2:e,y2:t})}else{const e=void 0!==n.left?n.left:void 0!==n.x1?n.x1:0;n.set({x1:e,y1:0,x2:e,y2:t})}}catch(e){console.error("Erro ao atualizar guia:",e)}})),this.canvas.renderAll(),setTimeout((()=>this.forceGuidesMovable()),100))},this.forceGuidesMovable=function(){if(!this.canvas)return;const e=this.canvas.getObjects().filter((e=>e.metadata&&e.metadata.isGuide));0!==e.length?(e.forEach(((t,n)=>{try{const i=t.metadata.isHorizontal;console.log(`Configurando guia ${n+1}/${e.length} (${i?"horizontal":"vertical"})`),console.log("Propriedades atuais:",{selectable:t.selectable,lockMovementX:t.lockMovementX,lockMovementY:t.lockMovementY}),t.set({selectable:!0,evented:!0,lockMovementX:i,lockMovementY:!i,hasControls:!1,hasBorders:!0,padding:8,strokeWidth:2,hoverCursor:i?"ns-resize":"ew-resize",moveCursor:i?"ns-resize":"ew-resize",excludeFromExport:!0,opacity:t.active?1:.7})}catch(e){console.error(`Erro ao configurar guia ${n+1}:`,e)}})),this.canvas.renderAll()):console.log("Nenhuma guia encontrada para tornar movível")}},window.addEventListener("resize",(function(){window.app&&window.app.ruler&&window.app.ruler.resizeRulers()})),window.app?window.app.setupRulerAfterCanvasReady=function(){try{if(!window.app.canvas)return void console.error("Canvas ainda não está inicializado");if(!window.app.ruler)return void console.error("Objeto ruler não foi inicializado");window.app.ruler.setupRulerAfterCanvasReady()}catch(e){console.error("Erro ao configurar réguas após inicialização do canvas:",e)}}:console.warn("window.app não está disponível para configurar setupRulerAfterCanvasReady")}(),function(){"use strict";window.ImageEditor.prototype.initializeFullscreenEvents=function(){const e=document.querySelector(`${this.containerSelector}`),t=document.querySelector(`${this.containerSelector} #fullscreen`),n='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path d="M160 64c0-17.7-14.3-32-32-32s-32 14.3-32 32v64H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h96c17.7 0 32-14.3 32-32V64zM32 320c-17.7 0-32 14.3-32 32s14.3 32 32 32H96v64c0 17.7 14.3 32 32 32s32-14.3 32-32V352c0-17.7-14.3-32-32-32H32zM352 64c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7 14.3 32 32 32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H352V64zM320 320c-17.7 0-32 14.3-32 32v96c0 17.7 14.3 32 32 32s32-14.3 32-32V384h64c17.7 0 32-14.3 32-32s-14.3-32-32-32H320z"/></svg>';t&&t.addEventListener("click",(()=>{document.fullscreenElement?document.exitFullscreen().then((()=>t.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">\x3c!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path d="M32 32C14.3 32 0 46.3 0 64v96c0 17.7 14.3 32 32 32s32-14.3 32-32V96h64c17.7 0 32-14.3 32-32s-14.3-32-32-32H32zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7 14.3 32 32 32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H64V352zM320 32c-17.7 0-32 14.3-32 32s14.3 32 32 32h64v64c0 17.7 14.3 32 32 32s32-14.3 32-32V64c0-17.7-14.3-32-32-32H320zM448 352c0-17.7-14.3-32-32-32s-32 14.3-32 32v64H320c-17.7 0-32 14.3-32 32s14.3 32 32 32h96c17.7 0 32-14.3 32-32V352z"/></svg>')):e.webkitSupportsFullscreen?e.webkitEnterFullscreen().then((()=>t.innerHTML=n)):e.requestFullscreen().then((()=>t.innerHTML=n))}))}}(),function(){"use strict";window.ImageEditor.prototype.initializeNotification=function(){try{const e=document.querySelector(`${this.containerSelector} .main-panel`),t=e=>{switch(e){case"Danger":return"#eb3b5a";case"Warning":return"#fdcb6e";default:return"#00b894"}};class n{constructor(t,n,i){this.message=t,this.color=n,this.time=i,this.element=null;var a=document.createElement("div");a.className="toast-notification",this.element=a;var o=document.getElementsByClassName("toast-notification");a.style.opacity=.8,a.style.marginTop=55*o.length+"px",a.style.backgroundColor=this.color,(t=document.createElement("div")).className="message-container",t.textContent=this.message,a.appendChild(t);var s=document.createElement("div");s.className="close-notification",s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 384 512"><path d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"/></svg>',a.append(s),e.appendChild(a),setTimeout((function(){a.remove()}),this.time),s.addEventListener("click",(()=>{a.remove()}))}}this.toast=(e,i,a)=>{a=null!=a?a:5e3,i=t(i),new n(e,i,a)}}catch(e){console.error(e)}}}(),function(){"use strict";window.ImageEditor.prototype.initializeConfirmationDialog=function(){const e=this;this.confirm=(t,n={})=>{const i="string"==typeof t?t:"",{confirmLabel:a="Confirm",cancelLabel:o="Cancel"}=n||{};return new Promise((t=>{(()=>{const e=document.querySelector(".image-editor-confirm");e&&e.parentNode&&e.parentNode.removeChild(e)})();const n=e.containerEl&&e.containerEl[0]instanceof HTMLElement?e.containerEl[0]:document.body,s=document.createElement("div");s.className="image-editor-confirm",s.setAttribute("role","alertdialog"),s.setAttribute("aria-modal","true"),i&&s.setAttribute("aria-label",i);const l=document.createElement("div");if(l.className="image-editor-confirm__content",i){const e=document.createElement("p");e.className="image-editor-confirm__message",e.textContent=i,l.appendChild(e)}const r=document.createElement("div");r.className="image-editor-confirm__actions";const c=document.createElement("button");c.type="button",c.className="image-editor-confirm__button image-editor-confirm__button--confirm",c.textContent=a;const d=document.createElement("button");d.type="button",d.className="image-editor-confirm__button image-editor-confirm__button--cancel",d.textContent=o,r.appendChild(c),r.appendChild(d),l.appendChild(r),s.appendChild(l),n.appendChild(s);let h=!1;const p=e=>{h||(h=!0,document.removeEventListener("keydown",m,!0),s.removeEventListener("click",g),c.removeEventListener("click",u),d.removeEventListener("click",v),s.parentNode&&s.parentNode.removeChild(s),t(e))},u=e=>{e.preventDefault(),p(!0)},v=e=>{e.preventDefault(),p(!1)},g=e=>{e.target===s&&(e.preventDefault(),p(!1))},m=e=>{if("Escape"===e.key)return e.preventDefault(),void p(!1);"Enter"!==e.key&&"Return"!==e.key||document.activeElement!==c||(e.preventDefault(),p(!0))};c.addEventListener("click",u),d.addEventListener("click",v),s.addEventListener("click",g),document.addEventListener("keydown",m,!0),requestAnimationFrame((()=>(e=>{try{e.focus({preventScroll:!0})}catch(t){try{e.focus()}catch(e){}}})(c)))}))}}}(),window.ImageEditor.prototype.initializeAnimations=function(e){this.animations=new class{constructor(e){this.canvas=e,this.animations={slideInLeft:e=>this.slideIn(e,"left",this.canvas),slideInRight:e=>this.slideIn(e,"right",this.canvas),slideInTop:e=>this.slideIn(e,"top",this.canvas),slideInBottom:e=>this.slideIn(e,"bottom",this.canvas),fade:e=>this.fade(e,1,this.canvas),zoom:e=>this.zoom(e,1,this.canvas),spin:e=>this.spin(e,360,this.canvas),swing:e=>this.swing(e,this.canvas),float:e=>this.float(e,30,this.canvas),typewriter:e=>this.typewriter(e,this.canvas)}}runAnimation(){this.canvas.renderAll.bind(this.canvas),this.canvas.getObjects().forEach((e=>{if(e.animation){const{type:t,duration:n,easing:i}=e.animation;this.animations[t]&&setTimeout((()=>{this.animations[t](e),console.log("Animação carregada:",e.animation)}),0)}}))}slideIn(e,t="left"){const n={left:e.left,top:e.top};"left"===t&&(e.left=-e.width),"right"===t&&(e.left=this.canvas.width+e.width),"top"===t&&(e.top=-e.height),"bottom"===t&&(e.top=this.canvas.height+e.height),e.animate({left:n.left,top:n.top},{duration:1e3,easing:fabric.util.ease.easeOutCubic,onChange:this.canvas.renderAll.bind(this.canvas)})}fade(e,t=1,n=1e3){e.opacity=1===t?0:e.opacity,e.animate("opacity",t,{duration:n,easing:fabric.util.ease.easeInOutQuad,onChange:this.canvas.renderAll.bind(this.canvas)})}zoom(e,t=2){const n=e.scaleX,i=e.getCenterPoint();e.set({originX:"center",originY:"center",left:i.x,top:i.y}),e.animate({scaleX:t,scaleY:t},{duration:1e3,easing:fabric.util.ease.easeInOutCubic,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:()=>{e.animate({scaleX:n,scaleY:n},{duration:1e3,easing:fabric.util.ease.easeInOutCubic,onChange:this.canvas.renderAll.bind(this.canvas)})}})}spin(e,t=360){const n=e.angle,i=e.getCenterPoint();e.set({originX:"center",originY:"center",left:i.x,top:i.y}),e.animate("angle",n+t,{duration:1e3,easing:fabric.util.ease.easeOutBack,onChange:this.canvas.renderAll.bind(this.canvas)})}swing(e){const t=e.angle,n=e.getCenterPoint();e.set({originX:"center",originY:"center",left:n.x,top:n.y}),e.animate("angle",t+10,{duration:300,easing:fabric.util.ease.easeInOutCubic,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:()=>{e.animate("angle",t-10,{duration:300,easing:fabric.util.ease.easeInOutCubic,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:()=>{e.animate("angle",t,{duration:300,easing:fabric.util.ease.easeInOutCubic,onChange:this.canvas.renderAll.bind(this.canvas)})}})}})}float(e,t=20){const n=e.top;e.animate("top",n-t,{duration:1e3,easing:fabric.util.ease.easeInOutQuad,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:()=>{e.animate("top",n,{duration:1e3,easing:fabric.util.ease.easeInOutQuad,onChange:this.canvas.renderAll.bind(this.canvas)})}})}typewriter(e){const t=e.text;e.text="";let n=0;const i=setInterval((()=>{n<t.length?(e.text+=t[n],n++,this.canvas.renderAll()):clearInterval(i)}),100)}}(e)},function(){"use strict";if(void 0!==window.ImageEditor&&void 0!==window.ImageEditor.prototype.initializeToolbar){const e={name:"frames",title:"Molduras",icon:'<svg viewBox="0 0 512 512"><path d="M448 128v288H64V128h384m0-64H64C28.65 64 0 92.65 0 128v288c0 35.35 28.65 64 64 64h384c35.35 0 64-28.65 64-64V128c0-35.35-28.65-64-64-64z"/><path d="M128 384h256v-32H128zM128 288h256v-32H128zM128 192h256v-32H128z"/></svg>'};window.ImageEditor.prototype.initializeToolbar.defaultButtons||(window.ImageEditor.prototype.initializeToolbar.defaultButtons=[]);let t=!1;for(let e=0;e<window.ImageEditor.prototype.initializeToolbar.defaultButtons.length;e++)if("frames"===window.ImageEditor.prototype.initializeToolbar.defaultButtons[e].name){t=!0;break}t||window.ImageEditor.prototype.initializeToolbar.defaultButtons.push(e)}const e={rectangle:function(e){return new fabric.Rect({width:e,height:e,originX:"center",originY:"center"})},circle:function(e){return new fabric.Circle({radius:e/2,originX:"center",originY:"center"})},triangle:function(e){return new fabric.Triangle({width:e,height:e,originX:"center",originY:"center"})},ellipse:function(e){return new fabric.Ellipse({rx:e/2,ry:e/3,originX:"center",originY:"center"})},diamond:function(e){const t=[{x:0,y:-e/2},{x:e/2,y:0},{x:0,y:e/2},{x:-e/2,y:0}];return new fabric.Polygon(t,{originX:"center",originY:"center"})},heart:function(e){const t=e/100,n=[{x:0,y:-25*t},{x:-25*t,y:-10*t},{x:-40*t,y:10*t},{x:-25*t,y:30*t},{x:0,y:50*t},{x:25*t,y:30*t},{x:40*t,y:10*t},{x:25*t,y:-10*t}];return new fabric.Polygon(n,{originX:"center",originY:"center"})},star:function(e){const t=[],n=e/2,i=e/5;for(let e=0;e<10;e++){const a=e%2==0?n:i,o=Math.PI/5*e+Math.PI/2;t.push({x:Math.cos(o)*a,y:Math.sin(o)*a})}return new fabric.Polygon(t,{originX:"center",originY:"center"})},hexagon:function(e){const t=[],n=e/2;for(let e=0;e<6;e++){const i=2*Math.PI*e/6;t.push({x:n*Math.cos(i),y:n*Math.sin(i)})}return new fabric.Polygon(t,{originX:"center",originY:"center"})},cloud:function(e){return new fabric.Path("M25,60 a20,20 0 0,1 0,-40 a20,20 0 0,1 35,-15 a25,25 0 0,1 45,0 a20,20 0 0,1 0,40 a20,20 0 0,1 -35,15 a25,25 0 0,1 -45,0 z",{originX:"center",originY:"center",scaleX:e/100,scaleY:e/100})},speech:function(e){return new fabric.Path("M10,80 C10,50 30,20 60,20 C90,20 110,50 110,80 C110,110 90,140 60,140 C50,140 30,140 25,150 C20,160 20,170 15,170 C11,170 10,160 15,150 C20,140 10,110 10,80 z",{originX:"center",originY:"center",scaleX:e/120,scaleY:e/170})},octagon:function(e){const t=[],n=e/2;for(let e=0;e<8;e++){const i=2*Math.PI*e/8;t.push({x:n*Math.cos(i),y:n*Math.sin(i)})}return new fabric.Polygon(t,{originX:"center",originY:"center"})},flowerFrame:function(e){return new fabric.Path("M50,0 C60,30 90,40 100,50 C90,60 60,70 50,100 C40,70 10,60 0,50 C10,40 40,30 50,0 Z",{originX:"center",originY:"center",scaleX:e/100,scaleY:e/100})},drop:function(e){return new fabric.Path("M50,0 C80,40 100,80 100,110 C100,150 80,180 50,180 C20,180 0,150 0,110 C0,80 20,40 50,0 Z",{originX:"center",originY:"center",scaleX:e/180,scaleY:e/180})},cross:function(e){return new fabric.Path("M35,0 L65,0 L65,35 L100,35 L100,65 L65,65 L65,100 L35,100 L35,65 L0,65 L0,35 L35,35 Z",{originX:"center",originY:"center",scaleX:e/100,scaleY:e/100})}};function t(e,t){const n=e.getActiveObject();n&&n.clipPath&&(n.clipPath.set({stroke:t.stroke||n.clipPath.stroke,strokeWidth:t.strokeWidth||n.clipPath.strokeWidth,strokeDashArray:t.strokeDashArray||n.clipPath.strokeDashArray}),n.frameOptions={...n.frameOptions,...t},e.fire&&e.fire("object:modified",{target:n}),e.renderAll())}window.ImageEditor.prototype.initializeFrames=function(){const n=this;function i(e){if(e&&"image"===e.type&&e.clipPath){$(`${n.containerSelector} .frame-properties`).show(),$(`${n.containerSelector} #frame-border-color`).spectrum("set",e.clipPath.stroke||"#000000"),$(`${n.containerSelector} #frame-border-width`).val(e.clipPath.strokeWidth||0);let t="";e.clipPath.strokeDashArray&&(t=e.clipPath.strokeDashArray.join(",")),$(`${n.containerSelector} #frame-border-style`).val(t)}else $(`${n.containerSelector} .frame-properties`).hide()}$(`${this.containerSelector} .main-panel`).append('\n      <div class="toolpanel" id="frames-panel">\n        <div class="content">\n          <p class="title">Molduras</p>\n          <div class="frames-container">\n            <div class="frames-list"></div>\n          </div>\n          <div class="frame-properties" style="display: none;">\n            <h4>Propriedades da Moldura</h4>\n            <div class="input-container">\n              <label>Cor da Borda</label>\n              <input id="frame-border-color" type="text" value="#000000">\n            </div>\n            <div class="input-container">\n              <label>Espessura da Borda</label>\n              <div class="custom-number-input">\n                <button class="decrease">-</button>\n                <input type="number" min="0" max="20" value="0" step="1" id="frame-border-width">\n                <button class="increase">+</button>\n              </div>\n            </div>\n            <div class="input-container">\n              <label>Estilo da Borda</label>\n              <select id="frame-border-style">\n                <option value="">Sólida</option>\n                <option value="5,5">Tracejada</option>\n                <option value="10,10">Pontilhada</option>\n                <option value="15,10,5,10">Traço-Ponto</option>\n              </select>\n            </div>\n          </div>\n          <hr>\n          <div class="toolpanel-item frames-actions">\n            <button id="remove-frame" class="btn btn-danger btn-sm btn-block">Remover Moldura</button>\n          </div>\n        </div>\n        <div class="hide-show-handler"></div>\n      </div>\n    '),$(`${this.containerSelector} #frame-border-color`).spectrum({color:"#000000",showInput:!0,preferredFormat:"hex",change:function(e){t(n.canvas,{stroke:e.toHexString()})}}),$(`${this.containerSelector} #frame-border-width`).on("change",(function(){t(n.canvas,{strokeWidth:parseFloat($(this).val())})})),$(`${this.containerSelector} #frame-border-style`).on("change",(function(){const e=$(this).val();let i=null;e&&(i=e.split(",").map(Number)),t(n.canvas,{strokeDashArray:i})})),this.canvas.on("selection:created",(function(e){i(e.selected[0])})),this.canvas.on("selection:updated",(function(e){i(e.selected[0])})),this.canvas.on("selection:cleared",(function(){$(`${n.containerSelector} .frame-properties`).hide()}));const a=$(`${this.containerSelector} .frames-list`);Object.keys(e).forEach((t=>{const i=$(`<div class="frame-item" data-shape="${t}">\n        <div class="frame-preview">\n          <canvas width="60" height="60"></canvas>\n        </div>\n        <div class="frame-name">${t.charAt(0).toUpperCase()+t.slice(1)}</div>\n      </div>`);a.append(i);const o=i.find("canvas")[0],s=new fabric.StaticCanvas(o),l=e[t](40);l.set({left:30,top:30,fill:"rgba(0, 0, 0, 0.1)",stroke:"#666",strokeWidth:1}),s.add(l),s.renderAll(),i.on("click",(function(){!function(t,n,i={}){const a=t.getActiveObject();if(!a||!a.type||"image"!==a.type)return void(t.fire?t.fire("notification:show",{message:"Por favor, selecione uma imagem primeiro",type:"error"}):alert("Por favor, selecione uma imagem primeiro"));if(!e[n])return void(t.fire?t.fire("notification:show",{message:"Erro: forma não encontrada",type:"error"}):alert("Erro: forma não encontrada"));const o=e[n](200),s=a.width*a.scaleX,l=a.height*a.scaleY,r=a.angle;a.scaleX,a.scaleY,a.set({angle:0});const c={left:0,top:0,scaleX:1,scaleY:1,originX:"center",originY:"center",fill:"transparent",stroke:i.stroke||"#000000",strokeWidth:i.strokeWidth||0,strokeDashArray:i.strokeDashArray||null};o.set(c);const d=o.width/o.height;d>s/l?(o.scaleToHeight(l),o.scaleToWidth(l*d)):(o.scaleToWidth(s),o.scaleToHeight(s/d)),a.clipPath=o,a.clipPath.set({originX:"center",originY:"center",left:0,top:0}),a.set({angle:r}),a.frameType=n,a.frameOptions=c,t.fire&&t.fire("object:modified",{target:a}),t.renderAll(),t.fire&&t.fire("notification:show",{message:"Moldura aplicada com sucesso",type:"success"})}(n.canvas,t,{stroke:$(`${n.containerSelector} #frame-border-color`).spectrum("get").toHexString(),strokeWidth:parseFloat($(`${n.containerSelector} #frame-border-width`).val()),strokeDashArray:$(`${n.containerSelector} #frame-border-style`).val()?$(`${n.containerSelector} #frame-border-style`).val().split(",").map(Number):null})}))})),$(`${this.containerSelector} #remove-frame`).on("click",(function(){!function(e){const t=e.getActiveObject();t&&t.type&&"image"===t.type&&t.clipPath?(t.clipPath=null,t.frameType=null,t.frameOptions=null,e.fire&&e.fire("object:modified",{target:t}),e.renderAll(),e.fire&&e.fire("notification:show",{message:"Moldura removida com sucesso",type:"success"})):e.fire?e.fire("notification:show",{message:"Selecione uma imagem com moldura para remover",type:"warning"}):alert("Selecione uma imagem com moldura para remover")}(n.canvas)})),$("head").append("\n      <style>\n        .frames-container {\n          padding: 10px 0;\n          max-height: 400px;\n          overflow-y: auto;\n        }\n        .frames-list {\n          display: grid;\n          grid-template-columns: repeat(3, 1fr);\n          gap: 10px;\n        }\n        .frame-item {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          cursor: pointer;\n          padding: 5px;\n          border-radius: 4px;\n          transition: background-color 0.2s;\n        }\n        .frame-item:hover {\n          background-color: #f0f0f0;\n        }\n        .frame-preview {\n          width: 60px;\n          height: 60px;\n          border: 1px solid #ddd;\n          margin-bottom: 5px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          background-color: #fff;\n          border-radius: 4px;\n          overflow: hidden;\n        }\n        .frame-name {\n          font-size: 12px;\n          text-align: center;\n        }\n        .frame-properties h4 {\n          margin-top: 15px;\n          margin-bottom: 10px;\n          font-size: 16px;\n        }\n        #remove-frame {\n          width: 100%;\n          background-color: #ff3860;\n          color: white;\n          border: none;\n          padding: 8px 15px;\n          border-radius: 4px;\n          cursor: pointer;\n          transition: background-color 0.3s;\n          margin-top: 15px;\n        }\n        #remove-frame:hover {\n          background-color: #e71a48;\n        }\n      </style>\n    ")};const n=window.ImageEditor.prototype.init;window.ImageEditor.prototype.init=function(){n&&"function"==typeof n&&n.call(this),this.initializeFrames()}}();